<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Case of Xeon</title>
  
  <subtitle>Welcome inside</subtitle>
  <link href="https://hexo.chensmallx.top/atom.xml" rel="self"/>
  
  <link href="https://hexo.chensmallx.top/"/>
  <updated>2022-11-22T01:28:07.061Z</updated>
  <id>https://hexo.chensmallx.top/</id>
  
  <author>
    <name>SmallXeon</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åŸºäºdockerçš„nextcloud+aria2ç¦»çº¿ä¸‹è½½è”åŠ¨è§£å†³æ–¹æ¡ˆ</title>
    <link href="https://hexo.chensmallx.top/2022/10/23/nextcloud-with-aria2-on-docker/"/>
    <id>https://hexo.chensmallx.top/2022/10/23/nextcloud-with-aria2-on-docker/</id>
    <published>2022-10-23T05:45:05.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h2><p>å‰å‡ å¤©ï¼Œåœ¨ <a href="/2021/04/08/nextcloud-on-docker/">ä½¿ç”¨docker-composeæ­å»ºnextcloud+Nginx+MySQL+Redis</a> è¿™ç¯‡æ–‡ç« ä¸­çš„ <a href="https://github.com/ChenSmallX/ChenSmallX.github.io/issues/67#issuecomment-1283605433">è¿™æ¡è¯„è®º</a> å¼•èµ·äº†æˆ‘çš„å¥½å¥‡å¿ƒã€‚è¿™ä½å…„å¼Ÿçš„è¯„è®ºå†…å®¹å¤§è‡´æ˜¯æƒ³è¦å°† Nextcloud ä¸ Aria2 è”åŠ¨å®ç°ç½‘ç›˜ä¸Šçš„ç¦»çº¿ä¸‹è½½åŠŸèƒ½ã€‚</p><p>åœ¨çœ‹åˆ°è¿™ä¸ªä¸»æ„åï¼Œè½¬å¿µä¸€æƒ³ï¼Œå°±ç›®å‰å¸‚é¢ä¸Šæ¥çœ‹ï¼Œç¦»çº¿ä¸‹è½½ä¸æ˜¯å·²ç»æˆä¸ºä¸€ä¸ªç½‘ç›˜åº”ç”¨çš„åŸºç¡€åŠŸèƒ½äº†å—ï¼Ÿæˆ‘è¿™ Nextcloud é‚£ä¹Ÿå¿…é¡»æ•´ä¸Šå•Š ğŸ¤£ ï¼äºŒè¯ä¸è¯´å°±å¼€æ•´ã€‚</p><p>ç»è¿‡å‡ æ¬¡å°è¯•åï¼Œå¤§è‡´æ‰¾åˆ°äº†ä¸€ä¸ªèƒ½å¤Ÿä¸ <a href="/2021/04/08/nextcloud-on-docker/">ä½¿ç”¨docker-composeæ­å»ºnextcloud+Nginx+MySQL+Redis</a> è¿™ç¯‡æ–‡ç« ä¸­çš„ nextcloud æ•´ä½“æ–¹æ¡ˆèƒ½å¤Ÿå®Œç¾å…¼å®¹ï¼Œå¹¶å®ç°éƒ¨ç½²åç®€å•é…ç½®å³å¯ä½¿ç”¨çš„æ•ˆæœã€‚</p><h2 id="å¤§è‡´æ€è·¯"><a href="#å¤§è‡´æ€è·¯" class="headerlink" title="å¤§è‡´æ€è·¯"></a>å¤§è‡´æ€è·¯</h2><p>å¥—æ–¹æ¡ˆæ˜¯åŸºäº <a href="/2021/04/08/nextcloud-on-docker/">ä½¿ç”¨docker-composeæ­å»ºnextcloud+Nginx+MySQL+Redis</a> è¿™ç¯‡æ–‡ç« ä¸­æ­å»ºå¥½çš„ Nextcloud æ•´ä½“è§£å†³æ–¹æ¡ˆå®ç°çš„ï¼Œæ‰€ä»¥åœ¨éƒ¨ç½²ä¸Šæ˜¯æ²¿ç”¨äº† docker-compose è¿™ç§ç®€å•å¿«é€Ÿä¸”æ–¹ä¾¿è¿ç§»çš„åŸºæœ¬æ–¹æ³•ã€‚</p><p>è€Œå°± Nextcloud ä¸ Aria2 çš„äº¤äº’æ–¹æ³•é‡‡ç”¨çš„æ˜¯ç›®å‰å·²ç»æˆç†Ÿäº†ä¸”å®Œç¾å…¼å®¹ Nextcloud çš„æ’ä»¶ ocDownloadã€‚è¿™æ¬¾æ’ä»¶æ”¯æŒ aria2ã€youtube-dlã€curl ç­‰ç½‘ç»œä¸‹è½½ç»„ä»¶ï¼Œä½†æˆ‘ä»¬è¿™é‡Œä»…ä½¿ç”¨ aira2 è¿™ä¸€ä¸ªåŠŸèƒ½ï¼Œå…¶ä»–çš„ä¸‹è½½ç»„ä»¶çœ‹ä»¥åæ˜¯å¦æœ‰å……åˆ†çš„éœ€æ±‚å†å»æŠ˜è…¾å§ ğŸ˜‚ ã€‚ocDownloader ä¸ Aria2 äº¤äº’çš„æ–¹å¼æ˜¯ä¼ ç»Ÿçš„ Aria2-RPC åè®®ï¼Œä¸ AriaNG ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯ç‹¬ç«‹è¿è¡Œçš„å‰ç«¯ï¼Œæœ‰æ•ˆä¸å¦å–å†³äº Aria2 çš„æœåŠ¡ç«¯æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p><p>åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç° ocDownloader åœ¨è¿æ¥ Aria2 è¿™æ–¹é¢å‡ ä¹æ²¡æœ‰å¯é…ç½®çš„åœ°æ–¹ï¼Œåªèƒ½é€‰æ‹©åœ¨ HTTP å’Œç£åŠ›ä¸‹è½½æ—¶ä½¿ç”¨ Aria2 è¿˜æ˜¯ cURLï¼Œå…¶ä½™çš„ç±»ä¼¼ Aria2 çš„åœ°å€ã€ç«¯å£ç­‰éƒ½æ‰¾ä¸åˆ°é…ç½®çš„åœ°æ–¹ã€‚æ‰€ä»¥åˆæ­¥æ€€ç–‘æ˜¯ ocDownloader å°† Aria2 çš„åœ°å€å’Œç«¯å£å†™æ­»äº†ï¼Œç›®æ ‡è¿æ¥å¾ˆå¯èƒ½å°±æ˜¯ç»å…¸çš„ <code>127.0.0.1:6800</code>ã€‚</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023005412.png" alt="ocDownloader çš„ä½¿ç”¨é¡µé¢">  </p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023005622.png" alt="ocDownloader çš„é…ç½®é¡µé¢">  </p><p>ç»è¿‡ä»¥ä¸Šçš„åˆ†æï¼Œè¿™å¥—æ“ä½œçš„ä¸»è¦æ€è·¯åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p><ol><li><a href="#%E9%85%8D%E7%BD%AE-Aria2-%E5%AE%B9%E5%99%A8">é…ç½® Aria2 å®¹å™¨</a></li><li><a href="#%E5%AE%89%E8%A3%85-ocDownloader-%E6%8F%92%E4%BB%B6">å®‰è£… ocDownloader æ’ä»¶</a></li><li><a href="#%E4%BF%AE%E6%94%B9-ocDownloader-%E6%8F%92%E4%BB%B6%E4%BB%A3%E7%A0%81">ä¿®æ”¹ ocDownloader æ’ä»¶ä»£ç ä»¥ä½¿ä¹‹èƒ½è¿ä¸Š Aria2 æœåŠ¡ç«¯</a></li></ol><h2 id="å…·ä½“æ­¥éª¤"><a href="#å…·ä½“æ­¥éª¤" class="headerlink" title="å…·ä½“æ­¥éª¤"></a>å…·ä½“æ­¥éª¤</h2><h3 id="é…ç½®-Aria2-å®¹å™¨"><a href="#é…ç½®-Aria2-å®¹å™¨" class="headerlink" title="é…ç½® Aria2 å®¹å™¨"></a>é…ç½® Aria2 å®¹å™¨</h3><p>ç”±äºä¹‹å‰çš„ nextcloud çš„ docker æ˜¯ä½¿ç”¨äº† docker-compose æ¥ç»„ç»‡å®¹å™¨ï¼Œæ‰€ä»¥è¿™æ¬¡ä¹Ÿä½¿ç”¨ docker-compose çš„å½¢å¼å‘ˆç°ã€‚</p><p>ç”±äº docker-compose å¼ºä¾èµ–äº docker-compose.yml æ–‡ä»¶ä¸­çš„å‚æ•°é…ç½®ï¼Œå¦‚æœ yml æ–‡ä»¶ä¸­çš„å‚æ•°é…ç½®åœ¨ compose è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿäº†å˜åŒ–ï¼Œä¼šå¯¼è‡´ down å’Œ up éƒ½å‘ç”Ÿé”™è¯¯ã€‚æ‰€ä»¥åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°†å®¹å™¨éƒ½ down æ‰ï¼ˆå°±æ˜¯åˆ é™¤å®¹å™¨çš„æ„æ€ï¼‰ã€‚</p><blockquote><p>æ³¨æ„ï¼Œè¿™é‡Œè¦ç¡®ä¿æ‰€æœ‰é‡è¦çš„æ•°æ®éƒ½æ˜ å°„åˆ°äº†æœ¬åœ°ç£ç›˜ç©ºé—´ä¸­ï¼Œå¦åˆ™åœ¨é‡å¯è¿™ä»½ compose åé€ æˆæ•°æ®ä¸¢å¤±ã€‚å½“ç„¶ï¼ŒæŒ‰ç…§æˆ‘ä¹‹å‰æ–‡ç« çš„æ˜ å°„æ–¹æ³•æ˜ å°„åï¼Œå°±ä¸ä¼šæœ‰é—®é¢˜ï¼Œé‡è¦æ•°æ®éƒ½æ˜¯æ˜ å°„åˆ°æœ¬åœ°äº†ã€‚</p></blockquote><ul><li><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¸è§„çš„ down æ¥å…³é—­ composeï¼Œå¹¶åœ¨é…ç½®å®Œæˆåå¸¸è§„ up</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­ compose</span></span><br><span class="line">docker-compose down</span><br><span class="line"><span class="comment"># é‡æ–°æ„å»º compose</span></span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li><li><p>ä¹Ÿå¯ä»¥åœ¨å…¨éƒ¨é…ç½®å®Œæˆåï¼Œå¼ºè¡Œä½¿ç”¨æ–°çš„é…ç½®é‡æ–°æ„å»º compose</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up --force-recreate -d</span><br></pre></td></tr></table></figure></li></ul><p>è¿™é‡Œæˆ‘å°† Aria2 çš„å®¹å™¨å‘½åä¸º downloaderï¼Œä»¥ä¸‹æ˜¯å®¹å™¨çš„å¯åŠ¨å‚æ•°ã€‚é•œåƒä½¿ç”¨çš„æ˜¯ä»–äººä¸“é—¨ç»™ nextcloud é…ç½®è¿‡çš„ <code>wahyd4/aria2-ui:nextcloud</code> ç‰ˆæœ¬ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ç‰ˆæœ¬çš„ï¼Œä¾‹å¦‚ä½¿ç”¨æ¬¡æ•°æœ€å¤šçš„ <code>p3terx/aria2-pro</code>ï¼Œåªè¦æ˜¯èƒ½å¤Ÿé…ç½® uid å’Œ gid çš„å°±è¶³å¤Ÿäº†ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">downloader:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">wahyd4/aria2-ui:nextcloud</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">  <span class="attr">expose:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">&quot;6800&quot;</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">./app/data:/var/www/html/data</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">PUID=33</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">PGID=33</span></span><br></pre></td></tr></table></figure><ul><li>è¿™é‡Œä½¿ç”¨ expose å°† 6800 ç«¯å£æš´éœ²åœ¨ docker çš„ç½‘ç»œä¸­è€Œä¸æ˜¯å®¿ä¸»æœºçš„ç½‘ç»œä¸­ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åé¢è¦å°† downloader å®¹å™¨è¿æ¥åˆ° nextcloud çš„å®¹å™¨ä¸­ï¼Œåªéœ€è¦è¿™ä¸¤ä¸ªå®¹å™¨å¯ä»¥æ•°æ®äº¤äº’å³å¯ï¼Œæ— éœ€å°†å¤šä½™çš„ç«¯å£æš´éœ²ç»™å¤–éƒ¨è€Œå¢åŠ å®‰å…¨é£é™©ã€‚</li><li>è¿™é‡Œä½¿ç”¨ volumes å°† nextcloud çš„ <code>/var/www/html/data</code> ä»¥ç›¸åŒè·¯å¾„æ˜ å°„åˆ° aria2 å®¹å™¨ä¸­ï¼Œæ˜¯å› ä¸º ocDownloader ä¼šè‡ªåŠ¨å°†æ¯ä¸ªç”¨æˆ·åˆ›å»ºçš„ä¸‹è½½ä»»åŠ¡çš„ä¸‹è½½ç›®çš„è·¯å¾„æ‹¼æ¥åˆ° nextcloud æœ¬åœ°çš„è·¯å¾„ä¸­ï¼Œä»¥å®ç°å•ä¸ªç”¨æˆ·ä¸‹è½½çš„æ•°æ®åªèƒ½ç”±å½“å‰ç”¨æˆ·ä½¿ç”¨ã€‚</li><li>é…ç½® PUID å’Œ PGID ä¸º 33ï¼Œæ˜¯å› ä¸º nextcloud å®¹å™¨ä¸­è¿è¡Œ nextcloud è¿›ç¨‹çš„ç”¨æˆ·æ˜¯ <code>www-data</code>ï¼Œè€Œè¿™ä¸ªç”¨æˆ·çš„ç”¨æˆ· ID å’Œç»„ ID æ˜¯ <code>33:33</code>ï¼Œé…ç½®äº†ç›¸åŒçš„ç”¨æˆ· ID å’Œç»„ ID åï¼Œå°±å¯ä»¥è®© Aria2 å®¹å™¨ä¸­çš„ä¸‹è½½å™¨ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶çš„æ‰€å±æƒé™ä¸ nextcloud å®Œå…¨ç›¸åŒï¼Œå¹¶ä½¿å¾—ä¸¤è¾¹çš„è¿›ç¨‹å¯¹è¿™äº›æ–‡ä»¶éƒ½èƒ½æ“ä½œã€‚</li><li>ä¸åœ¨ environment ä¸­ç»™ Aria2 é…ç½®ç”¨æˆ·åå’Œå¯†ç ä¸»è¦ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªå®¹å™¨å¹¶ä¸å¯¹å¤–æš´éœ²ï¼Œå”¯ä¸€èƒ½å¤Ÿæ¥è§¦åˆ°è¿™ä¸ªå®¹å™¨çš„æ–¹å¼åªæœ‰é€šè¿‡ nextcloud å®¹å™¨é—´æ¥æ¥è§¦ï¼ŒåŠ ä¹‹ä¸é…ç½®è®¤è¯é€‰é¡¹å¯ä»¥é™ä½é…ç½®çš„éš¾åº¦ã€‚</li></ul><hr><p>é…ç½®å¥½ Aria2 çš„å®¹å™¨åï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹ nextcloud å®¹å™¨çš„é…ç½®ï¼Œä½¿å¾—ä¸¤ä¸ªå®¹å™¨ä»ç½‘ç»œä¸Šå’Œæ•°æ®ä¸Šåšåˆ°äº’é€šï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">nextcloud:fpm</span></span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">   <span class="comment"># ...</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">./app/data:/var/www/html/data</span></span><br><span class="line">   <span class="comment"># è¿™é‡Œåªéœ€è¦ç¡®ä¿ data çš„è·¯å¾„ä¹ŸåŒæ ·æ˜ å°„åˆ° aria2 ä¸­å³å¯</span></span><br><span class="line">   <span class="comment"># ...</span></span><br><span class="line">  <span class="attr">links:</span></span><br><span class="line">   <span class="comment"># ...</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">downloader:downloader</span></span><br><span class="line">   <span class="comment"># è¿™é‡Œå°† downloader å®¹å™¨ä»¥ downloader çš„åå­—æ˜ å°„åˆ° nextcloud çš„å®¹å™¨ä¸­</span></span><br><span class="line">  <span class="attr">depends_on:</span></span><br><span class="line">   <span class="comment"># ...</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">downloader</span></span><br><span class="line">   <span class="comment"># è¿™é‡Œè®¾ç½® nextcloud å®¹å™¨ä¾èµ–äº downloader å®¹å™¨ï¼Œä½¿ nextcloud å®¹å™¨å¯åŠ¨é¡ºåºåœ¨ aria2 å®¹å™¨ä¹‹åã€‚å…¶å®è¿™æ¡é…ä¸é…éƒ½æ˜¯å¯ä»¥çš„</span></span><br></pre></td></tr></table></figure><h3 id="å®‰è£…-ocDownloader-æ’ä»¶"><a href="#å®‰è£…-ocDownloader-æ’ä»¶" class="headerlink" title="å®‰è£… ocDownloader æ’ä»¶"></a>å®‰è£… ocDownloader æ’ä»¶</h3><p>ç›´æ¥ä»åº”ç”¨å•†åº—å®‰è£…ä¸è‡ªå·± nextcloud åŒ¹é…çš„ ocDownloaderï¼Œæˆ–è€…ä» <a href="https://apps.nextcloud.com/apps/ocdownloader">ocDownloader - Apps - App Store - Nextcloud</a> ä¸‹è½½ä¸è‡ªå·± nextcloud ç‰ˆæœ¬åŒ¹é…çš„æ‹“å±•åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨åè§£å‹å®‰è£…åˆ° <code>/var/www/html/apps</code> ä¸­ã€‚</p><p>å¹¶å¯ç”¨ ocDownloaderã€‚åœ¨è®¾ç½®ä¸­çš„â€œå…¶ä»–è®¾ç½®â€ä¸­èƒ½å¤Ÿçœ‹åˆ° ocDownloader çš„é…ç½®é€‰é¡¹ï¼Œå³ä¸ºå®‰è£…å¹¶å¯ç”¨å®Œæˆã€‚</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023124318.png" alt="ç‚¹å‡» ocDownloader å³ä¾§çš„å¯ç”¨ï¼Œä½¿å…¶æ“ä½œæŒ‰é’®åç§°å˜ä¸ºç¦ç”¨ï¼Œå³ä¸ºå¼€å¯çŠ¶æ€">  </p><p>æ­¤æ—¶å·²ç»å¯ä»¥å¯ä»¥çœ‹åˆ°å¯¼èˆªæ ä¸­çš„ ocDownloader å›¾æ ‡äº†ï¼Œå¹¶ä¸”å¯ä»¥è¿›å…¥å®ƒçš„é¡µé¢ã€‚ä½†æ˜¯æ­¤æ—¶å¤§å®¶ä¼šå‘ç°ï¼Œ<strong>å®ƒå…¶å®æ˜¯æ— æ³•ä½¿ç”¨çš„</strong>ï¼Œå› ä¸ºå®ƒæ ¹æœ¬è¿ä¸ä¸Š Aria2 çš„ RPCã€‚</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023124843.png" alt="ocDownloader å›¾æ ‡">  </p><h3 id="ä¿®æ”¹-ocDownloader-æ’ä»¶ä»£ç "><a href="#ä¿®æ”¹-ocDownloader-æ’ä»¶ä»£ç " class="headerlink" title="ä¿®æ”¹ ocDownloader æ’ä»¶ä»£ç "></a>ä¿®æ”¹ ocDownloader æ’ä»¶ä»£ç </h3><p>ä¹‹å‰åœ¨<a href="#%E5%A4%A7%E8%87%B4%E6%80%9D%E8%B7%AF">å¤§è‡´æ€è·¯</a>ä¸­ä¹Ÿè®²åˆ°è¿‡ï¼ŒocDownloader åœ¨æ’ä»¶ä»£ç ä¸­å°†è¿æ¥ Aria2 çš„åœ°å€å†™æ­»äº†ï¼Œå¯¼è‡´é™¤äº† <code>127.0.0.1:6800</code>ï¼Œå…¶ä»–åœ°å€ä¸€å¾‹ä¸è®¤ã€‚å¥½åœ¨æ•´ä¸ª nextcloud ä½“ç³»æ˜¯å»ºç«‹åœ¨ php è¯­è¨€çš„åŸºç¡€ä¸Šçš„ï¼Œæ‰€æœ‰ä»£ç éƒ½æ˜¯å¯ä»¥ä¿®æ”¹åç›´æ¥è¿è¡Œçš„ï¼Œä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚</p><p>è™½ç„¶æˆ‘æ˜¯åš c++&#x2F;python åç«¯å¼€å‘çš„ï¼Œä¸ä¼š phpï¼Œä½†æ˜¯ä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œç¼–ç çš„ä¸­å¿ƒæ€æƒ³åŸºæœ¬éƒ½æ˜¯é€šç”¨çš„ã€‚ä¾æ‰˜äºæˆ‘é‚£è¹©è„šé˜…è¯»ä»£ç çš„èƒ½åŠ›ï¼Œæœ€åä¹Ÿè¿˜æ˜¯æ‰¾åˆ°äº†é…ç½® Aria2 è¿æ¥åœ°å€çš„ä½ç½®ï¼Œè¿™é‡Œå°±ä¸å–å…³å­äº†ï¼Œç›´æ¥æŠŠæ–‡ä»¶è·¯å¾„æ”¾è¿™é‡Œã€‚</p><blockquote><p>å®¹å™¨å†…çš„ä»£ç è·¯å¾„ä¸º <code>/var/www/html/apps/ocdownloader/controller/lib/aria2.php</code>ï¼Œå¦‚æœä½¿ç”¨è·Ÿæˆ‘çš„ docker-compose.yml ä¸€æ ·çš„æ˜ å°„æ–¹å¼ï¼Œé‚£ä¹ˆæ­¤æ—¶åœ¨å®¿ä¸»æœºä¸­çš„ä½ç½®å°±æ˜¯ <code>./app/html/apps/ocdownloader/controller/lib/aria2.php</code></p></blockquote><p>å…ˆè¿›å…¥è¿™ä¸ªç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> html/apps/ocdownloader/controller/lib/</span><br></pre></td></tr></table></figure><p>å¤‡ä»½ä¸€ä¸‹åŸæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> aria2.php aria2.php.bak</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ç¼–è¾‘å™¨ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶çš„ç¬¬ 34 è¡Œï¼Œæˆ–è€…æœç´¢ <code>self::$Server</code> ï¼Œå°†å…¶èµ‹å€¼çš„æ•°æ®ä» <code>&quot;127.0.0.1&quot;</code> æ”¹ä¸º <code>&quot;downloader&quot;</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aria2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">__callStatic</span>(<span class="params"><span class="variable">$Name</span>, <span class="variable">$Args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Settings</span> = <span class="keyword">new</span> <span class="title class_">Settings</span>();</span><br><span class="line">        <span class="variable">$Settings</span>-&gt;<span class="title function_ invoke__">setKey</span>(<span class="string">&#x27;AriaAddress&#x27;</span>);</span><br><span class="line">        <span class="built_in">self</span>::<span class="variable">$Server</span> = <span class="variable">$Settings</span>-&gt;<span class="title function_ invoke__">getValue</span>() ? <span class="variable">$Settings</span>-&gt;<span class="title function_ invoke__">getValue</span>() : <span class="string">&#x27;downloader&#x27;</span>;  <span class="comment">// ä¿®æ”¹è¿™é‡Œ</span></span><br><span class="line">        <span class="built_in">self</span>::<span class="variable">$Server</span> .= <span class="string">&#x27;:&#x27;</span>;</span><br><span class="line">        <span class="variable">$Settings</span>-&gt;<span class="title function_ invoke__">setKey</span>(<span class="string">&#x27;AriaPort&#x27;</span>);</span><br><span class="line">        <span class="built_in">self</span>::<span class="variable">$Server</span> .= <span class="variable">$Settings</span>-&gt;<span class="title function_ invoke__">getValue</span>() ? <span class="variable">$Settings</span>-&gt;<span class="title function_ invoke__">getValue</span>() : <span class="string">&#x27;6800&#x27;</span>;</span><br><span class="line">        <span class="built_in">self</span>::<span class="variable">$Server</span> .= <span class="string">&#x27;/jsonrpc&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œæ”¹ä¸º <code>&quot;downloader&quot;</code> æ˜¯å› ä¸ºæˆ‘åœ¨ docker-compose.yml ä¸­å°† Aria2 çš„å®¹å™¨ä»¥ <code>downloader</code> çš„åç§°æ˜ å°„åˆ°äº† nextcloud çš„å®¹å™¨ host åˆ—è¡¨ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥é€šè¿‡ downloader è¿™ä¸ªåœ°å€è§£æåˆ° Aria2 å®¹å™¨åœ¨ docker ç½‘æ¡¥å†…çš„å†…ç½‘åœ°å€ã€‚</p><p>ä¿å­˜è¿™ä¸ªæ–‡ä»¶ã€‚</p><p>é‡å¯é‡æ–°æ„å»º docker-compose ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>ç­‰å¾…å®¹å™¨å®Œå…¨å¯åŠ¨ï¼Œé¡µé¢æœåŠ¡å¯ä»¥è®¿é—®åï¼Œå°±å¯ä»¥åœ¨ nextcloud ä¸­ä½¿ç”¨ ocDownloader ä¸ Aria2 å®¹å™¨è¿›è¡Œäº¤äº’äº†ï¼</p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="æ—¥å¿—æ’éšœ"><a href="#æ—¥å¿—æ’éšœ" class="headerlink" title="æ—¥å¿—æ’éšœ"></a>æ—¥å¿—æ’éšœ</h3><p>å› ä¸ºè¿™ä¸ªæ–¹æ³•æœ‰ç‚¹éªšï¼Œæ¯ä¸ªäººåœ¨ç¯å¢ƒä¸­é¢å¯¹çš„æƒ…å†µå¯èƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿™é‡Œæä¾›ä¸€äº›åŸºæœ¬çš„æ’éšœæ‰‹æ®µã€‚</p><p>æŒç»­ç›‘æ§æŸ¥çœ‹æŸä¸ªå®¹å™¨çš„æœåŠ¡æ—¥å¿—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs [å®¹å™¨å/å®¹å™¨ID] -f</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å°è¯•ä»é¡µé¢ä¸Šçš„ ocDownloader ä¸‹è½½ä¸€ä¸ª<a href="https://4e2f5ebe7c93af6dc2c7943c2576e19b.rdt.tfogc.com:49156/dldir1.qq.com/weixin/Windows/WeChatSetup.exe?mkey=6354e8e6d23746820ea3b4fecf66d684&arrive_key=1218989679613&cip=58.61.50.191&proto=https">å¾®ä¿¡çš„ windows ç«¯å®‰è£…åŒ…</a>ã€‚</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023131732.png" alt="ä¸‹è½½å¾®ä¿¡ windows å®‰è£…åŒ…">  </p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸‹è½½æ˜¯å¯ä»¥æ­£å¸¸å¯åŠ¨ï¼Œå¹¶å¯ä»¥çœ‹åˆ°å†å²çš„ä¸‹è½½è®°å½•çš„ï¼š</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023131827.png" alt="ä¸‹è½½ä¸­ä¸å†å²ä¸‹è½½ä»»åŠ¡æƒ…å†µ">  </p><p>ä» Aria2 å®¹å™¨çš„æ—¥å¿—ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸‹è½½çš„åˆ›å»ºã€è¿›è¡Œæƒ…å†µï¼š</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023132257.png" alt="Aria2 çš„æ—¥å¿—">  </p><h3 id="ocDownloader-é…ç½®é¡¹"><a href="#ocDownloader-é…ç½®é¡¹" class="headerlink" title="ocDownloader é…ç½®é¡¹"></a>ocDownloader é…ç½®é¡¹</h3><p>æ‰“å­—å¤ªéº»çƒ¦äº†ï¼Œè´´å¼ å›¾æŠŠ</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023133530.png" alt="ocDownloader é…ç½®é¡¹">  </p><p>åœ¨é»˜è®¤ä¸‹è½½æ–‡ä»¶å¤¹å‚æ•°ä¸­é…ç½®äº†ç›®å½•åï¼Œå°±ä¼šåœ¨ä¸ªäººçš„æ–‡ä»¶é¡µé¢ä¸­åˆ›å»ºå¯¹åº”çš„ç›®å½•ï¼Œå¹¶ä¸‹è½½åˆ°è¿™é‡Œé¢ã€‚</p><p><img src="/../img/nextcloud-with-aria2-on-docker-20221023133818.png" alt="ä¸‹è½½ç›®å½•é…ç½®">  </p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Geek&#39;s Work" scheme="https://hexo.chensmallx.top/categories/Geek-s-Work/"/>
    
    
    <category term="è®¡ç®—æœºåä¼š" scheme="https://hexo.chensmallx.top/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8D%8F%E4%BC%9A/"/>
    
    <category term="linux" scheme="https://hexo.chensmallx.top/tags/linux/"/>
    
    <category term="docker" scheme="https://hexo.chensmallx.top/tags/docker/"/>
    
    <category term="docker-compose" scheme="https://hexo.chensmallx.top/tags/docker-compose/"/>
    
    <category term="nextcloud&#39;" scheme="https://hexo.chensmallx.top/tags/nextcloud/"/>
    
    <category term="mysql" scheme="https://hexo.chensmallx.top/tags/mysql/"/>
    
    <category term="nginx" scheme="https://hexo.chensmallx.top/tags/nginx/"/>
    
    <category term="redis" scheme="https://hexo.chensmallx.top/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>Timsortç®—æ³•Pythonå®ç°</title>
    <link href="https://hexo.chensmallx.top/2022/05/19/python-timsort/"/>
    <id>https://hexo.chensmallx.top/2022/05/19/python-timsort/</id>
    <published>2022-05-19T06:35:20.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<p>Timsort ç®—æ³•æ˜¯ä¸€ä¸ªä»¥äººåå‘½åçš„ï¼Œå·¥ä¸šçº§ã€ç¨³å®šå‹æ’åºç®—æ³•ã€‚Python ä¸­å†…ç½®<code>sorted</code>å‡½æ•°å’Œå„ç±»ä¸­çš„<code>sort</code>æ–¹æ³•éƒ½æ˜¯ç”¨çš„ Timesortã€‚</p><h2 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h2><p><img src="/../img/timsort.png" alt="å„ç§ç®—æ³•æ€§èƒ½å¯¹æ¯”å›¾"></p><p>æœ€å¥½çš„æƒ…å†µä¸‹å¯ä»¥è¾¾åˆ° O(n)ï¼Œæœ€å·®æƒ…å†µä¸‹ä¹Ÿä¸è¿‡ O(n log(n))ï¼Œè¿™å±äºæ˜¯æ’åºç®—æ³•ä¸­æœ€å¥½çš„æƒ…å†µäº†ã€‚å’Œå †æ’åºçš„ä¼˜åŠ£åœ¨äºï¼Œæœ€å¥½æƒ…å†µä¸‹å †æ’åºä¸ºO(n log(n))ï¼ˆæ¯”timsortæ…¢ï¼‰,ç©ºé—´ä¸Šå †æ’ä¸º O(1)ï¼Œtimsortä¸º O(n)ã€‚</p><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p>Timsortçš„å¤§è‡´æ­¥éª¤å¯ä»¥åˆ†ä¸º3æ­¥ï¼š</p><ol><li>å°†æ•°æ®æŒ‰ç…§å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡åˆ†å‰²ä¸ºå¤šä¸ªç‹¬ç«‹çš„åˆ‡ç‰‡ï¼Œæ¯ä¸ªåˆ‡ç‰‡ç§°ä½œä¸€ä¸ª<code>run</code>ï¼Œå¹¶å°†å•è°ƒé€’å‡çš„ run ç¿»è½¬ã€‚</li><li>å®šä¹‰ä¸€ä¸ªé•¿åº¦é˜ˆå€¼ï¼Œå°†é•¿åº¦ä½äºè¿™ä¸ªé˜ˆå€¼çš„ run ä¸ç›¸é‚»çš„ run åˆå¹¶ï¼Œä»¥æé«˜åç»­å½’å¹¶çš„æ•ˆç‡ã€‚</li><li>å°†æ‰€æœ‰çš„ run ä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œå¹¶ä½¿å¾—åœ¨å‹å…¥æ ˆçš„è¿‡ç¨‹ä¸­ï¼Œä¸‰ä¸ªè¿ç»­çš„ run <code>[X, Y, Z] </code>å§‹ç»ˆæ»¡è¶³ <code>len(X) + len(Y) &lt; len(Z)</code> å’Œ <code>len(X) &lt; len(Y)</code> çš„æ¡ä»¶ã€‚å¦‚æœä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œåˆ™å°† Y run ä¸ X, Z ä¸­è¾ƒçŸ­çš„ run é€šè¿‡å½’å¹¶æ’åºåˆå¹¶ã€‚</li></ol><p>ä»¥ä¸Šä¸‰ä¸ªæ­¥éª¤ä¸º timsort ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼Œæ¯ä¸ªæ­¥éª¤çš„å®ç°ä¼šå› äººè€Œå¼‚ï¼Œæ€»ä½“çš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">MIN_SORT_LEN = <span class="number">32</span>  <span class="comment"># å¯ä»¥æ ¹æ®æ•°æ®çš„è§„æ¨¡è§„å®šé•¿åº¦é˜ˆå€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_timsort</span>(<span class="params">data</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥éª¤1ï¼š</span></span><br><span class="line">    <span class="comment"># å°†æ•°æ®æŒ‰ç…§å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡åˆ†å‰²ä¸ºå¤šä¸ªæ•°æ®åˆ‡ç‰‡ï¼Œæ¯ä¸ªåˆ‡ç‰‡ç§°ä½œrun</span></span><br><span class="line">    <span class="comment"># å…¶ä¸­ï¼Œå•è°ƒé€’å‡çš„åˆ‡ç‰‡ä¼šè¢«åè½¬ä¸ºå•è°ƒé€’å¢çš„</span></span><br><span class="line">    runs = splite_runs(data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥éª¤2ï¼š</span></span><br><span class="line">    <span class="comment"># å°†è¿‡çŸ­çš„runè·Ÿç›¸é‚»çš„runé€šè¿‡æ’å…¥æ’åºåˆå¹¶ï¼Œ</span></span><br><span class="line">    <span class="comment"># éœ€è¦å®šä¹‰ä¸€ä¸ªæ•°å€¼æ¥åˆ¤å®šrunæ˜¯å¦è¿‡çŸ­</span></span><br><span class="line">    runs = merge_short_runs(runs, MIN_SORT_LEN)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ­¥éª¤3ï¼š</span></span><br><span class="line">    <span class="comment"># å°†æ‰€æœ‰çš„runï¼Œä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œ</span></span><br><span class="line">    <span class="comment"># ä½¿å¾—æ ˆä¸­çš„ä»»æ„ä¸‰ä¸ªè¿ç»­çš„run [X, Y, Z] æ»¡è¶³ï¼š</span></span><br><span class="line">    <span class="comment"># 1. len(X) + len(Y) &lt; len(Z)</span></span><br><span class="line">    <span class="comment"># 2. len(X) &lt; len(Y)</span></span><br><span class="line">    <span class="comment"># å¦‚æœä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œåˆ™ Y ä¸ X, Z ä¸­è¾ƒå°çš„ä¸€ä¸ªruné€šè¿‡å½’å¹¶æ’åºåˆå¹¶</span></span><br><span class="line">    sorted_data = merge_runs(runs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sorted_data</span><br></pre></td></tr></table></figure><h3 id="åˆ†å‰²-run"><a href="#åˆ†å‰²-run" class="headerlink" title="åˆ†å‰² run"></a>åˆ†å‰² <code>run</code></h3><p>å°†æ•°æ®æŒ‰ç…§å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡åˆ†å‰²ä¸ºå¤šä¸ªç‹¬ç«‹çš„åˆ‡ç‰‡ï¼Œæ¯ä¸ªåˆ‡ç‰‡ç§°ä½œä¸€ä¸ª<code>run</code>ï¼Œå¹¶å°†å•è°ƒé€’å‡çš„ run ç¿»è½¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">splite_runs</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆ†å‰² run</span></span><br><span class="line"><span class="string">    å°†æ•°æ®æŒ‰ç…§å•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡åˆ†å‰²ä¸ºå¤šä¸ªç‹¬ç«‹çš„åˆ‡ç‰‡ï¼Œ</span></span><br><span class="line"><span class="string">    æ¯ä¸ªåˆ‡ç‰‡ç§°ä½œä¸€ä¸ªrunï¼Œå¹¶å°†å•è°ƒé€’å‡çš„ run ç¿»è½¬ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    runs = []</span><br><span class="line">    curr_run = []</span><br><span class="line">    need_reverse = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(curr_run) &lt; <span class="number">2</span>:</span><br><span class="line">            curr_run.append(i)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(curr_run) == <span class="number">2</span>:</span><br><span class="line">            need_reverse = <span class="literal">True</span> <span class="keyword">if</span> curr_run[<span class="number">0</span>] &gt; curr_run[<span class="number">1</span>] <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># start_a_new_run = False</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> need_reverse <span class="keyword">and</span> i &lt; curr_run[-<span class="number">1</span>]:</span><br><span class="line">            <span class="comment"># å•è°ƒé€’å¢æ—¶é‡åˆ°äº†æ¯”æœ€åä¸€ä¸ªå…ƒç´ å°çš„å…ƒç´ </span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">elif</span> need_reverse <span class="keyword">and</span> i &gt; curr_run[-<span class="number">1</span>]:</span><br><span class="line">            <span class="comment"># å•è°ƒé€’å‡æ—¶é‡åˆ°äº†æ¯”æœ€åä¸€ä¸ªå…ƒç´ å¤§çš„å…ƒç´ </span></span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            curr_run.append(i)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¼€å§‹ä¸‹ä¸€ä¸ª run</span></span><br><span class="line">        <span class="keyword">if</span> need_reverse:</span><br><span class="line">            curr_run.reverse()</span><br><span class="line">        runs.append(curr_run)</span><br><span class="line">        curr_run = [i]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> curr_run:</span><br><span class="line">        runs.append(curr_run)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> runs</span><br></pre></td></tr></table></figure><h3 id="åˆå¹¶çŸ­-run"><a href="#åˆå¹¶çŸ­-run" class="headerlink" title="åˆå¹¶çŸ­ run"></a>åˆå¹¶çŸ­ <code>run</code></h3><p>å®šä¹‰ä¸€ä¸ªé•¿åº¦é˜ˆå€¼ï¼Œå°†é•¿åº¦ä½äºè¿™ä¸ªé˜ˆå€¼çš„ run ä¸ç›¸é‚»çš„ run åˆå¹¶ï¼Œä»¥æé«˜åç»­å½’å¹¶çš„æ•ˆç‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">my_bisect_pos</span>(<span class="params">data, x</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;äºŒåˆ†æŸ¥æ‰¾&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> data[<span class="number">0</span>] &gt; x:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    mid = <span class="built_in">round</span>(<span class="built_in">len</span>(data)/<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> data[mid] &lt; x:</span><br><span class="line">        <span class="keyword">return</span> mid + my_bisect_pos(data[mid:], x)</span><br><span class="line">    <span class="keyword">elif</span> x &lt; data[mid]:</span><br><span class="line">        <span class="keyword">return</span> my_bisect_pos(data[:mid], x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> mid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_insertion_sort</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ’å…¥æ’åº&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    p = <span class="number">1</span></span><br><span class="line">    new_data = [data[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">while</span> p &lt; <span class="built_in">len</span>(data):</span><br><span class="line">        new_pos = my_bisect_pos(new_data, data[p])</span><br><span class="line">        new_data = new_data[:new_pos] + [data[p]] + new_data[new_pos:]</span><br><span class="line"></span><br><span class="line">        p += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge_short_runs</span>(<span class="params">runs, min_run_len</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    åˆå¹¶çŸ­ run</span></span><br><span class="line"><span class="string">    å®šä¹‰ä¸€ä¸ªé•¿åº¦é˜ˆå€¼ï¼Œå°†é•¿åº¦ä½äºè¿™ä¸ªé˜ˆå€¼çš„ run ä¸ç›¸é‚»çš„ run åˆå¹¶ï¼Œ</span></span><br><span class="line"><span class="string">    ä»¥æé«˜åç»­å½’å¹¶çš„æ•ˆç‡ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    sorted_runs = []</span><br><span class="line">    curr_run = []</span><br><span class="line">    <span class="keyword">for</span> run <span class="keyword">in</span> runs:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(curr_run) &gt;= min_run_len:</span><br><span class="line">            sorted_runs.append(my_insertion_sort(curr_run))</span><br><span class="line">            curr_run = run</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            curr_run.extend(run)</span><br><span class="line">    sorted_runs.append(my_insertion_sort(curr_run))</span><br><span class="line">    <span class="keyword">return</span> sorted_runs</span><br></pre></td></tr></table></figure><h3 id="æŒ‰è§„åˆ™å½’å¹¶-run"><a href="#æŒ‰è§„åˆ™å½’å¹¶-run" class="headerlink" title="æŒ‰è§„åˆ™å½’å¹¶ run"></a>æŒ‰è§„åˆ™å½’å¹¶ <code>run</code></h3><p>å°†æ‰€æœ‰çš„ run ä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œå¹¶ä½¿å¾—åœ¨å‹å…¥æ ˆçš„è¿‡ç¨‹ä¸­ï¼Œä¸‰ä¸ªè¿ç»­çš„ run <code>[X, Y, Z] </code>å§‹ç»ˆæ»¡è¶³ <code>len(X) + len(Y) &lt; len(Z)</code> å’Œ <code>len(X) &lt; len(Y)</code> çš„æ¡ä»¶ã€‚å¦‚æœä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œåˆ™å°† Y run ä¸ X, Z ä¸­è¾ƒçŸ­çš„ run é€šè¿‡å½’å¹¶æ’åºåˆå¹¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge_run</span>(<span class="params">run_a, run_b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å½’å¹¶æ’åº&quot;&quot;&quot;</span></span><br><span class="line">    new_run = []</span><br><span class="line">    p_a = p_b = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> p_a &lt; <span class="built_in">len</span>(run_a) <span class="keyword">and</span> p_b &lt; <span class="built_in">len</span>(run_b):</span><br><span class="line">        <span class="keyword">if</span> run_a[p_a] &lt;= run_b[p_b]:</span><br><span class="line">            new_run.append(run_a[p_a])</span><br><span class="line">            p_a += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            new_run.append(run_b[p_b])</span><br><span class="line">            p_b += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> p_a &lt; <span class="built_in">len</span>(run_a):</span><br><span class="line">        new_run.extend(run_a[p_a:])</span><br><span class="line">    <span class="keyword">if</span> p_b &lt; <span class="built_in">len</span>(run_b):</span><br><span class="line">        new_run.extend(run_b[p_b:])</span><br><span class="line">    <span class="keyword">return</span> new_run</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge_runs</span>(<span class="params">runs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æŒ‰è§„åˆ™å½’å¹¶ run</span></span><br><span class="line"><span class="string">    å°†æ‰€æœ‰çš„runï¼Œä¾æ¬¡å‹å…¥æ ˆä¸­ï¼Œ</span></span><br><span class="line"><span class="string">    ä½¿å¾—æ ˆä¸­çš„ä»»æ„ä¸‰ä¸ªè¿ç»­çš„run [X, Y, Z] æ»¡è¶³ï¼š</span></span><br><span class="line"><span class="string">    1. len(X) + len(Y) &lt; len(Z)</span></span><br><span class="line"><span class="string">    2. len(X) &lt; len(Y)</span></span><br><span class="line"><span class="string">    å¦‚æœä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œåˆ™ Y ä¸ X, Z ä¸­è¾ƒå°çš„ä¸€ä¸ªruné€šè¿‡å½’å¹¶æ’åºåˆå¹¶</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    run_stack = []</span><br><span class="line">    <span class="keyword">for</span> run <span class="keyword">in</span> runs:</span><br><span class="line">        run_stack.append(run)</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(run_stack) &gt;= <span class="number">3</span>:</span><br><span class="line"></span><br><span class="line">            Z = run_stack.pop()</span><br><span class="line">            Y = run_stack.pop()</span><br><span class="line">            X = run_stack.pop()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(X) + <span class="built_in">len</span>(Y) &lt; <span class="built_in">len</span>(Z) <span class="keyword">and</span> <span class="built_in">len</span>(X) &lt; <span class="built_in">len</span>(Y):</span><br><span class="line">                run_stack.append(X)</span><br><span class="line">                run_stack.append(Y)</span><br><span class="line">                run_stack.append(Z)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(Z) &lt; <span class="built_in">len</span>(X):</span><br><span class="line">                    run_stack.append(X)</span><br><span class="line">                    run_stack.append(merge_run(Y, Z))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    run_stack.append(merge_run(X, Y))</span><br><span class="line">                    run_stack.append(Z)</span><br><span class="line">    sorted_data = []</span><br><span class="line">    <span class="keyword">for</span> run <span class="keyword">in</span> run_stack:</span><br><span class="line">        sorted_data = merge_run(sorted_data, run)</span><br><span class="line">    <span class="keyword">return</span> sorted_data</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="Python" scheme="https://hexo.chensmallx.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>fortune+cowsay+lolcatï¼šå®ç°å½©è™¹è‰²ç»ˆç«¯éšæœºé—®å€™è¯­</title>
    <link href="https://hexo.chensmallx.top/2022/05/13/random-motd/"/>
    <id>https://hexo.chensmallx.top/2022/05/13/random-motd/</id>
    <published>2022-05-13T07:26:44.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<p>ç»ˆç«¯æ°¸è¿œéƒ½æ˜¯æŠ˜è…¾çš„ä¸»åœºä¹‹ä¸€ã€‚<br>æ¯æ¬¡åœ¨ç™»é™†é˜¿é‡Œäº‘çš„ ubuntu æ—¶éƒ½ä¼šå±•ç¤ºä¸€æ®µæ¬¢è¿è¯ï¼Œå¹¶ä¸”å¹¶ä¸”å¸¦æœ‰ Alibaba Cloud çš„å­—æ ·ï¼Œäºæ˜¯å°±å¼€å§‹ç¢ç£¨ï¼Œè¿™ä¸ªæ¬¢è¿è¯åº”è¯¥æ˜¯æœ‰åŠæ³•è‡ªå®šä¹‰çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Welcome to Ubuntu 20.04.4 LTS (GNU/Linux 5.4.0-104-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">Welcome to Alibaba Cloud Elastic Compute Service !</span><br><span class="line"></span><br><span class="line">Last login: Fri May 13 11:27:32 2022 from xx.xx.xx.xx</span><br></pre></td></tr></table></figure><p>é’ˆå¯¹æ¯æ¬¡ç™»é™†éƒ½å±•ç¤ºç›¸åŒçš„é—®å€™è¯­ï¼Œè¾ƒä¸ºç®€å•å’Œé€šç”¨çš„åŠæ³•ä¸ºä¿®æ”¹ <code>/etc/motd</code> è¿™ä¸ªæ–‡ä»¶ï¼Œæœä¸å…¶ç„¶ï¼ŒæŸ¥çœ‹å…¶ä¸­çš„å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ <span class="built_in">cat</span> motd</span><br><span class="line">Welcome to Alibaba Cloud Elastic Compute Service !</span><br></pre></td></tr></table></figure><h2 id="éšæœºé—®å€™"><a href="#éšæœºé—®å€™" class="headerlink" title="éšæœºé—®å€™"></a>éšæœºé—®å€™</h2><p>å…ˆæ¥çœ‹çœ‹å‡ ä¸ªæ•ˆæœå›¾ã€‚</p><p><img src="/../img/random-motd-0.png" alt="éšå³é—®å€™æ•ˆæœå›¾1"><br><img src="/../img/random-motd-1.png" alt="éšå³é—®å€™æ•ˆæœå›¾2"></p><p>è¦å®ç°è¿™æ ·çš„æ•ˆæœï¼Œéœ€è¦ç”¨åˆ°3ä¸ªç»„ä»¶ï¼š</p><ul><li>fortune</li><li>cowsay</li><li>lolcat</li></ul><p>å…¶ä¸­ï¼Œfortune è´Ÿè´£è¾“å‡ºéšæœºé—®å€™è¯­ï¼Œcowsay ç”¨äºå¥—æ¡†å’ŒåŠ å…¥å°åŠ¨ç‰©å½¢è±¡ï¼Œè€Œ lolcat è´Ÿè´£å¯¹è¿™äº›å­—ç¬¦ç”»ç€è‰²ã€‚</p><p>å…ˆå®‰è£…è¿™äº›ç»„ä»¶ï¼ˆæ­¤å¤„ä¸ºubuntuçš„å®‰è£…åŠæ³•ï¼Œå…¶ä»–å‘è¡Œç‰ˆå¯ä»¥è‡ªè¡Œä¸Šç½‘æŸ¥æ‰¾å®‰è£…æ–¹æ³•ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… fortune å’Œ ä¸­æ–‡åº“</span></span><br><span class="line">sudo apt install fortune fortunes-zh</span><br><span class="line"><span class="comment"># å®‰è£… cowsay</span></span><br><span class="line">sudo apt install cowsay</span><br><span class="line"><span class="comment"># å®‰è£… lolcat</span></span><br><span class="line">sudo apt install lolcat</span><br></pre></td></tr></table></figure><h3 id="æ¯ä¸ªç»„ä»¶çš„ä½œç”¨"><a href="#æ¯ä¸ªç»„ä»¶çš„ä½œç”¨" class="headerlink" title="æ¯ä¸ªç»„ä»¶çš„ä½œç”¨"></a>æ¯ä¸ªç»„ä»¶çš„ä½œç”¨</h3><p>å…ˆæ¥çœ‹çœ‹ fortuneã€‚fortune ç”¨äºè¾“å‡ºéšæœºçš„åè¨€ã€è¯—è¯æˆ–è€…æ˜¯ä¸€äº›ç¨‹åºæ–‡æ¡£ã€‚æ‰§è¡Œå‡ æ¬¡å°±èƒ½å¤Ÿæ˜ç™½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â¯ fortune</span><br><span class="line">å¸¸ç¾¡äººé—´ç¢ç‰éƒï¼Œå¤©åº”ä¹ä¸ç‚¹é…¥å¨˜ã€‚å°½é“æ¸…æ­Œä¼ çš“é½¿ï¼Œé£èµ·ï¼Œé›ªé£ç‚æµ·å˜æ¸…å‡‰ã€‚</span><br><span class="line">ä¸‡é‡Œå½’æ¥é¢œæ„ˆå°‘ï¼Œå¾®ç¬‘ï¼Œç¬‘æ—¶çŠ¹å¸¦å²­æ¢…é¦™ã€‚è¯•é—®å²­å—åº”ä¸å¥½ï¼Œå´é“ï¼šæ­¤å¿ƒå®‰å¤„æ˜¯å¾ä¹¡ã€‚</span><br><span class="line">      -- è‹è½¼ã€Šå®šé£æ³¢ã€‹</span><br><span class="line">â¯ fortune</span><br><span class="line">Nothing so needs reforming as other people&#x27;s habits.</span><br><span class="line">                -- Mark Twain</span><br><span class="line">â¯ fortune</span><br><span class="line">ç™½å‘æ‚²èŠ±è½ï¼Œé’äº‘ç¾¡é¸Ÿé£ã€‚</span><br><span class="line">    -- å²‘å‚ã€Šå¯„å·¦çœæœæ‹¾é—ã€‹</span><br></pre></td></tr></table></figure><p>æ¥ç€æ˜¯ cowsayã€‚cowsay ç”¨äºå°†è¾“å…¥çš„å†…å®¹æ”¾åˆ°å°åŠ¨ç‰©çš„è¯´è¯çš„æ¡†ä¸­ï¼Œä½¿å…¶æ›´åŠ åœ°æœ‰è§‚èµæ€§å’Œè¶£å‘³æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â¯ echo abcdefg | cowsay</span><br><span class="line"> _________</span><br><span class="line">&lt; abcdefg &gt;</span><br><span class="line"> ---------</span><br><span class="line">        \   ^__^</span><br><span class="line">         \  (oo)\_______</span><br><span class="line">            (__)\       )\/\</span><br><span class="line">                ||----w |</span><br><span class="line">                ||     ||</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹ cowsay çš„ usageï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä¸å…‰æ˜¯æœ‰ç‰›ä¸€ç§å°åŠ¨ç‰©ï¼Œè¿˜æœ‰å¾ˆå¤šå†…ç½®çš„å½¢è±¡å¯ä»¥ä½¿ç”¨ï¼Œé€šè¿‡ <code>-f</code> å‚æ•°ååŠ å†…ç½®çš„å½¢è±¡å³å¯ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â¯ cowsay -h</span><br><span class="line">cow&#123;say,think&#125; version 3.03, (c) 1999 Tony Monroe</span><br><span class="line">Usage: cowsay [-bdgpstwy] [-h] [-e eyes] [-f cowfile]</span><br><span class="line">          [-l] [-n] [-T tongue] [-W wrapcolumn] [message]</span><br><span class="line">â¯ echo abcdefg | cowsay -f sheep</span><br><span class="line"> _________</span><br><span class="line">&lt; abcdefg &gt;</span><br><span class="line"> ---------</span><br><span class="line">  \</span><br><span class="line">   \</span><br><span class="line">       __</span><br><span class="line">      UooU\.&#x27;@@@@@@`.</span><br><span class="line">      \__/(@@@@@@@@@@)</span><br><span class="line">           (@@@@@@@@)</span><br><span class="line">           `YY~~~~YY&#x27;</span><br><span class="line">            ||    ||</span><br></pre></td></tr></table></figure><p>è€Œæ€ä¹ˆèƒ½å¤ŸçŸ¥é“å†…ç½®äº†å¤šå°‘ç§å°åŠ¨ç‰©å‘¢ï¼Ÿå…¶å®æ¯ç§å°åŠ¨ç‰©éƒ½æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¹¶å­˜åœ¨ <code>/usr/share/cowsay/cows</code> ä¸­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">â¯ <span class="built_in">ls</span> /usr/share/cowsay/cows</span><br><span class="line">apt.cow             elephant-in-snake.cow  luke-koala.cow    stimpy.cow</span><br><span class="line">bud-frogs.cow       elephant.cow           mech-and-cow.cow  suse.cow</span><br><span class="line">bunny.cow           eyes.cow               milk.cow          three-eyes.cow</span><br><span class="line">calvin.cow          flaming-sheep.cow      moofasa.cow       turkey.cow</span><br><span class="line">cheese.cow          fox.cow                moose.cow         turtle.cow</span><br><span class="line">cock.cow            ghostbusters.cow       pony-smaller.cow  tux.cow</span><br><span class="line">cower.cow           gnu.cow                pony.cow          unipony-smaller.cow</span><br><span class="line">daemon.cow          hellokitty.cow         ren.cow           unipony.cow</span><br><span class="line">default.cow         kangaroo.cow           sheep.cow         vader-koala.cow</span><br><span class="line">dragon-and-cow.cow  kiss.cow               skeleton.cow      vader.cow</span><br><span class="line">dragon.cow          koala.cow              snowman.cow       www.cow</span><br><span class="line">duck.cow            kosh.cow               stegosaurus.cow</span><br></pre></td></tr></table></figure><p>å¦‚æ­¤ä¸€æ¥ï¼Œæ—¢ç„¶æ˜¯éšæœºé—®å€™ï¼Œä¸ºä»€ä¹ˆä¸éšæœºåˆ°åº•å‘¢ï¼Œç´¢æ€§å°åŠ¨ç‰©çš„å½¢è±¡ä¹Ÿéšæœºä¸€ä¸‹å§ï¼</p><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„ shell æŒ‡ä»¤è·å–åˆ°ä¸€ä¸ªéšæœºçš„å°åŠ¨ç‰©é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å…¶çš„åå­—ä½œä¸ºå‚æ•°ä¼ å…¥ cowsayï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â¯ cow=`<span class="built_in">ls</span> /usr/share/cowsay/cows | <span class="built_in">sort</span> -R | <span class="built_in">tail</span> -n 1`</span><br><span class="line">â¯ <span class="built_in">echo</span> abcdefg | cowsay -f <span class="variable">$&#123;cow%\.*&#125;</span></span><br><span class="line"> _________</span><br><span class="line">&lt; abcdefg &gt;</span><br><span class="line"> ---------</span><br><span class="line">          \      (__)</span><br><span class="line">           \     /oo|</span><br><span class="line">            \   (_<span class="string">&quot;_)*+++++++++*</span></span><br><span class="line"><span class="string">                   //I#\\\\\\\\I\</span></span><br><span class="line"><span class="string">                   I[I|I|||||I I `</span></span><br><span class="line"><span class="string">                   I`I&#x27;///&#x27;&#x27; I I</span></span><br><span class="line"><span class="string">                   I I       I I</span></span><br><span class="line"><span class="string">                   ~ ~       ~ ~</span></span><br><span class="line"><span class="string">                     Scowleton</span></span><br></pre></td></tr></table></figure><p>æœ€åæ¥çœ‹çœ‹ lolcatã€‚lolcat çš„ä½œç”¨å°±ç®€å•å¾ˆå¤šï¼Œå°±æ˜¯å¯¹ç»ˆç«¯è¾“å‡ºçš„å­—ç¬¦è¿›è¡Œå½©è™¹è‰²çš„ç€è‰²ï¼š</p><p><img src="/../img/lolcat-qwer.png" alt="lolcatç€è‰²æ•ˆæœ"></p><h3 id="æ•´åˆåæ”¾å…¥ç»ˆç«¯é…ç½®æ–‡ä»¶"><a href="#æ•´åˆåæ”¾å…¥ç»ˆç«¯é…ç½®æ–‡ä»¶" class="headerlink" title="æ•´åˆåæ”¾å…¥ç»ˆç«¯é…ç½®æ–‡ä»¶"></a>æ•´åˆåæ”¾å…¥ç»ˆç«¯é…ç½®æ–‡ä»¶</h3><p>ç»è¿‡ä»¥ä¸Šçš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®¡é“ç¬¦å°†ä»¥ä¸Šä¸‰ä¸ªè½¯ä»¶ç»„åˆèµ·æ¥ä½¿ç”¨ï¼Œæœ€ç»ˆæ•´åˆæˆè¿™æ ·ä¸€ä¸ªæµç¨‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–ä¸€ä¸ªéšæœºå°åŠ¨ç‰©</span></span><br><span class="line">cow=`<span class="built_in">ls</span> /usr/share/cowsay/cows | <span class="built_in">sort</span> -R | <span class="built_in">tail</span> -n 1`</span><br><span class="line"><span class="comment"># æ ¹æ®è¿™ä¸ªå°åŠ¨ç‰©å½¢è±¡è¾“å‡ºéšæœºæ–‡æœ¬</span></span><br><span class="line">fortune | cowsay -f <span class="variable">$&#123;cow%\.*&#125;</span> | lolcat</span><br></pre></td></tr></table></figure><p>å°†å…¶å¡«åˆ°ç»ˆç«¯é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ .bashrc æˆ–è€… .zshrcï¼ˆæˆ‘æ˜¯ç”¨çš„æ˜¯ zshï¼Œæ‰€ä»¥æ˜¯ .zshrcï¼‰ï¼Œç„¶ååœ¨ä¹‹åçš„æ¯æ¬¡å¯åŠ¨ç»ˆç«¯ï¼Œåœ¨ç»ˆç«¯è¯»å–è¿™ä¸ªé…ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œåˆ°è¿™ä¸ªå‘½ä»¤ï¼Œä»è€Œè¾“å‡ºé—®å€™è¯­ã€‚</p><p><img src="/../img/random-motd-2.png" alt="è¿ç»­å¼€å¯ä¸‰ä¸ªç»ˆç«¯ï¼Œéƒ½æ˜¯ä¸åŒçš„é—®å€™"></p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Geek&#39;s Work" scheme="https://hexo.chensmallx.top/categories/Geek-s-Work/"/>
    
    
    <category term="Linux" scheme="https://hexo.chensmallx.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Python é›†åˆ(set) åˆ›å»ºå®ä¾‹æ•ˆç‡</title>
    <link href="https://hexo.chensmallx.top/2022/05/12/python-set-performance/"/>
    <id>https://hexo.chensmallx.top/2022/05/12/python-set-performance/</id>
    <published>2022-05-12T01:30:21.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="setåˆ›å»ºæ–¹å¼"><a href="#setåˆ›å»ºæ–¹å¼" class="headerlink" title="setåˆ›å»ºæ–¹å¼"></a>setåˆ›å»ºæ–¹å¼</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—é¢å€¼åˆ›å»ºæ–¹å¼</span></span><br><span class="line">s = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ æ–¹æ³•åˆ›å»ºæ–¹å¼</span></span><br><span class="line">s = <span class="built_in">set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure><h2 id="ä¸¤ç§åˆ›å»ºå®ä¾‹æ–¹å¼åæ±‡ç¼–"><a href="#ä¸¤ç§åˆ›å»ºå®ä¾‹æ–¹å¼åæ±‡ç¼–" class="headerlink" title="ä¸¤ç§åˆ›å»ºå®ä¾‹æ–¹å¼åæ±‡ç¼–"></a>ä¸¤ç§åˆ›å»ºå®ä¾‹æ–¹å¼åæ±‡ç¼–</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> dis <span class="keyword">import</span> dis</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dis(<span class="string">&#x27;&#123;1&#125;&#x27;</span>)</span><br><span class="line">  <span class="number">1</span>           <span class="number">0</span> LOAD_CONST               <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line">              <span class="number">2</span> BUILD_SET                <span class="number">1</span></span><br><span class="line">              <span class="number">4</span> RETURN_VALUE</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dis(<span class="string">&#x27;set([1])&#x27;</span>)</span><br><span class="line">  <span class="number">1</span>           <span class="number">0</span> LOAD_NAME                <span class="number">0</span> (<span class="built_in">set</span>)</span><br><span class="line">              <span class="number">2</span> LOAD_CONST               <span class="number">0</span> (<span class="number">1</span>)</span><br><span class="line">              <span class="number">4</span> BUILD_LIST               <span class="number">1</span></span><br><span class="line">              <span class="number">6</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">              <span class="number">8</span> RETURN_VALUE</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡å­—é¢å€¼å»åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œåœ¨è§£é‡Šå™¨å®ç°ä¸Šæ˜¯é€šè¿‡è°ƒç”¨äº†ä¸€ä¸ªå«åš <code>BUILD_SET</code> çš„æ–¹æ³•ç›´æ¥åˆ›å»ºï¼›</p><p>è€Œä½¿ç”¨ <code>set()</code> æ–¹æ³•åˆ›å»ºé›†åˆï¼Œè§£é‡Šå™¨å®ç°ä¸Šä¼šå…ˆé€šè¿‡ set çš„åå­—å»å¯»æ‰¾æ„é€ æ–¹æ³•ï¼Œå¹¶ä¸”è°ƒç”¨ <code>BUILD_LIST</code> æ–¹æ³•å»åˆ›å»ºä¸€ä¸ª list ä¼ å…¥ set æ„é€ æ–¹æ³•ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªé›†åˆã€‚</p><hr><p>æ‰€ä»¥ç»“è®ºä¸ºï¼šä½¿ç”¨å­—é¢å€¼ç›´æ¥åˆ›å»ºé›†åˆè¦æ¯”ä½¿ç”¨ set æ„é€ æ–¹æ³•æ•ˆç‡æ›´é«˜ã€‚</p><hr><p>åŒç†åœ°ï¼Œ<code>list()</code> æ„é€ æ–¹æ³•å’Œ <code>[]</code> å­—é¢å€¼åˆ›å»ºåˆ—è¡¨çš„æ•ˆç‡ä¹Ÿå¾ˆå®¹æ˜“å¾—å‡ºé«˜ä½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>dis(<span class="string">&#x27;[]&#x27;</span>)</span><br><span class="line">  <span class="number">1</span>           <span class="number">0</span> BUILD_LIST               <span class="number">0</span></span><br><span class="line">              <span class="number">2</span> RETURN_VALUE</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dis(<span class="string">&#x27;list()&#x27;</span>)</span><br><span class="line">  <span class="number">1</span>           <span class="number">0</span> LOAD_NAME                <span class="number">0</span> (<span class="built_in">list</span>)</span><br><span class="line">              <span class="number">2</span> CALL_FUNCTION            <span class="number">0</span></span><br><span class="line">              <span class="number">4</span> RETURN_VALUE</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="Python" scheme="https://hexo.chensmallx.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Python random.choice å®ç°ä¹‹æ•°æ®æ¨¡å‹é­”æœ¯æ–¹æ³•</title>
    <link href="https://hexo.chensmallx.top/2022/03/08/python-random-choice-implement/"/>
    <id>https://hexo.chensmallx.top/2022/03/08/python-random-choice-implement/</id>
    <published>2022-03-08T11:20:25.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>èµ·å› è‡ªã€Šæµç•…çš„pythonã€‹1.1 ä¸€æ‘Pythoné£æ ¼çš„çº¸ç‰Œ</p></blockquote><p>è‡ªå®ç°ç±»è¦æ”¯æŒ <code>random.choice</code> æ–¹æ³•åªéœ€è¦æ”¯æŒä¸¤ä¸ªé­”æœ¯æ–¹æ³•å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__len__</span><br><span class="line">__getitem__</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">8</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">mc = MyClass()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(mc))  <span class="comment"># 8</span></span><br><span class="line"><span class="built_in">print</span>(mc[<span class="number">15</span>])  <span class="comment"># 4</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="built_in">print</span>(choice(mc))  <span class="comment"># 4</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥pythonå†…ç½®åº“ <code>random</code> ä¸­æŸ¥çœ‹<code>choice</code> çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°å®ç°æ­£æ˜¯ä½¿ç”¨äº†åºåˆ—çš„ <code>__len__</code> æ–¹æ³•å’Œ <code>__getitem__</code> æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">seq</span>):</span><br><span class="line">    <span class="keyword">return</span> seq[random.random() * <span class="built_in">len</span>(seq)]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="Python" scheme="https://hexo.chensmallx.top/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡äº‘ä¸»æœºç¡¬ç›˜æ‰©å®¹æ“ä½œ</title>
    <link href="https://hexo.chensmallx.top/2021/08/26/record-a-disk-expansion-on-alicloud-ubuntu/"/>
    <id>https://hexo.chensmallx.top/2021/08/26/record-a-disk-expansion-on-alicloud-ubuntu/</id>
    <published>2021-08-26T03:32:03.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<p>ç”±äºåœ¨æŠ˜è…¾<code>é’é¾™é¢æ¿+XDD</code>çš„æ—¶å€™é…ç½®äº†ä¸€å¥— Golang çš„ç¯å¢ƒï¼Œå¯¼è‡´ä¸ºæ•°ä¸å¤šçš„ç¡¬ç›˜ç©ºé—´è¢«åƒå¹²å‡€äº†ï¼ˆæ²¡é”™ï¼Œå‰©ä½™é‡å°±æ˜¯è¿™ä¹ˆå°‘ï¼‰ã€‚è€ƒè™‘åˆ°æœºå™¨è¿˜ä¼šç”¨å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæ‰€ä»¥å†³å®šå¢åŠ ä¸€å—ç¡¬ç›˜å¯¹æœºå™¨è¿›è¡Œæ‰©å®¹ã€‚</p><span id="more"></span><h2 id="å¢åŠ ç¡¬ç›˜"><a href="#å¢åŠ ç¡¬ç›˜" class="headerlink" title="å¢åŠ ç¡¬ç›˜"></a>å¢åŠ ç¡¬ç›˜</h2><p>åœ¨é˜¿é‡Œäº‘é¡µé¢è´­ä¹°äº†ç¡¬ç›˜å¹¶æŒ‚è½½åˆ° ecs å®ä¾‹ä¸Šä¹‹åï¼Œåœ¨ç³»ç»Ÿä¸­å‡ºç°äº†ä¸€ä¸ªæ–°çš„è®¾å¤‡â€”â€”<code>/dev/vdb</code>ï¼Œè¡¨æ˜æ–°å¢çš„æ˜¯ä¸€å— <code>virtio</code> ç£ç›˜ï¼Œå’Œæˆ‘ä»¬å¸¸è§çš„ <code>sd*</code> ä¸åŒï¼Œ<code>sd*</code> è¡¨ç¤ºçš„æ˜¯ <code>SCSI</code> ç±»å‹çš„è®¾å¤‡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ <span class="built_in">ls</span> /dev</span><br><span class="line">... vda vda1 vdb ...</span><br></pre></td></tr></table></figure><h2 id="ç¡®è®¤ç£ç›˜ä¿¡æ¯"><a href="#ç¡®è®¤ç£ç›˜ä¿¡æ¯" class="headerlink" title="ç¡®è®¤ç£ç›˜ä¿¡æ¯"></a>ç¡®è®¤ç£ç›˜ä¿¡æ¯</h2><p>é€šè¿‡ <code>ls</code> æŸ¥çœ‹ä»£è¡¨ç¡¬ä»¶çš„æ–‡ä»¶è¿˜æ˜¯æ¯”è¾ƒç²—ç³™çš„åŠæ³•ï¼Œè€Œä¸”æ— æ³•æŸ¥çœ‹å…³äºç¡¬ä»¶çš„æ›´è¯¦ç»†çš„å†…å®¹ã€‚<br>å¯¹äºç£ç›˜ç±»çš„è®¾å¤‡ï¼Œå¯ä»¥é€šè¿‡ <code>lshw -C disk</code> æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯å’Œé€šè¿‡ <code>fdisk -l</code> æ¥æŸ¥çœ‹å„ä¸ªåˆ†åŒºä¿¡æ¯ã€‚</p><ul><li>ä½¿ç”¨ <code>lshw</code> æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â¯ lshw -C disk</span><br><span class="line">  *-virtio1                 </span><br><span class="line">       description: Virtual I/O device</span><br><span class="line">       physical <span class="built_in">id</span>: 0</span><br><span class="line">       bus info: virtio@1</span><br><span class="line">       logical name: /dev/vda</span><br><span class="line">       size: 20GiB (21GB)</span><br><span class="line">       capabilities: partitioned partitioned:dos</span><br><span class="line">       configuration: driver=virtio_blk logicalsectorsize=512 sectorsize=512 signature=13be70fb</span><br><span class="line">  *-virtio4</span><br><span class="line">       description: Virtual I/O device</span><br><span class="line">       physical <span class="built_in">id</span>: 0</span><br><span class="line">       bus info: virtio@4</span><br><span class="line">       logical name: /dev/vdb</span><br><span class="line">       size: 100GiB (107GB)</span><br><span class="line">       capabilities: partitioned partitioned:dos</span><br><span class="line">       configuration: driver=virtio_blk logicalsectorsize=512 sectorsize=512 signature=2681d385</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ <code>fdisk</code> æŸ¥çœ‹ç¡¬ç›˜åˆ†åŒºä¿¡æ¯ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â¯ fdisk -l</span><br><span class="line">Disk /dev/vda: 20 GiB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x13be70fb</span><br><span class="line"></span><br><span class="line">Device     Boot Start      End  Sectors Size Id Type</span><br><span class="line">/dev/vda1  *     2048 41940991 41938944  20G 83 Linux</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br></pre></td></tr></table></figure><h2 id="åˆ†åŒºå’Œæ ¼å¼åŒ–"><a href="#åˆ†åŒºå’Œæ ¼å¼åŒ–" class="headerlink" title="åˆ†åŒºå’Œæ ¼å¼åŒ–"></a>åˆ†åŒºå’Œæ ¼å¼åŒ–</h2><p>åœ¨ç€æ‰‹åˆ†åŒºä¹‹å‰ï¼Œé¦–å…ˆæœ€é‡è¦çš„æ˜¯ç¡®å®šåˆ†åŒºæ–¹æ¡ˆã€‚</p><h3 id="åˆ†åŒºæ–¹æ¡ˆ"><a href="#åˆ†åŒºæ–¹æ¡ˆ" class="headerlink" title="åˆ†åŒºæ–¹æ¡ˆ"></a>åˆ†åŒºæ–¹æ¡ˆ</h3><p>æˆ‘çš„è¿™å°é˜¿é‡Œäº‘ ecs è‡ªå¸¦çš„ç¡¬ç›˜æ˜¯ 20G çš„â€œé«˜æ•ˆäº‘ç›˜â€ï¼ˆä¼°è®¡å°±æ˜¯ä¸€èˆ¬çš„ HDDï¼‰ï¼Œè¿™æ¬¡å‘ç”Ÿç¡¬ç›˜ç©ºé—´ä¸è¶³ä¸»è¦æ˜¯ <code>home</code> ç›®å½•å’Œ <code>var</code> ç›®å½•ï¼Œæ‰€ä»¥æœ¬æ¬¡æ‰©å®¹+è¿ç§»çš„ä¸»è¦ç›®æ ‡ä¹Ÿæ˜¯è¿™ä¸¤ä¸ªç›®å½•ã€‚</p><p>å‚è€ƒ n ä¸ªç»å…¸ linux åˆ†åŒºæ–¹æ¡ˆï¼Œå¦å¤–ä¸€ä¸ªå¯ä»¥çº³å…¥è€ƒè™‘çš„æ˜¯ <code>swap</code> åˆ†åŒºï¼Œä½¿ç”¨ <code>free -h</code> æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°æœ¬æœºç‰©ç†å†…å­˜åªæœ‰ 2Gï¼ŒåŠ ä¹‹ä¹‹å‰åœ¨è¿è¡Œ docker çš„æ—¶å€™å¿˜è®°å¼€äº†æ€§èƒ½é™åˆ¶ï¼Œè„šæœ¬é€»è¾‘å¯¼è‡´æœºå™¨å†…å­˜åƒæ»¡å¯¼è‡´ ssh éƒ½ç™»å½•ä¸ä¸Šçš„æƒ…å†µï¼Œæ‰€ä»¥é€‚å½“æ·»åŠ è™šæ‹Ÿå†…å­˜ <code>swap</code> åˆ†åŒºåœ¨æœ¬æ¬¡æ˜¯ä¸€ä¸ªå¯å–çš„æ–¹æ¡ˆã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â¯ free -h</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          1.8Gi       648Mi       204Mi       2.0Mi       1.0Gi       1.0Gi</span><br><span class="line">Swap:            0B          0B          0B</span><br></pre></td></tr></table></figure><p>ç”±äºæ·»åŠ çš„æ˜¯ä¸€ä¸ª 100G çš„ç¡¬ç›˜ï¼Œæ‰€ä»¥æˆ‘å†³å®šçš„åˆ†é…æ–¹æ¡ˆä¸ºï¼š</p><table><thead><tr><th align="left">åºå·</th><th align="center">æŒ‚è½½ç‚¹</th><th align="right">å¤§å°</th><th align="center">æ‹“å±•åˆ†åŒº</th></tr></thead><tbody><tr><td align="left">0</td><td align="center">swap</td><td align="right">16G</td><td align="center"></td></tr><tr><td align="left">1</td><td align="center">&#x2F;var</td><td align="right">20G</td><td align="center">âˆš</td></tr><tr><td align="left">2</td><td align="center">&#x2F;home</td><td align="right">64G</td><td align="center">âˆš</td></tr><tr><td align="left">æ€»åˆ</td><td align="center"></td><td align="right">100G</td><td align="center"></td></tr></tbody></table><p>å› ä¸º swap åˆ†åŒºçš„çµæ´»æ€§æ¯”è¾ƒå¼ºï¼Œæ‰€ä»¥å•ç‹¬åˆ’åˆ†ä¸€ä¸ªä¸»åˆ†åŒºç»™å®ƒï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€çš„æ—¶å€™åˆ’åˆ†ç”¨ä½œå…¶ä»–ç”¨é€”ï¼ˆè™½ç„¶åˆ†é… 16G å¯¹äºè¿™å°æœºå™¨æ¥è¯´ç€å®æ˜¯ç»°ç»°æœ‰ä½™äº†ï¼‰ã€‚</p><p>è€Œ var å’Œ home åˆ†åŒºæ„ä¹‰ä¸Šéƒ½å±äºæ˜¯æ•°æ®åŒºï¼Œæ‰€ä»¥å¯ä»¥æ”¾åœ¨ä¸€èµ·ï¼Œç”±ä¸€ä¸ªé€»è¾‘æ‹“å±•åˆ†åŒºåˆ†å‡ºæ¥ã€‚</p><p>ä»¥ä¸Šåªæ˜¯æˆ‘è‡ªå·±ä¸æˆç†Ÿçš„ç†è§£ï¼Œå¦‚æœçœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„å¤§ä½¬æœ‰æ›´å¥½çš„è§è§£ï¼Œå¸Œæœ›å¯ä»¥åœ¨è¯„è®ºåŒºç»™äºˆæŒ‡å¯¼ï¼Œè°¢è°¢ï¼</p><h3 id="åˆ†åŒºæ“ä½œ"><a href="#åˆ†åŒºæ“ä½œ" class="headerlink" title="åˆ†åŒºæ“ä½œ"></a>åˆ†åŒºæ“ä½œ</h3><p>ä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œå³ä½¿ç³»ç»Ÿä¸­æ²¡æœ‰ä½¿ç”¨ swap åˆ†åŒºï¼Œä¹Ÿæ‰‹åŠ¨æ˜¾å¼åœ°å…³é—­ä¸€ä¸‹ swap åŠŸèƒ½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ swapoff -a  <span class="comment"># å…³é—­æ‰€æœ‰çš„ swap</span></span><br><span class="line">â¯ swapoff /dev/xxx  <span class="comment"># å…³é—­æŸä¸ª swap åˆ†åŒº</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¹‹å‰æ‰€è¯´ï¼Œæ·»åŠ çš„æ˜¯ä¸€å— virtio ç±»å‹ç£ç›˜ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„æ˜¯<code>/dev/vdb</code>ï¼Œä½¿ç”¨ fdisk å¯¹ç£ç›˜åˆ†åŒºï¼Œåˆ†åŒºå…·ä½“æ­¥éª¤åœ¨ä¸‹é¢ï¼Œå¦‚æœå¤ªé•¿äº†çœ‹ä¸ä¸‹å»ï¼Œå¯ä»¥ç›´æ¥è·³åˆ° <a href="#%E6%A0%BC%E5%BC%8F%E5%8C%96">æ ¼å¼åŒ–æ“ä½œ</a>ã€‚åˆ†åŒºæ“ä½œæˆ‘å°½é‡åŠ å…¥æ³¨é‡Šã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">â¯ fdisk /dev/vdb</span><br><span class="line"></span><br><span class="line">Welcome to fdisk (util-linux 2.34).</span><br><span class="line">Changes will remain <span class="keyword">in</span> memory only, until you decide to write them.</span><br><span class="line">Be careful before using the write <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p  <span class="comment"># æŸ¥çœ‹å½“å‰ç¡¬ç›˜åˆ†åŒºç»“æ„</span></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Device     Boot Start       End   Sectors  Size Id Type</span><br><span class="line">/dev/vdb1        2048 209715199 209713152  100G 83 Linux</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): d  <span class="comment"># åˆ é™¤åˆ†åŒºï¼Œå› ä¸ºåŸæ¥åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œæ‰€ä»¥é»˜è®¤åˆ é™¤äº†ç¬¬ä¸€ä¸ªåˆ†åŒº</span></span><br><span class="line">Selected partition 1</span><br><span class="line">Partition 1 has been deleted.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p  <span class="comment"># å†æ¬¡æŸ¥çœ‹åˆ†åŒºç»“æ„ï¼Œæ˜¾ç¤ºå·²ç»æ²¡æœ‰åˆ†åŒº</span></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n     <span class="comment"># (new)æ–°å»ºåˆ†åŒºï¼Œæç¤ºè¦é€‰æ‹©åˆ†åŒºç±»å‹ï¼Œä¸»åˆ†åŒºæˆ–è€…é€»è¾‘åˆ†åŒºã€‚</span></span><br><span class="line">Partition <span class="built_in">type</span>              <span class="comment"># é€»è¾‘åˆ†åŒºä¹Ÿæ˜¯ä¸€ç§ä¸»åˆ†åŒºï¼Œå ç”¨ä¸€ä¸ªä¸»åˆ†åŒºåé¢ã€‚</span></span><br><span class="line">   p   primary (0 primary, 0 extended, 4 free)      <span class="comment"># ä¸»åˆ†åŒºä¸€å…±åªèƒ½æœ‰4ä¸ªã€‚</span></span><br><span class="line">   e   extended (container <span class="keyword">for</span> logical partitions)</span><br><span class="line">Select (default p): p       <span class="comment"># é€‰æ‹©æ–°å»ºä¸€ä¸ªä¸»åˆ†åŒº</span></span><br><span class="line">Partition number (1-4, default 1):      <span class="comment"># ç›´æ¥&lt;å›è½¦&gt;ä½¿ç”¨é»˜è®¤ç»™çš„1å·åˆ†åŒºå·</span></span><br><span class="line">First sector (2048-209715199, default 2048):    <span class="comment"># ç›´æ¥å›è½¦ä½¿ç”¨èµ·å§‹æ‰‡åŒº</span></span><br><span class="line">Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (2048-209715199, default 209715199): +16G <span class="comment"># è¾“å…¥â€œ+16Gâ€è¡¨ç¤ºåˆ†é…16Gçš„ç©ºé—´</span></span><br><span class="line"></span><br><span class="line">Created a new partition 1 of <span class="built_in">type</span> <span class="string">&#x27;Linux&#x27;</span> and of size 16 GiB.</span><br><span class="line">Partition <span class="comment">#1 contains a ext4 signature.</span></span><br><span class="line"></span><br><span class="line">Do you want to remove the signature? [Y]es/[N]o: Y  <span class="comment"># ç§»é™¤åŸæœ‰åˆ†åŒºæ ‡å¿—</span></span><br><span class="line"></span><br><span class="line">The signature will be removed by a write <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): t     <span class="comment"># è¾“å…¥tè¡¨ç¤ºä¿®æ”¹åˆ†åŒºç±»å‹</span></span><br><span class="line">Selected partition 1        <span class="comment"># å› ä¸ºå½“å‰åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œæ‰€ä»¥fdiské»˜è®¤é€‰æ‹©äº†è¿™ä¸ª</span></span><br><span class="line">Hex code (<span class="built_in">type</span> L to list all codes): 82     <span class="comment"># è¾“å…¥82ï¼Œè¡¨ç¤ºswapåˆ†åŒºçš„idç±»å‹</span></span><br><span class="line">Changed <span class="built_in">type</span> of partition <span class="string">&#x27;Linux&#x27;</span> to <span class="string">&#x27;Linux swap / Solaris&#x27;</span>.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p     <span class="comment"># æŸ¥çœ‹å½“å‰åˆ†åŒºè¡¨</span></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Device     Boot Start      End  Sectors Size Id Type</span><br><span class="line">/dev/vdb1        2048 33556479 33554432  16G 82 Linux swap / Solaris</span><br><span class="line"></span><br><span class="line">Filesystem/RAID signature on partition 1 will be wiped.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n     <span class="comment"># æ–°å»ºåˆ†åŒº</span></span><br><span class="line">Partition <span class="built_in">type</span></span><br><span class="line">   p   primary (1 primary, 0 extended, 3 free)</span><br><span class="line">   e   extended (container <span class="keyword">for</span> logical partitions)</span><br><span class="line">Select (default p): e       <span class="comment"># æ–°å»ºæ‹“å±•åˆ†åŒº</span></span><br><span class="line">Partition number (2-4, default 2):                      <span class="comment"># ç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤èµ·å§‹æ‰‡åŒº</span></span><br><span class="line">First sector (33556480-209715199, default 33556480):    <span class="comment"># ç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤ç»“æŸæ‰‡åŒº</span></span><br><span class="line">Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (33556480-209715199, default 209715199): </span><br><span class="line"></span><br><span class="line">Created a new partition 2 of <span class="built_in">type</span> <span class="string">&#x27;Extended&#x27;</span> and of size 84 GiB.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p     <span class="comment"># æŸ¥çœ‹å½“å‰åˆ†åŒºè¡¨</span></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Device     Boot    Start       End   Sectors Size Id Type</span><br><span class="line">/dev/vdb1           2048  33556479  33554432  16G 82 Linux swap / Solaris</span><br><span class="line">/dev/vdb2       33556480 209715199 176158720  84G  5 Extended</span><br><span class="line"></span><br><span class="line">Filesystem/RAID signature on partition 1 will be wiped.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n     <span class="comment"># æ–°å»ºåˆ†åŒº</span></span><br><span class="line">All space <span class="keyword">for</span> primary partitions is <span class="keyword">in</span> use.     <span class="comment"># fdiskæç¤ºç›®å‰æ‰€æœ‰ç©ºé—´éƒ½è¢«ä¸»åˆ†åŒºä½¿ç”¨äº†</span></span><br><span class="line">Adding logical partition 5                      <span class="comment"># æ‰€ä»¥åœ¨æ‹“å±•åˆ†åŒºä¸­æ·»åŠ é€»è¾‘åˆ†åŒº</span></span><br><span class="line">First sector (33558528-209715199, default 33558528):    <span class="comment"># ç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤èµ·å§‹æ‰‡åŒº</span></span><br><span class="line">Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (33558528-209715199, default 209715199): +20G     <span class="comment"># è¾“å…¥â€œ+20Gâ€è¡¨ç¤ºé™åˆ¶å½“å‰åˆ†åŒºå¤§å°20G</span></span><br><span class="line"></span><br><span class="line">Created a new partition 5 of <span class="built_in">type</span> <span class="string">&#x27;Linux&#x27;</span> and of size 20 GiB.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p     <span class="comment"># æŸ¥çœ‹å½“å‰åˆ†åŒºè¡¨</span></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Device     Boot    Start       End   Sectors Size Id Type</span><br><span class="line">/dev/vdb1           2048  33556479  33554432  16G 82 Linux swap / Solaris</span><br><span class="line">/dev/vdb2       33556480 209715199 176158720  84G  5 Extended</span><br><span class="line">/dev/vdb5       33558528  75501567  41943040  20G 83 Linux</span><br><span class="line"></span><br><span class="line">Filesystem/RAID signature on partition 1 will be wiped.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): n     <span class="comment"># æ–°å»ºåˆ†åŒº</span></span><br><span class="line">All space <span class="keyword">for</span> primary partitions is <span class="keyword">in</span> use.     <span class="comment"># fdiskæç¤ºç›®å‰æ‰€æœ‰ç©ºé—´éƒ½è¢«ä¸»åˆ†åŒºä½¿ç”¨äº†</span></span><br><span class="line">Adding logical partition 6                      <span class="comment"># æ‰€ä»¥åœ¨æ‹“å±•åˆ†åŒºä¸­æ·»åŠ é€»è¾‘åˆ†åŒº</span></span><br><span class="line">First sector (75503616-209715199, default 75503616):    <span class="comment"># ç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤èµ·å§‹æ‰‡åŒº</span></span><br><span class="line">Last sector, +/-sectors or +/-size&#123;K,M,G,T,P&#125; (75503616-209715199, default 209715199): <span class="comment"># ç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤ç»“æŸæ‰‡åŒºï¼Œä½¿ç”¨æ‰€æœ‰å‰©ä½™ç©ºé—´æ–°å»ºåˆ†åŒº</span></span><br><span class="line"></span><br><span class="line">Created a new partition 6 of <span class="built_in">type</span> <span class="string">&#x27;Linux&#x27;</span> and of size 64 GiB.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): p     <span class="comment"># æŸ¥çœ‹å½“å‰åˆ†åŒºè¡¨</span></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Device     Boot    Start       End   Sectors Size Id Type</span><br><span class="line">/dev/vdb1           2048  33556479  33554432  16G 82 Linux swap / Solaris</span><br><span class="line">/dev/vdb2       33556480 209715199 176158720  84G  5 Extended</span><br><span class="line">/dev/vdb5       33558528  75501567  41943040  20G 83 Linux</span><br><span class="line">/dev/vdb6       75503616 209715199 134211584  64G 83 Linux</span><br><span class="line"></span><br><span class="line">Filesystem/RAID signature on partition 1 will be wiped.</span><br><span class="line"></span><br><span class="line">Command (m <span class="keyword">for</span> <span class="built_in">help</span>): w     <span class="comment"># (write)å†™å…¥æ”¹åŠ¨ï¼Œä½¿å¾—åˆ†åŒºè¡¨ç”Ÿæ•ˆ</span></span><br><span class="line">The partition table has been altered.</span><br><span class="line">Calling ioctl() to re-read partition table.</span><br><span class="line">Syncing disks.</span><br></pre></td></tr></table></figure><p>é€€å‡ºåä½¿ç”¨<code>fdisk -l</code>æŸ¥çœ‹åˆ†åŒºç»“æœã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">â¯ fdisk -l</span><br><span class="line">Disk /dev/vda: 20 GiB, 21474836480 bytes, 41943040 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x13be70fb</span><br><span class="line"></span><br><span class="line">Device     Boot Start      End  Sectors Size Id Type</span><br><span class="line">/dev/vda1  *     2048 41940991 41938944  20G 83 Linux</span><br><span class="line"></span><br><span class="line">Disk /dev/vdb: 100 GiB, 107374182400 bytes, 209715200 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class="line">Disklabel <span class="built_in">type</span>: dos</span><br><span class="line">Disk identifier: 0x2681d385</span><br><span class="line"></span><br><span class="line">Device     Boot    Start       End   Sectors Size Id Type</span><br><span class="line">/dev/vdb1           2048  33556479  33554432  16G 82 Linux swap / Solaris</span><br><span class="line">/dev/vdb2       33556480 209715199 176158720  84G  5 Extended</span><br><span class="line">/dev/vdb5       33558528  75501567  41943040  20G 83 Linux</span><br><span class="line">/dev/vdb6       75503616 209715199 134211584  64G 83 Linux</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ lsblk æŸ¥çœ‹å—ç¡¬ä»¶ä¿¡æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â¯ lsblk</span><br><span class="line">NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">vda    252:0    0   20G  0 disk </span><br><span class="line">â””â”€vda1 252:1    0   20G  0 part /</span><br><span class="line">vdb    252:16   0  100G  0 disk </span><br><span class="line">â”œâ”€vdb1 252:17   0   16G  0 part [SWAP]</span><br><span class="line">â”œâ”€vdb2 252:18   0    1K  0 part </span><br><span class="line">â”œâ”€vdb5 252:21   0   20G  0 part </span><br><span class="line">â””â”€vdb6 252:22   0   64G  0 part</span><br></pre></td></tr></table></figure><h3 id="æ ¼å¼åŒ–"><a href="#æ ¼å¼åŒ–" class="headerlink" title="æ ¼å¼åŒ–"></a>æ ¼å¼åŒ–</h3><h4 id="swap-åˆ†åŒº"><a href="#swap-åˆ†åŒº" class="headerlink" title="swap åˆ†åŒº"></a>swap åˆ†åŒº</h4><p>æ ¼å¼åŒ– swap åˆ†åŒºå¯ä»¥ä½¿ç”¨ mkswapã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œswap åˆ†åŒºéœ€è¦åœ¨åˆ†åŒºçš„æ—¶å€™ç»™åˆ†åŒº ID æ³¨å†Œä¸º 82ï¼Œè¿™æ ·åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™æ‰å¯ä»¥æ­£å¸¸æŒ‚è½½åˆ†åŒºä¸º swapï¼ˆå…·ä½“æ­¥éª¤åœ¨ <a href="#%E5%88%86%E5%8C%BA%E6%93%8D%E4%BD%9C%EF%BC%89%E7%AB%A0%E8%8A%82">åˆ†åŒº</a>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â¯ mkswap /dev/vdb1  <span class="comment"># æ ¼å¼åŒ–ä¸º swap</span></span><br><span class="line">Setting up swapspace version 1, size = 16 GiB (17179865088 bytes)</span><br><span class="line">no label, UUID=220e512a-12a9-4a92-9668-24268004d8ab</span><br><span class="line">â¯ swapon /dev/vdb1  <span class="comment"># å¯ç”¨ swap åˆ†åŒº</span></span><br><span class="line">â¯ free -h  <span class="comment"># æŸ¥çœ‹ swap å¯ç”¨æƒ…å†µ</span></span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          1.8Gi       652Mi       201Mi       2.0Mi       1.0Gi       1.0Gi</span><br><span class="line">Swap:          15Gi          0B        15Gi</span><br></pre></td></tr></table></figure><p>swapon æ˜¯æ‰‹åŠ¨æ‰§è¡ŒæŒ‚è½½ swap çš„æ“ä½œï¼Œå…³æœºé‡å¯ä¼šä¸¢å¤±æŒ‚è½½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å°†æŒ‚è½½ swap çš„æ“ä½œæ·»åŠ åˆ°å¼€æœºæŒ‚è½½ç›®å½•çš„æµç¨‹ä¸­ã€‚ä½¿ç”¨ç¼–è¾‘å™¨ç¼–è¾‘<code>/etc/fstab</code>ï¼ŒåŠ å…¥ä¸‹é¢è¿™è¡Œå†…å®¹å³å¯ï¼Œå½“ç„¶ï¼Œå¼€å¤´çš„è®¾å¤‡æ–‡ä»¶æ˜ å°„ç¬¦è¦æ¢æˆå®é™…çš„è®¾å¤‡æ˜ å°„ç¬¦ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ vim /etc/fstab  <span class="comment"># æ·»åŠ ä¸‹é¢è¿™è¡Œ</span></span><br><span class="line">/dev/vdb1  swap  swap  defaults  0  0</span><br></pre></td></tr></table></figure><h4 id="x2F-var-å’Œ-x2F-home-ç­‰æ•°æ®åˆ†åŒº"><a href="#x2F-var-å’Œ-x2F-home-ç­‰æ•°æ®åˆ†åŒº" class="headerlink" title="&#x2F;var å’Œ&#x2F;home ç­‰æ•°æ®åˆ†åŒº"></a>&#x2F;var å’Œ&#x2F;home ç­‰æ•°æ®åˆ†åŒº</h4><p>å°† &#x2F;dev&#x2F;vdb5 å’Œ &#x2F;dev&#x2F;vdb6 æ ¼å¼åŒ–ä¸º ext4 æ ¼å¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â¯ mkfs.ext4 /dev/vdb5</span><br><span class="line">mke2fs 1.45.5 (07-Jan-2020)</span><br><span class="line">Creating filesystem with 5242880 4k blocks and 1310720 inodes</span><br><span class="line">Filesystem UUID: 0d80f6eb-ac15-4bdf-8e03-d97508495618</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">    32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, </span><br><span class="line">    4096000</span><br><span class="line"></span><br><span class="line">Allocating group tables: <span class="keyword">done</span>                            </span><br><span class="line">Writing inode tables: <span class="keyword">done</span>                            </span><br><span class="line">Creating journal (32768 blocks): <span class="keyword">done</span></span><br><span class="line">Writing superblocks and filesystem accounting information: <span class="keyword">done</span>   </span><br><span class="line"></span><br><span class="line">â¯ mkfs.ext4 /dev/vdb6</span><br><span class="line">mke2fs 1.45.5 (07-Jan-2020)</span><br><span class="line">Creating filesystem with 16776448 4k blocks and 4194304 inodes</span><br><span class="line">Filesystem UUID: 3fbc870d-3f3a-4182-86c2-690bcf1273b5</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">    32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, </span><br><span class="line">    4096000, 7962624, 11239424</span><br><span class="line"></span><br><span class="line">Allocating group tables: <span class="keyword">done</span>                            </span><br><span class="line">Writing inode tables: <span class="keyword">done</span>                            </span><br><span class="line">Creating journal (65536 blocks): <span class="keyword">done</span></span><br><span class="line">Writing superblocks and filesystem accounting information: <span class="keyword">done</span>   </span><br></pre></td></tr></table></figure><h4 id="è½¬ç§»æ•°æ®å’ŒæŒ‚è½½"><a href="#è½¬ç§»æ•°æ®å’ŒæŒ‚è½½" class="headerlink" title="è½¬ç§»æ•°æ®å’ŒæŒ‚è½½"></a>è½¬ç§»æ•°æ®å’ŒæŒ‚è½½</h4><p>å°† &#x2F;dev&#x2F;vdb6 æŒ‚è½½åˆ° &#x2F;mnt&#x2F;tmp ä¸‹ï¼Œä½¿ç”¨ rsync åŒæ­¥ &#x2F;home ç›®å½•ä¸‹å†…å®¹åˆ° vdb6 ä¸­ã€‚<br>rsync æ®è¯´æ˜¯å¯ä»¥ä»£æ›¿ cp å’Œ mv æŒ‡ä»¤çš„ï¼Œå…·ä½“ä½¿ç”¨æƒ…å†µå¯ä»¥çœ‹çœ‹ <a href="https://www.ruanyifeng.com/blog/2020/08/rsync.html">é˜®ä¸€å³°çš„ rsync æ•™ç¨‹</a>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â¯ <span class="built_in">mkdir</span> /mnt/tmp                   <span class="comment"># åˆ›å»ºä¸´æ—¶ç›®å½•</span></span><br><span class="line">â¯ mount /dev/vdb6 /mnt/tmp         <span class="comment"># æŒ‚è½½ vdb6</span></span><br><span class="line">â¯ rsync -ax /home/* /mnt/tmp       <span class="comment"># åŒæ­¥æ–‡ä»¶</span></span><br><span class="line">â¯ <span class="built_in">rm</span> -rf /home/*                   <span class="comment"># åˆ é™¤åŸå§‹ç›®å½•ä¸‹çš„æ–‡ä»¶</span></span><br><span class="line">â¯ mount /dev/vdb6 /home            <span class="comment"># å°† vdb6 æŒ‚è½½åˆ°/home ä¸Š</span></span><br><span class="line">â¯ umount /mnt/tmp                  <span class="comment"># å¸è½½ä¸´æ—¶ç›®å½•çš„æŒ‚è½½</span></span><br><span class="line">â¯ <span class="built_in">ls</span> /home                         <span class="comment"># ä½¿ç”¨ ls æŸ¥çœ‹æ–‡ä»¶æƒ…å†µ</span></span><br><span class="line">docker  download  go  lost+found  scripts</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶å·²ç»è½¬ç§»è¿‡æ¥äº†ï¼Œä½†æ˜¯å¤šäº†ä¸€ä¸ª <code>lost+found</code> ç›®å½•ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æ ¼å¼åŒ–åˆ†åŒºæ—¶è‡ªåŠ¨ç”Ÿæˆçš„ç›®å½•ï¼Œè¿™æ¬¡æ˜¯æ–°å¢çš„ç£ç›˜åˆ†åŒºï¼Œæ‰€ä»¥æ— éœ€ç†ä¼šç›´æ¥åˆ æ‰å³å¯ã€‚</p><p>ä¹‹åè¿˜éœ€è¦å°†åˆ†åŒºæŒ‚è½½æµç¨‹åƒ swap ä¸€æ ·åŠ å…¥åˆ°&#x2F;etc&#x2F;fstab æ–‡ä»¶ä¸­ï¼Œä½¿å¾—å¼€æœºè‡ªåŠ¨æŒ‚è½½ã€‚</p><p>å…ˆä½¿ç”¨ blkid è·å–åˆ°æ¯ä¸ªåˆ†åŒºçš„ idã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â¯ blkid</span><br><span class="line">/dev/vda1: LABEL=<span class="string">&quot;/&quot;</span> UUID=<span class="string">&quot;abf381e7-98ce-491f-85d5-f16aa9b23811&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;13be70fb-01&quot;</span></span><br><span class="line">/dev/vdb1: UUID=<span class="string">&quot;220e512a-12a9-4a92-9668-24268004d8ab&quot;</span> TYPE=<span class="string">&quot;swap&quot;</span> PARTUUID=<span class="string">&quot;2681d385-01&quot;</span></span><br><span class="line">/dev/vdb5: UUID=<span class="string">&quot;0d80f6eb-ac15-4bdf-8e03-d97508495618&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;2681d385-05&quot;</span></span><br><span class="line">/dev/vdb6: UUID=<span class="string">&quot;3fbc870d-3f3a-4182-86c2-690bcf1273b5&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;2681d385-06&quot;</span></span><br></pre></td></tr></table></figure><p>åƒæˆ‘è¿™é‡Œå› ä¸ºæ˜¯ç”¨ &#x2F;dev&#x2F;vdb6 æŒ‚è½½åˆ° &#x2F;homeï¼Œæ‰€ä»¥ UUID æ˜¯<code>3fbc870d-3f3a-4182-86c2-690bcf1273b5</code>ï¼Œè·å–åˆ°äº† UUID ä¹‹åï¼Œåœ¨&#x2F;etc&#x2F;fstab æ·»åŠ ä¸‹é¢ä¸€è¡Œå³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ vim /etc/fstab</span><br><span class="line">UUID=3fbc870d-3f3a-4182-86c2-690bcf1273b5 /home           ext4    defaults      0       2</span><br></pre></td></tr></table></figure><p>æ¥ç€å¦‚æ³•ç‚®åˆ¶ &#x2F;dev&#x2F;vdb5 æŒ‚è½½åˆ° &#x2F;var ç›®å½•ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â¯ mount /dev/vdb5 /mnt/tmp</span><br><span class="line">â¯ rsync -ax /var/* /mnt/tmp</span><br><span class="line">â¯ <span class="built_in">rm</span> -rf /var/*</span><br><span class="line">â¯ mount /dev/vdb5 /var</span><br><span class="line">â¯ blkid</span><br><span class="line">/dev/vda1: LABEL=<span class="string">&quot;/&quot;</span> UUID=<span class="string">&quot;abf381e7-98ce-491f-85d5-f16aa9b23811&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;13be70fb-01&quot;</span></span><br><span class="line">/dev/vdb1: UUID=<span class="string">&quot;220e512a-12a9-4a92-9668-24268004d8ab&quot;</span> TYPE=<span class="string">&quot;swap&quot;</span> PARTUUID=<span class="string">&quot;2681d385-01&quot;</span></span><br><span class="line">/dev/vdb5: UUID=<span class="string">&quot;0d80f6eb-ac15-4bdf-8e03-d97508495618&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;2681d385-05&quot;</span></span><br><span class="line">/dev/vdb6: UUID=<span class="string">&quot;3fbc870d-3f3a-4182-86c2-690bcf1273b5&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span> PARTUUID=<span class="string">&quot;2681d385-06&quot;</span></span><br><span class="line">â¯ vim /etc/fstab</span><br><span class="line">UUID=0d80f6eb-ac15-4bdf-8e03-d97508495618 /var           ext4    defaults      0       2</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œä½¿ç”¨ df æŸ¥çœ‹ï¼Œä¸€åˆ‡ç›®å½•æŒ‚è½½å ç”¨æ­£å¸¸å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â¯ <span class="built_in">df</span> -hT</span><br><span class="line">Filesystem     Type      Size  Used Avail Use% Mounted on</span><br><span class="line">udev           devtmpfs  914M     0  914M   0% /dev</span><br><span class="line">tmpfs          tmpfs     189M  1.2M  188M   1% /run</span><br><span class="line">/dev/vda1      ext4       20G  7.1G   12G  38% /</span><br><span class="line">tmpfs          tmpfs     943M     0  943M   0% /dev/shm</span><br><span class="line">tmpfs          tmpfs     5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs          tmpfs     943M     0  943M   0% /sys/fs/cgroup</span><br><span class="line">tmpfs          tmpfs     189M  4.0K  189M   1% /run/user/0</span><br><span class="line">/dev/vdb6      ext4       63G  5.9G   54G  10% /home</span><br><span class="line">/dev/vdb5      ext4       20G  6.9G   12G  37% /var</span><br></pre></td></tr></table></figure><h3 id="x2F-etc-x2F-fstab-æ–‡ä»¶å¡«å†™è¦ç´ "><a href="#x2F-etc-x2F-fstab-æ–‡ä»¶å¡«å†™è¦ç´ " class="headerlink" title="&#x2F;etc&#x2F;fstab æ–‡ä»¶å¡«å†™è¦ç´ "></a>&#x2F;etc&#x2F;fstab æ–‡ä»¶å¡«å†™è¦ç´ </h3><p>åœ¨ç¼–è¾‘ fstab çš„è¿‡ç¨‹ä¸­å¯¹æ¯ä¸ªå‚æ•°çš„æ„ä¹‰äº§ç”Ÿäº†ç–‘æƒ‘ï¼Œæ‰€ä»¥æŸ¥æ‰¾äº†ä¸€äº›èµ„æ–™å¹¶ä¸”æ€»ç»“ä¸€ä¸‹ï¼š</p><p>ä¾‹å¦‚ä¸‹é¢è¿™æ¡è®°å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID=3fbc870d-3f3a-4182-86c2-690bcf1273b5  /home  ext4  defaults  0  2</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä» fstab çš„æ–‡ä»¶çš„å¤´éƒ¨æ³¨é‡Šä¸­å¯ä»¥è·å–åˆ°ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯èƒ½å¤Ÿä»£è¡¨æŒ‚è½½ç‚¹çš„ç¡¬ä»¶æ–‡ä»¶ç³»ç»Ÿï¼Œç¬¬äºŒä¸ªæ˜¯æŒ‚è½½ç‚¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ç¡¬ä»¶åˆ†åŒºç±»å‹ï¼Œç¬¬å››ä¸ªæ˜¯æŒ‚è½½é€‰é¡¹ï¼Œä½†æ˜¯è¿˜æ˜¯å¾ˆéš¾æ˜ç¡®æœ€åä¸¤ä¸ªæ•°å­—çš„æ„ä¹‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># /etc/fstab: static file system information.</span><br><span class="line"># </span><br><span class="line"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span><br><span class="line"># device; this may be used with UUID= as a more robust way to name devices</span><br><span class="line"># that works even if disks are added and removed. See fstab(5).</span><br><span class="line">#</span><br><span class="line"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="line"># / was on /dev/vda1 during installation</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å¯¹äºå…­ä¸ªå‚æ•°çš„æ„ä¹‰çš„æ˜ç¡®ï¼š</p><ol><li><p>è®¾å¤‡</p><blockquote><p>æ„ä¹‰ï¼šè¦æŒ‚è½½çš„è®¾å¤‡<br>è¾“å…¥ç±»å‹ï¼š</p><ul><li>è®¾å¤‡æ–‡ä»¶</li><li>LABEL&#x3D;</li><li>UUID&#x3D;</li></ul></blockquote></li><li><p>æŒ‚è½½ç‚¹</p><blockquote><p>swap æ²¡æœ‰æŒ‚è½½ç‚¹ï¼ŒæŒ‚è½½ç‚¹ä¸º swap<br>å…¶ä½™å¯ä»¥å¡«å†™ä¸ºç›®å½•åç§°ï¼Œä¾‹å¦‚&#x2F;home</p></blockquote></li><li><p>æ–‡ä»¶ç³»ç»Ÿç±»å‹</p><blockquote><p>ext2ã€ext3ã€ext4ã€xfsã€nfsã€smbã€iso9660 ç­‰</p></blockquote></li><li><p>æŒ‚è½½é€‰é¡¹</p><blockquote><p>asyncã€syncã€_netdev<br>defaultsï¼ˆ rw,  suid, dev, exec, auto, nouser, async, and relatime.ï¼‰</p></blockquote></li><li><p>è½¬å‚¨é¢‘åº¦</p><blockquote><p>0ï¼šä»ä¸å¤‡ä»½<br>1ï¼šæ¯æ—¥å¤‡ä»½<br>2ï¼šæ¯éš”ä¸€å¤©å¤‡ä»½</p></blockquote></li><li><p>è‡ªæ£€æ¬¡åº</p><blockquote><p>0: ä¸è‡ªæ£€<br>1ï¼šé¦–å…ˆè‡ªæ£€ï¼Œé€šå¸¸åªèƒ½è¢«&#x2F;ä½¿ç”¨ï¼›<br>2ï¼šç­‰æ•°å­—ä¸º 1 çš„è‡ªæ£€å®Œæˆåï¼Œå†è¿›è¡Œè‡ªæ£€</p></blockquote></li></ol><hr><p>å‚è€ƒèµ„æ–™ï¼š</p><ul><li><a href="https://www.jianshu.com/p/5c12289dbcd1">ç®€ä¹¦ - Ubuntu æŒ‚è½½æ–°ç¡¬ç›˜å¹¶æŠŠ home ç›®å½•è¿ç§»åˆ°æ–°ç¡¬ç›˜</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç”±äºåœ¨æŠ˜è…¾&lt;code&gt;é’é¾™é¢æ¿+XDD&lt;/code&gt;çš„æ—¶å€™é…ç½®äº†ä¸€å¥— Golang çš„ç¯å¢ƒï¼Œå¯¼è‡´ä¸ºæ•°ä¸å¤šçš„ç¡¬ç›˜ç©ºé—´è¢«åƒå¹²å‡€äº†ï¼ˆæ²¡é”™ï¼Œå‰©ä½™é‡å°±æ˜¯è¿™ä¹ˆå°‘ï¼‰ã€‚è€ƒè™‘åˆ°æœºå™¨è¿˜ä¼šç”¨å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæ‰€ä»¥å†³å®šå¢åŠ ä¸€å—ç¡¬ç›˜å¯¹æœºå™¨è¿›è¡Œæ‰©å®¹ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Linux Learning" scheme="https://hexo.chensmallx.top/categories/Linux-Learning/"/>
    
    
    <category term="Linux" scheme="https://hexo.chensmallx.top/tags/Linux/"/>
    
    <category term="Ubuntu" scheme="https://hexo.chensmallx.top/tags/Ubuntu/"/>
    
    <category term="ç£ç›˜æ‰©å®¹" scheme="https://hexo.chensmallx.top/tags/%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨docker-composeæ­å»ºnextcloud+Nginx+MySQL+Redis</title>
    <link href="https://hexo.chensmallx.top/2021/04/08/nextcloud-on-docker/"/>
    <id>https://hexo.chensmallx.top/2021/04/08/nextcloud-on-docker/</id>
    <published>2021-04-08T11:09:52.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<p>éœ€è¦é…ç½®å¯ä»¥ç›´æ¥è·³åˆ°<a href="/2021/04/08/nextcloud-on-docker/#docker-compose%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">docker-compose</a></p><span id="more"></span><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å»å¹´ä½¿ç”¨é—²ç½®çš„é˜¿é‡Œäº‘å°é¸¡ç»™åä¼šæ­å»ºäº†ä¸€ä¸ªå…¬ç”¨çš„ç½‘ç›˜ï¼Œé‡‡ç”¨çš„æ˜¯nextcloudä½œä¸ºæ¡†æ¶ï¼Œé€‰æ‹©nextcloudçš„åŸå› ä¸»è¦æ˜¯å› ä¸ºå®ƒå¯ä»¥ä½¿ç”¨dockerè¿›è¡Œéƒ¨ç½²ï¼Œè€Œä¸”åˆæ˜¯å¼€æºçš„ï¼Œæ²¡æœ‰å…è´¹ç‰ˆã€æèµ ç‰ˆæˆ–è€…ä¼ä¸šç‰ˆä¹‹ç±»çš„ç‰ˆæœ¬åŒºåˆ«ï¼Œåªè¦èƒ½å¤Ÿéƒ¨ç½²ï¼Œé‚£å°±èƒ½ç”¨ã€‚</p><p>ä¹‹å‰éƒ¨ç½²çš„æ—¶å€™åŒ†åŒ†å¿™å¿™ï¼Œå•çº¯ä¸ºäº†æŠ“ç´§æ—¶é—´ä¸Šçº¿å°±èµ¶é¸­å­ä¸Šæ¶ï¼Œæ­å»ºäº†ä¸€ä¸ªæœ€ç®€é™‹çš„dockerç‰ˆnextcloudï¼Œè™½ç„¶ç”¨èµ·æ¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æ¯æ¬¡è‡ªå·±è®¿é—®éƒ½ä¼šæ„Ÿè§‰åˆ°æ€§èƒ½æ‰æ€¥ï¼Œæƒ³è¦æ”¹å–„ä¸€ä¸‹ç°çŠ¶ï¼Œåˆ©ç”¨æœ‰é™çš„ç¡¬ä»¶èµ„æºå‘æŒ¥æœ€å¤§çš„æ€§èƒ½ã€‚</p><p>æ‰€ä»¥æœ€è¿‘ï¼ŒæŒ‘äº†ä¸€ä¸ªå¤§å®¶ä¸å’‹ä½¿ç”¨çš„æ—¶é—´æŠŠç½‘ç›˜ä¸‹çº¿äº†ä¸€ä¸ªæ˜ŸæœŸï¼Œå‡çº§äº†ç½‘ç›˜çš„éƒ¨ç½²æ–¹å¼å’Œæ·»åŠ äº†ä¸€äº›åŠŸèƒ½ã€‚</p><h3 id="ç¨å¾®å¸¦è¿‡ä¸€ä¸‹å®‰è£…dockerçš„æ–¹æ³•"><a href="#ç¨å¾®å¸¦è¿‡ä¸€ä¸‹å®‰è£…dockerçš„æ–¹æ³•" class="headerlink" title="ç¨å¾®å¸¦è¿‡ä¸€ä¸‹å®‰è£…dockerçš„æ–¹æ³•"></a>ç¨å¾®å¸¦è¿‡ä¸€ä¸‹å®‰è£…dockerçš„æ–¹æ³•</h3><p>ä»¥Ubuntu 20.04ä¸ºä¾‹ï¼Œå…¶ä»–æ“ä½œç³»ç»Ÿå¯ä»¥è‡ªè¡ŒæŸ¥æ‰¾èµ„æ–™ã€‚</p><ul><li><p>é¦–å…ˆæ˜¯å¸è½½åŸæœ‰çš„Dockerã€‚è¿™é‡Œè¦è®²ä¸€ä¸ªé¢˜å¤–è¯ï¼Œå°±æ˜¯dockeråœ¨è€ç‰ˆæœ¬ä¸­æ˜¯å«åšDockerçš„ï¼Œæ–°ç‰ˆå°±æŠŠå¤§å†™Dæ”¹ä¸ºäº†å°å†™çš„dã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get remove docker \</span><br><span class="line">              docker-engine \</span><br><span class="line">              docker.io \</span><br><span class="line">              containerd \</span><br><span class="line">              runc</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…æ–°Docker</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®˜æ–¹è„šæœ¬ ä½¿ç”¨é˜¿é‡Œäº‘æº</span></span><br><span class="line">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</span><br><span class="line"><span class="comment"># æˆ–å›½å†…daocloudæº</span></span><br><span class="line">curl -sSL https://get.daocloud.io/docker | sh</span><br></pre></td></tr></table></figure></li><li><p>è€Œæœ¬æ–‡éœ€è¦ä½¿ç”¨docker-composeï¼Œæ‰€ä»¥è¿™é‡Œè¿˜è¦å®‰è£…ä¸€ä¸‹ï¼Œä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ‰§è¡Œè„šæœ¬å°±è¡Œäº†ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½ Docker Compose çš„å½“å‰ç¨³å®šç‰ˆæœ¬</span></span><br><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.24.1/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="comment"># ä¸‹è½½ Docker Compose çš„å½“å‰ç¨³å®šç‰ˆæœ¬</span></span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br><span class="line"><span class="comment"># åˆ›å»ºè½¯é“¾</span></span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span><br><span class="line"><span class="comment"># æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure><p>  ä½†æ˜¯ä½¿ç”¨ä»¥ä¸Šæ–¹æ³•å®‰è£…æ¯”è¾ƒç¹çï¼Œä¹Ÿæ¯”è¾ƒéš¾ä»¥ç®¡ç†ï¼Œæ‰€ä»¥æˆ‘æ¨èä½¿ç”¨pythonçš„pipå®‰è£…ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ pip å®‰è£… docker-compose</span></span><br><span class="line">sudo pip install docker-compose</span><br><span class="line"><span class="comment"># æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure></li></ul><h3 id="åŸæœ‰çš„å•å®¹å™¨nextcloudæ­å»ºæ–¹æ³•"><a href="#åŸæœ‰çš„å•å®¹å™¨nextcloudæ­å»ºæ–¹æ³•" class="headerlink" title="åŸæœ‰çš„å•å®¹å™¨nextcloudæ­å»ºæ–¹æ³•"></a>åŸæœ‰çš„å•å®¹å™¨nextcloudæ­å»ºæ–¹æ³•</h3><p>dockerçš„ä¼˜è¶Šæ€§æƒ³å¿…éƒ½æ¯”è¾ƒæ¸…æ¥šäº†ï¼Œç‹¬ç«‹è¿ç»´ã€å³å¼€å³ç”¨ã€ä¸å½±å“åŸæœ‰ç¯å¢ƒç­‰ç­‰ã€‚</p><p>å¦‚æœæœ¬åœ°æœºå™¨æ€§èƒ½æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸”ä½¿ç”¨çš„äººæ•°ã€å‹åŠ›éƒ½æ²¡æœ‰å¤ªå¤§çš„è¯ï¼Œé‚£ä¹ˆä½¿ç”¨nextcloudç‹¬ç«‹å®¹å™¨çš„å®‰è£…å°±è¶³å¤Ÿäº†ã€‚</p><p>nextcloudç‹¬ç«‹å®¹å™¨ç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯apacheåšwebæœåŠ¡å™¨ï¼Œè‡ªå¸¦SQLiteä½œä¸ºæ•°æ®åº“ï¼Œä¹Ÿç®—æ˜¯å¤Ÿç”¨ã€‚</p><p>ä¸‹é¢ç»™ä¸€ä¸‹å•å®¹å™¨å®‰è£…nextcloudçš„è¿è¡Œå‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --restart=always \</span><br><span class="line">  --name nextcloud \</span><br><span class="line">  -p 7788:80 \</span><br><span class="line">  -v ~/nextcloud:/var/www/html \</span><br><span class="line">  docker.io/nextcloud</span><br></pre></td></tr></table></figure><p>ç¨å¾®è§£é‡Šä¸€ä¸‹è¿™å‡ ä¸ªå‚æ•°ï¼š</p><figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">run</span><span class="language-bash">                   <span class="comment"># è¿è¡Œé•œåƒåˆ›å»ºå®¹å™¨ç¤ºä¾‹ï¼Œåé¢è·Ÿç€åˆ›å»ºå®¹å™¨å‚æ•°</span></span></span><br><span class="line">-d                    <span class="comment"># åœ¨åå°è¿è¡Œ</span></span><br><span class="line">--restart=always      <span class="comment"># æ€»æ˜¯éšç€å®¿ä¸»æœºé‡å¯è€Œå¯åŠ¨</span></span><br><span class="line">--name nextcloud      <span class="comment"># å®¹å™¨çš„åå­—ï¼Œå¯ä»¥ä¸ç”¨è§£é‡Šå§ </span></span><br><span class="line">-p <span class="number">7788</span>:<span class="number">80</span>            <span class="comment"># å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„7788ç«¯å£</span></span><br><span class="line">-v ~/nextcloud:/var/www/html  <span class="comment"># å°†å®¹å™¨çš„/var/www/htmlæ˜ å°„åˆ°å®¿ä¸»æœºçš„~/nextcloud</span></span><br><span class="line">docker.io/nextcloud   <span class="comment"># åˆ›å»ºå®¹å™¨éœ€è¦ç”¨åˆ°çš„é•œåƒ</span></span><br></pre></td></tr></table></figure><p>ç­‰å¾…dockeræ‰§è¡Œåˆ›å»ºå®¹å™¨å®ä¾‹å®Œæˆåï¼Œåˆ™å¯ä»¥é€šè¿‡<u><code>http://ip:7788</code></u>æ¥è®¿é—®nextcloudäº†ã€‚ä½†æ˜¯è¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œæœ¬æ–‡çš„ç›®æ ‡æ˜¯ä¸€å°<strong>æ»¡è¡€çš„nextcloud</strong>ã€‚</p><hr><h2 id="æ‰€è°“æ»¡è¡€"><a href="#æ‰€è°“æ»¡è¡€" class="headerlink" title="æ‰€è°“æ»¡è¡€"></a>æ‰€è°“æ»¡è¡€</h2><p>è‡ªå·±æ­å»ºè¿‡nextcloudçš„äººå¯èƒ½éƒ½çŸ¥é“ï¼Œnextcloudä¸ä»…å¯ä»¥åœ¨é»˜è®¤é…ç½®ä¸‹ä½¿ç”¨ï¼Œè¿˜å¯ä»¥é€šè¿‡åŠ å…¥å„ç§å„æ ·çš„åº•å±‚ç»„ä»¶æ¥æé«˜å®ƒè¿è¡Œçš„æ€§èƒ½ã€‚</p><p>è€Œè¿™æ¬¡æ­å»ºçš„è¿™å°nextcloudåˆ™æ˜¯ä¸å•é•œåƒæ­å»ºä¸åŒï¼Œé‡‡ç”¨äº†ï¼š</p><ol><li>fpmâ€”â€”fastCgiä½œä¸ºå‘ˆç°å±‚â€”â€”ç‰ˆæœ¬çš„nextcloud</li><li>nginxä½œä¸ºå‰ç½®åå‘ä»£ç†æœåŠ¡å™¨æä¾›httpså®‰å…¨</li><li>mysql&#x2F;mariadbä½œä¸ºæ•°æ®åº“ï¼Œæé«˜æ•°æ®å¯é æ€§ä»¥åŠè¯»å†™æ€§èƒ½</li><li>redisä½œä¸ºçƒ­ç‚¹æ•°æ®ç¼“å­˜æœåŠ¡å™¨ä»¥åŠæ–‡ä»¶é”ç®¡ç†å™¨</li></ol><p>é€šè¿‡åŠ å…¥è¿™äº›ç»„ä»¶å¯ä»¥æé«˜åœ¨å¤šç”¨æˆ·å¤„ç†åœºæ™¯æ—¶ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚</p><h3 id="ä¾èµ–å…³ç³»"><a href="#ä¾èµ–å…³ç³»" class="headerlink" title="ä¾èµ–å…³ç³»"></a>ä¾èµ–å…³ç³»</h3><p>ç”±äºè¿™ä¸ªæ­å»ºæ€è·¯å¹¶ä¸æ˜¯nextcloudå®˜æ–¹æä¾›çš„è§£å†³æ–¹æ¡ˆï¼ˆæœ¬èº«ä¹Ÿä¸åº”è¯¥å®˜æ–¹å»è§£å†³è¿™ç§äº‹æƒ…ï¼‰ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±é…ç½®å¤šä¸ªå®¹å™¨å¹¶å°†å…¶è¿æ¥èµ·æ¥ï¼Œä½¿å…¶ä¹‹é—´å¯ä»¥äº’ç›¸è®¿é—®å’Œæ“ä½œï¼Œè¿ç”¨æ¯ä¸ªç»„ä»¶çš„ä¼˜åŠ¿æé«˜æ•´ä½“ç³»ç»Ÿçš„æ€§èƒ½ã€‚</p><p>æœ¬æ¬¡ä¸€å…±ä¼šä½¿ç”¨åˆ°ä»¥ä¸‹å‡ ä¸ªé•œåƒï¼š</p><ol><li>mariadbï¼ˆç›®å‰mysqléƒ½è¿‡æ¸¡åˆ°mariadbäº†ï¼‰</li><li>redis</li><li>nextcloud:fpm</li><li>nginx</li></ol><p>å»ºè®®æå‰æŒ‚ä»£ç†é€šè¿‡<code>docker pull</code>æ¥ä¸‹è½½ï¼Œä»¥å…æ­å»ºçš„æ—¶å€™è¿˜è¦å»æ‹‰å»é•œåƒè€Œå ç”¨è¿‡å¤šæ—¶é—´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®ä»£ç†</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚</span></span><br><span class="line"><span class="built_in">export</span> ALL_PROXY=socks5://127.0.0.1:1080 <span class="comment"># å‰ææ˜¯åœ¨1080ç«¯å£è¿è¡Œäº†ä½ è‡ªå·±é…ç½®çš„ä»£ç†æœåŠ¡ï¼Œä¸ç„¶çš„è¯å»ºè®®ä½¿ç”¨å›½å†…çš„é•œåƒæº</span></span><br><span class="line"><span class="comment"># ä¸‹è½½é•œåƒ</span></span><br><span class="line">docker pull mariadb redis nextcloud:fpm nginx</span><br></pre></td></tr></table></figure><p>æ›´æ¢é•œåƒæºå¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href="https://www.jianshu.com/p/405fe33b9032">Dockerä¸­å›½æº - ç®€ä¹¦</a>ã€‚</p><p>å…¶ä¸­éœ€è¦æ˜ç¡®ä¸€ä¸‹æ¯ä¸ªå®¹å™¨åœ¨è¿™ä¸€å¥—ç³»ç»Ÿä¸­æ‰®æ¼”çš„è§’è‰²ã€‚</p><blockquote><p>nextcloudä½œä¸ºæ­¤æ¬¡çš„ä¸»è§’ï¼Œä¹Ÿå°±æ˜¯ä¸»ä½“ä¸šåŠ¡ï¼ˆappï¼‰ï¼Œå®ƒåœ¨å­˜å–æ•°æ®çš„æ—¶å€™æ˜¯ä¼šç”¨åˆ°æ•°æ®åº“ï¼ˆdbï¼‰å’Œç¼“å­˜ï¼ˆcacheï¼‰ç³»ç»Ÿçš„ï¼Œé‚£ä¹ˆå¯ä»¥å¾—å‡ºnextcloudä¾èµ–äºmysqlå’Œredisã€‚</p></blockquote><blockquote><p>è€Œmysqlå’Œredisä¹‹é—´å„å¸å…¶èŒï¼Œå…¶ä¸­ä¸€ä¸ªæŒ‚äº†ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªï¼Œæ‰€ä»¥ä¼˜å…ˆçº§ç›¸åŒï¼Œä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ã€‚</p></blockquote><blockquote><p>nginxä½œä¸ºä»£ç†ä¸šåŠ¡å’Œç”¨æˆ·ä¹‹é—´æ²Ÿé€šçš„ä¸»ä½“ï¼Œé¦–å…ˆæ˜¯éœ€è¦ä¸šåŠ¡ï¼ˆappï¼‰æ­£å¸¸è¿è¡Œæ‰èƒ½å¤Ÿæ­£å¸¸æä¾›å®ƒè‡ªå·±æœ¬èº«çš„æœåŠ¡ï¼Œæ‰€ä»¥nginxä¾èµ–äºnextcloudã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ä¾èµ–å…³ç³»å¦‚ä¸‹</span><br><span class="line">                     /-&gt; mysql</span><br><span class="line">nginx -&gt; nextcloud -|</span><br><span class="line">                     \-&gt; redis</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨é¡ºåºåˆ™éœ€è¦åè¿‡æ¥</span><br><span class="line">redix&amp;mysql -&gt; nextcloud -&gt; nginx</span><br></pre></td></tr></table></figure><h3 id="docker-composeé…ç½®æ–‡ä»¶"><a href="#docker-composeé…ç½®æ–‡ä»¶" class="headerlink" title="docker-composeé…ç½®æ–‡ä»¶"></a>docker-composeé…ç½®æ–‡ä»¶</h3><p>docker-composeæ˜¯ä¸€ä¸ªä»£ç†ç”¨æˆ·å»ç®¡ç†dockerçš„ä¸€ä¸ªå·¥å…·ï¼Œä½¿ç”¨docker-compose.ymlé…ç½®æ–‡ä»¶å°±å¯ä»¥ç³»ç»Ÿã€æ–¹ä¾¿åœ°éƒ¨ç½²å¤šå®¹å™¨é¡¹ç›®ï¼Œå› ä¸ºæˆ‘ä»¬è¿™æ¬¡æ­å»ºçš„nextcloudä¹Ÿæ˜¯åŸºäºå¤šå®¹å™¨çš„ï¼Œæ‰€ä»¥ä½¿ç”¨docker-composeè¿›è¡Œéƒ¨ç½²å’Œè°ƒè¯•ä»¥åŠé‡å»ºæœ€ä¸ºæ–¹ä¾¿ã€‚</p><p>å®Œæ•´çš„docker-composeé…ç½®å‚æ•°æ–‡æ¡£å¯ä»¥å‚è€ƒä¸‹é¢çš„è¿™ä¸ªæ–‡æ¡£ï¼Œè®²çš„è¿˜æ˜¯æ¯”è¾ƒç»†è‡´ï¼Œæ¨èç»™è¦æ·±å…¥docker-composeçš„åŒå­¦å­¦ä¹ ã€‚</p><blockquote><p><a href="https://www.jianshu.com/p/2217cfed29d7">Docker Compose é…ç½®æ–‡ä»¶è¯¦è§£ - ç®€ä¹¦</a></p></blockquote><p>ä»¥ä¸‹å°±æ˜¯æœ¬æ–‡è¾“å‡ºçš„docker-composeé…ç½®æ–‡ä»¶ã€‚</p><blockquote><p><strong>æ³¨ï¼š</strong>å‚æ•°çš„è§£é‡Šä¼šé€šè¿‡å¤‡æ³¨çš„å½¢å¼å†™åœ¨é…ç½®ä¸­</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.4&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">db:</span> <span class="comment"># è¿™é‡Œåªæ˜¯ç»™æ¯ä¸ªå®¹å™¨å•ç‹¬é…ç½®ä¸€ä¸ªåç§°</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mariadb</span> <span class="comment"># å…·ä½“çš„é•œåƒåç§°ï¼Œå¯ä»¥ä½¿ç”¨â€œ:â€æŒ‡å®šé•œåƒçš„ç‰ˆæœ¬</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span> <span class="comment"># é‡å¯çš„é€‰é¡¹ï¼Œåˆ†ä¸ºnoã€on-failureã€on-failure:xã€alwaysã€unless-stoppedï¼Œå…·ä½“å¯ä»¥è‡ªè¡Œæœç´¢æŸ¥çœ‹åŒºåˆ«</span></span><br><span class="line">    <span class="attr">expose:</span> </span><br><span class="line">    <span class="comment"># exposeä»…å°†æŒ‡å®šçš„ç«¯å£æš´éœ²ç»™linksçš„å®¹å™¨ï¼Œè€Œä¸å¯¹å®¿ä¸»æœºå¼€æ”¾ã€‚</span></span><br><span class="line">    <span class="comment"># å’Œportsçš„åŒºåˆ«åœ¨äºï¼Œportså¯ä»¥æ˜ å°„å®¿ä¸»æœºåˆ«çš„ç«¯å£åˆ°å®¹å™¨ä¸­ã€‚</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;3306&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">    <span class="comment"># volumesæŒ‡çš„æ˜¯å°†å®¿ä¸»æœºçš„è·¯å¾„æ˜ å°„åˆ°å®¹å™¨ä¸­çš„æŒ‡å®šä½ç½®</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./db:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">    <span class="comment"># environmentå¯ä»¥å¯¹å®¹å™¨åˆ›å»ºæŒ‡å®šå¤šä¸ªç¯å¢ƒå˜é‡</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root_password</span> <span class="comment"># è¿™é‡Œé…ç½®rootå¯†ç </span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=nextcloud</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">MYSQL_USER=user_name</span> <span class="comment"># è¿™é‡Œé…ç½®ä¸€ä¸ªérootè´¦æˆ·ç»™nextcloudä½¿ç”¨</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=user_password</span> <span class="comment"># è¿™é‡Œé…ç½®ä¸Šé¢é‚£ä¸ªè´¦å·çš„å¯†ç </span></span><br><span class="line"></span><br><span class="line">  <span class="attr">cache:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;6379&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./cache:/data</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">--requirepass</span> <span class="string">&#x27;redis_password&#x27;</span> <span class="comment"># è¿™é‡Œçš„redis_passwordæ¢æˆä½ è¦é…ç½®çš„rediså¯†ç </span></span><br><span class="line">    <span class="comment"># commandæŒ‡çš„æ˜¯å¯åŠ¨å®¹å™¨åä»£æ›¿é»˜è®¤å¯åŠ¨æŒ‡ä»¤æ¥å¯åŠ¨æœåŠ¡çš„æŒ‡ä»¤</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">app:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nextcloud:fpm</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;9000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./app/html:/var/www/html</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./app/data:/var/www/html/data</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./app/config:/var/www/html/config</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./app/custom_apps:/var/www/html/custom_apps</span></span><br><span class="line">    <span class="attr">links:</span></span><br><span class="line">    <span class="comment"># linkså°†å®¹å™¨ä¸å½“å‰å®¹å™¨é“¾æ¥èµ·æ¥ï¼Œä»¥ä½¿å¾—å½“å‰å®¹å™¨å¯ä»¥è®¿é—®ç›®æ ‡å®¹å™¨exposeçš„ç«¯å£</span></span><br><span class="line">    <span class="comment"># æ ¼å¼ä¸º å®¹å™¨çš„åŸå:æ˜ å°„åˆ°å½“å‰å®¹å™¨ä¸­çš„åç§°</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">db:db</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">cache:cache</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">    <span class="comment"># ä¾èµ–çš„å®¹å™¨åˆ—è¡¨ï¼Œåªæœ‰è¿™äº›å®¹å™¨éƒ½æˆåŠŸå¯åŠ¨äº†ï¼Œæ‰ä¼šå¯åŠ¨å½“å‰å®¹å™¨</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">cache</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">proxy:</span> <span class="comment"># å«åšproxyæ˜¯å› ä¸ºæ˜¯ä½œä¸ºä»£ç†æ¥æä¾›æœåŠ¡</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">expose:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80&quot;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="comment"># portså¯å°†å®¹å™¨å†…çš„ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºä¸Š</span></span><br><span class="line">    <span class="comment"># è¿™é‡Œæ˜¯å°†å®¹å™¨çš„443ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„7788ç«¯å£</span></span><br><span class="line">     <span class="bullet">-</span> <span class="number">7788</span><span class="string">:443</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./app/html:/var/www/html</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./proxy/conf.d:/etc/nginx/conf.d:ro</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">./proxy/ssl_certs:/etc/nginx/ssl_certs:ro</span></span><br><span class="line">    <span class="attr">links:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">app:app</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">app</span></span><br></pre></td></tr></table></figure><p>æŠŠè¿™äº›å†…å®¹ä¿å­˜åˆ°<code>docker-compose.yml</code>æ–‡ä»¶ä¸­ï¼Œç„¶åå°†å…¶æ”¾ç½®åœ¨æŸä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä¾‹å¦‚<code>~/super_nextcloud/</code>ï¼Œæˆ‘ä»¬ä¹‹åå°±åœ¨è¿™ä¸ªè·¯å¾„ä¸‹åšåç»­çš„æ“ä½œã€‚</p><h3 id="Nginxé…ç½®æ–‡ä»¶"><a href="#Nginxé…ç½®æ–‡ä»¶" class="headerlink" title="Nginxé…ç½®æ–‡ä»¶"></a>Nginxé…ç½®æ–‡ä»¶</h3><p>æ¥ç€æˆ‘ä»¬è¦å‡†å¤‡ä¸€ä¸‹nginxçš„é…ç½®ã€‚éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªæ˜¯<code>./proxy/conf.d</code>ï¼Œä¸€ä¸ªæ˜¯<code>./proxy/ssl_certs</code>ã€‚<br>å…¶ä¸­<code>conf.d</code>æ”¾ç½®nginxçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥èµ·åå«åš<code>nextcloud.conf</code>ï¼Œ<code>ssl_certs</code>æ”¾ç½®åŸŸåå¯¹åº”çš„SSLè¯ä¹¦çš„pemå’Œkeyæ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ./proxy/conf.d ./proxy/ssl_certs</span><br></pre></td></tr></table></figure><p>å…·ä½“å¯ä»¥å‚è€ƒä»¥ä¸‹çš„é…ç½®æ¥å†™nextcloud.confï¼Œå…¶ä¸­åŸŸåå’ŒSSLè¯ä¹¦æ–‡ä»¶çš„åå­—éœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">upstream</span> php-handler &#123;</span><br><span class="line">    <span class="attribute">server</span> app:<span class="number">9000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">listen</span> [::]:<span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span> è¿™é‡Œå¡«å†™è‡ªå·±çš„åŸŸå;</span><br><span class="line">    <span class="comment"># enforce https</span></span><br><span class="line">    <span class="attribute">return</span> <span class="number">301</span> https://<span class="variable">$server_name</span>:443<span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl http2;</span><br><span class="line">    <span class="attribute">listen</span> [::]:<span class="number">443</span> ssl http2;</span><br><span class="line">    <span class="attribute">server_name</span> è¿™é‡Œå¡«å†™è‡ªå·±çš„åŸŸå;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Use Mozilla&#x27;s guidelines for SSL/TLS settings</span></span><br><span class="line">    <span class="comment"># https://mozilla.github.io/server-side-tls/ssl-config-generator/</span></span><br><span class="line">    <span class="comment"># <span class="doctag">NOTE:</span> some settings below might be redundant</span></span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/nginx/ssl_certs/è¿™é‡Œå¡«å†™SSLè¯ä¹¦çš„åå­—.pem;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/nginx/ssl_certs/è¿™é‡Œå¡«å†™SSLè¯ä¹¦çš„åå­—.key;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add headers to serve security related headers</span></span><br><span class="line">    <span class="comment"># Before enabling Strict-Transport-Security headers please read into this</span></span><br><span class="line">    <span class="comment"># topic first.</span></span><br><span class="line">    <span class="comment">#add_header Strict-Transport-Security &quot;max-age=15768000; includeSubDomains; preload;&quot;;</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># WARNING: Only add the preload option once you read about</span></span><br><span class="line">    <span class="comment"># the consequences in https://hstspreload.org/. This option</span></span><br><span class="line">    <span class="comment"># will add the domain to a hardcoded list that is shipped</span></span><br><span class="line">    <span class="comment"># in all major browsers and getting removed from this list</span></span><br><span class="line">    <span class="comment"># could take several months.</span></span><br><span class="line">    <span class="attribute">add_header</span> X-Content-Type-Options nosniff;</span><br><span class="line">    <span class="attribute">add_header</span> X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line">    <span class="attribute">add_header</span> X-Robots-Tag <span class="literal">none</span>;</span><br><span class="line">    <span class="attribute">add_header</span> X-Download-Options noopen;</span><br><span class="line">    <span class="attribute">add_header</span> X-Permitted-Cross-Domain-Policies <span class="literal">none</span>;</span><br><span class="line">    <span class="attribute">add_header</span> Referrer-Policy <span class="literal">no</span>-referrer;</span><br><span class="line">    <span class="attribute">add_header</span> Strict-Transport-Security  <span class="number">15552000</span>;</span><br><span class="line">    <span class="comment">#add_header X-Frame-Options SAMEORIGIN;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Remove X-Powered-By, which is an information leak</span></span><br><span class="line">    <span class="attribute">fastcgi_hide_header</span> X-Powered-By;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Path to the root of your installation</span></span><br><span class="line">    <span class="attribute">root</span> /var/www/html;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># The following 2 rules are only needed for the user_webfinger app.</span></span><br><span class="line">    <span class="comment"># Uncomment it if you&#x27;re planning to use this app.</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json last;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># The following rule is only needed for the Social app.</span></span><br><span class="line">    <span class="comment"># Uncomment it if you&#x27;re planning to use this app.</span></span><br><span class="line">    <span class="comment">#rewrite ^/.well-known/webfinger /public.php?service=webfinger last;</span></span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> = /.well-known/carddav &#123;</span><br><span class="line">      <span class="attribute">return</span> <span class="number">301</span> <span class="variable">$scheme</span>://<span class="variable">$host</span>:<span class="variable">$server_port</span>/remote.php/dav;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="section">location</span> = /.well-known/caldav &#123;</span><br><span class="line">      <span class="attribute">return</span> <span class="number">301</span> <span class="variable">$scheme</span>://<span class="variable">$host</span>:<span class="variable">$server_port</span>/remote.php/dav;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># set max upload size</span></span><br><span class="line">    <span class="attribute">client_max_body_size</span> <span class="number">512M</span>;</span><br><span class="line">    <span class="attribute">fastcgi_buffers</span> <span class="number">64</span> <span class="number">4K</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Enable gzip but do not remove ETag headers</span></span><br><span class="line">    <span class="attribute">gzip</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">gzip_vary</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">gzip_comp_level</span> <span class="number">4</span>;</span><br><span class="line">    <span class="attribute">gzip_min_length</span> <span class="number">256</span>;</span><br><span class="line">    <span class="attribute">gzip_proxied</span> expired <span class="literal">no</span>-cache <span class="literal">no</span>-store private no_last_modified no_etag auth;</span><br><span class="line">    <span class="attribute">gzip_types</span> application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Uncomment if your server is build with the ngx_pagespeed module</span></span><br><span class="line">    <span class="comment"># This module is currently not supported.</span></span><br><span class="line">    <span class="comment">#pagespeed off;</span></span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^</span> /index.php<span class="variable">$request_uri</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ ^\/(?:build|tests|config|lib|3rdparty|templates|data)\/</span> &#123;</span><br><span class="line">        <span class="attribute">deny</span> all;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ ^\/(?:\.|autotest|occ|issue|indie|db_|console)</span> &#123;</span><br><span class="line">        <span class="attribute">deny</span> all;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ ^\/(?:index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+)\.php(?:$|\/)</span> &#123;</span><br><span class="line">        <span class="attribute">fastcgi_split_path_info</span><span class="regexp"> ^(.+?\.php)(\/.*|)$</span>;</span><br><span class="line">        <span class="attribute">include</span> fastcgi_params;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> PATH_INFO <span class="variable">$fastcgi_path_info</span>;</span><br><span class="line">        <span class="attribute">fastcgi_param</span> HTTPS <span class="literal">on</span>;</span><br><span class="line">        <span class="comment"># Avoid sending the security headers twice</span></span><br><span class="line">        <span class="attribute">fastcgi_param</span> modHeadersAvailable <span class="literal">true</span>;</span><br><span class="line">        <span class="comment"># Enable pretty urls</span></span><br><span class="line">        <span class="attribute">fastcgi_param</span> front_controller_active <span class="literal">true</span>;</span><br><span class="line">        <span class="attribute">fastcgi_pass</span> php-handler;</span><br><span class="line">        <span class="attribute">fastcgi_intercept_errors</span> <span class="literal">on</span>;</span><br><span class="line">        <span class="attribute">fastcgi_request_buffering</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ ^\/(?:updater|oc[ms]-provider)(?:$|\/)</span> &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span>/ =<span class="number">404</span>;</span><br><span class="line">        <span class="attribute">index</span> index.php;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Adding the cache control header for js, css and map files</span></span><br><span class="line">    <span class="comment"># Make sure it is BELOW the PHP block</span></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ \.(?:css|js|woff2?|svg|gif|map)$</span> &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> /index.php<span class="variable">$request_uri</span>;</span><br><span class="line">        <span class="attribute">add_header</span> Cache-Control <span class="string">&quot;public, max-age=15778463&quot;</span>;</span><br><span class="line">        <span class="comment"># Add headers to serve security related headers (It is intended to</span></span><br><span class="line">        <span class="comment"># have those duplicated to the ones above)</span></span><br><span class="line">        <span class="comment"># Before enabling Strict-Transport-Security headers please read into</span></span><br><span class="line">        <span class="comment"># this topic first.</span></span><br><span class="line">        <span class="comment">#add_header Strict-Transport-Security &quot;max-age=15768000; includeSubDomains; preload;&quot;;</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># WARNING: Only add the preload option once you read about</span></span><br><span class="line">        <span class="comment"># the consequences in https://hstspreload.org/. This option</span></span><br><span class="line">        <span class="comment"># will add the domain to a hardcoded list that is shipped</span></span><br><span class="line">        <span class="comment"># in all major browsers and getting removed from this list</span></span><br><span class="line">        <span class="comment"># could take several months.</span></span><br><span class="line">        <span class="attribute">add_header</span> X-Content-Type-Options nosniff;</span><br><span class="line">        <span class="attribute">add_header</span> X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line">        <span class="attribute">add_header</span> X-Robots-Tag <span class="literal">none</span>;</span><br><span class="line">        <span class="attribute">add_header</span> X-Download-Options noopen;</span><br><span class="line">        <span class="attribute">add_header</span> X-Permitted-Cross-Domain-Policies <span class="literal">none</span>;</span><br><span class="line">        <span class="attribute">add_header</span> Referrer-Policy <span class="literal">no</span>-referrer;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Optional: Don&#x27;t log access to assets</span></span><br><span class="line">        <span class="attribute">access_log</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> <span class="regexp">~ \.(?:png|html|ttf|ico|jpg|jpeg|bcmap)$</span> &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> /index.php<span class="variable">$request_uri</span>;</span><br><span class="line">        <span class="comment"># Optional: Don&#x27;t log access to other assets</span></span><br><span class="line">        <span class="attribute">access_log</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p>æ–‡ä»¶éƒ½å‡†å¤‡å¥½ä¹‹åï¼Œæ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">super_nextcloud</span><br><span class="line">â”œâ”€â”€ docker-compose.yml</span><br><span class="line">â””â”€â”€ proxy</span><br><span class="line">    â”œâ”€â”€ conf.d</span><br><span class="line">    â”‚Â Â  â””â”€â”€ nextcloud.conf</span><br><span class="line">    â””â”€â”€ ssl_certs</span><br><span class="line">        â”œâ”€â”€ SSLè¯ä¹¦.key</span><br><span class="line">        â””â”€â”€ SSLè¯ä¹¦.pem</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»º-amp-å¯åŠ¨å®¹å™¨"><a href="#åˆ›å»º-amp-å¯åŠ¨å®¹å™¨" class="headerlink" title="åˆ›å»º&amp;å¯åŠ¨å®¹å™¨"></a>åˆ›å»º&amp;å¯åŠ¨å®¹å™¨</h3><p>æ­¤æ—¶å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆã€‚ä½¿ç”¨docker-composeä»£ç†å¯¹dockerçš„å®¹å™¨è¿›è¡Œæ“ä½œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d    <span class="comment"># åˆ›å»ºæ‰€æœ‰å®¹å™¨å¹¶æŒ‰é¡ºåºå¯åŠ¨</span></span><br><span class="line">docker-compose down     <span class="comment"># åœæ­¢æ‰€æœ‰å®¹å™¨å¹¶åˆ é™¤</span></span><br><span class="line">docker-compose stop     <span class="comment"># åœæ­¢æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">docker-compose start    <span class="comment"># æŒ‰é¡ºåºå¯åŠ¨æ‰€æœ‰å®¹å™¨</span></span><br><span class="line">docker-compose restart  <span class="comment"># åœæ­¢æ‰€æœ‰å®¹å™¨å¹¶æŒ‰é¡ºåºå¯åŠ¨æ‰€æœ‰å®¹å™¨</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>docker-compose up -d</code>å¯åŠ¨æˆ‘ä»¬çš„æœåŠ¡ã€‚åœ¨docker-composeè¾“å‡ºçš„æç¤ºä¸­ï¼Œæ‰€æœ‰ç›®æ ‡éƒ½æ˜¾ç¤ºä¸º<code>done</code>åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>netstat</code>æŸ¥çœ‹nginxå®¹å™¨æ˜¯å¦åœ¨ç›‘å¬7788ç«¯å£ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â¯ netstat -tnlp | grep 7788</span><br><span class="line">tcp6    0     0     :::7788     :::*    LISTEN    5155/docker-proxy</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œé‚£å°±æ˜¯åˆ›å»ºå®¹å™¨æœ‰é—®é¢˜ã€‚å¯ä»¥é€šè¿‡<code>docker ps -a</code>æŸ¥çœ‹å“ªäº›å®¹å™¨åœ¨ç–¯ç‹‚é‡å¯ï¼Œç„¶åé€šè¿‡<code>docker logs [å®¹å™¨åorå®¹å™¨ID]</code>è¿›åˆ°è¿™ä¸ªå®¹å™¨ä¸­æŸ¥çœ‹å®¹å™¨æœåŠ¡æ—¥å¿—ï¼Œè‡ªè¡Œæ’éšœã€‚</p><p>å¦‚æœæœ‰è¾“å‡ºï¼Œå¹¶ä¸”å’Œä¸Šé¢çš„å†…å®¹å¤§è‡´ç›¸åŒï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œæ„å»ºå·²ç»æˆåŠŸå¤§åŠäº†ã€‚</p><hr><h3 id="é…ç½®é¡¹ç›®"><a href="#é…ç½®é¡¹ç›®" class="headerlink" title="é…ç½®é¡¹ç›®"></a>é…ç½®é¡¹ç›®</h3><h4 id="é…ç½®ç«™ç‚¹"><a href="#é…ç½®ç«™ç‚¹" class="headerlink" title="é…ç½®ç«™ç‚¹"></a>é…ç½®ç«™ç‚¹</h4><p>ä»åœ°å€å’Œç«¯å£è¿›å…¥ç«™ç‚¹ï¼Œé€šå¸¸æ˜¯https+åŸŸå+ç«¯å£ï¼Œå¦‚æœæ˜¯å†…ç½‘æ­å»ºå¹¶ä¸”ä¸åœ¨æ„åŸŸåä»¥åŠhttpsçš„å°é”å¤´çš„è¯ï¼Œåˆ™å¯ä»¥ç›´æ¥é€šè¿‡ipæ¥è®¿é—®ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨nginxä¸­é…ç½®äº†ç‰¹å®šåŸŸååï¼Œå®ƒä¼šæ£€æŸ¥è®¿é—®æ—¶æ˜¯å¦æ˜¯æ­£ç¡®çš„åŸŸåï¼Œå¦‚æœä¸æ˜¯æ­£ç¡®çš„åŸŸåï¼Œé‚£ä¹ˆå°±ä¼šæ‹’ç»è®¿é—®ç½‘ç›˜èµ„æºã€‚</p><p>è¿›å…¥åï¼Œæˆ‘ä»¬å°±éœ€è¦è¿›è¡Œç½‘ç›˜é¦–æ¬¡é…ç½®çš„ä¸€äº›æ“ä½œï¼ŒåŒ…æ‹¬ç®¡ç†å‘˜çš„é…ç½®ã€æ•°æ®åº“çš„é…ç½®ã€åº”ç”¨ç¨‹åºçš„é…ç½®ç­‰ç­‰ã€‚<br>å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ•°æ®åº“é…ç½®éƒ¨åˆ†ï¼Œæ•°æ®åº“çš„åœ°å€éœ€è¦å¡«å†™æˆ‘ä»¬åœ¨dockerçš„linksä¸­æ˜ å°„marindbçš„ä¸»æœºåç§°ï¼Œå³<code>db</code>ï¼›è€Œè´¦å·å¯†ç åˆ™æ˜¯åœ¨é…ç½®æ•°æ®åº“æ—¶åˆ¶å®šçš„æ•°æ®åº“ç”¨æˆ·å¯†ç ä»¥åŠæ•°æ®åº“åç§°ã€‚</p><p>ä½¿ç”¨ä¸Šä¸€æ­¥é…ç½®å¥½çš„ç®¡ç†å‘˜è´¦å·å’Œå¯†ç ç™»å½•ç½‘ç›˜ï¼Œç‚¹å‡»å¤´åƒè¿›å…¥è®¾ç½®ï¼Œç°å°†ç«™ç‚¹çš„å‚æ•°é…ç½®å¥½åå†é…ç½®æœ¬è´¦å·çš„å‚æ•°ã€‚</p><h4 id="ä¿®æ”¹Nginxé…ç½®"><a href="#ä¿®æ”¹Nginxé…ç½®" class="headerlink" title="ä¿®æ”¹Nginxé…ç½®"></a>ä¿®æ”¹Nginxé…ç½®</h4><p>ç”±äºåœ¨ç½‘ç«™ä¸Šçº¿åï¼Œéœ€è¦é…ç½®ä¸€ç³»åˆ—å®‰å…¨å‚æ•°ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬å†æ¬¡å»ä¿®æ”¹ä¸€ä¸‹Nginxçš„é…ç½®æ–‡ä»¶ã€‚</p><p>åœ¨<code>proxy/conf.d/nextcloud.conf</code>ä¸­æ‰¾åˆ°è¿™è¡Œï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢é‚£ä¸ªnginxé…ç½®çš„41è¡Œï¼‰ï¼Œå°†å‰é¢çš„æ³¨é‡Šè§£å¼€ï¼Œç„¶åé‡å¯nginxå®¹å™¨å³å¯ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨<code>docker-compose restart</code>é‡å¯æ•´ä¸ªé¡¹ç›®ï¼‰ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#add_header X-Frame-Options SAMEORIGIN;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœéœ€è¦ä½¿ç”¨æ‰‹æœºAPPæ¥è®¿é—®çš„è¯ï¼Œè¿˜éœ€è¦å°†54 54 59è¡Œè§£å¼€æ³¨é‡Š</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#rewrite ^/.well-known/host-meta /public.php?service=host-meta last;</span></span><br><span class="line"><span class="comment">#rewrite ^/.well-known/host-meta.json /public.php?service=host-meta-json last;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#rewrite ^/.well-known/webfinger /public.php?service=webfinger last;</span></span><br></pre></td></tr></table></figure><h4 id="é…ç½®ç¼“å­˜"><a href="#é…ç½®ç¼“å­˜" class="headerlink" title="é…ç½®ç¼“å­˜"></a>é…ç½®ç¼“å­˜</h4><p>ç”±äºnextcloudé»˜è®¤ä½¿ç”¨çš„ç¼“å­˜æœºåˆ¶æ˜¯<code>APCu</code>ï¼Œæˆ‘ä»¬éœ€è¦åˆ°é…ç½®ä¸­ä¿®æ”¹å…¶ä½¿ç”¨Redisä½œä¸ºç¼“å­˜ã€‚</p><p>å°†<code>app/config/config.php</code>ä¸­çš„å†…å®¹æŒ‰ç…§å¦‚ä¸‹æ–¹æ³•æ”¹åŠ¨ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x27;memcache.local&#x27; =&gt; &#x27;\\OC\\Memcache\\APCu&#x27; // ç”¨æœ¬åœ°å¼ç¼“å­˜ä½¿ç”¨APCu // æ³¨é‡Šè¿™è¡Œ </span></span><br><span class="line"><span class="string">&#x27;memcache.local&#x27;</span> =&gt; <span class="string">&#x27;\\OC\\Memcache\\Redis&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;memcache.distributed&#x27;</span> =&gt; <span class="string">&#x27;\\OC\\Memcache\\Redis&#x27;</span>, <span class="comment">// åˆ†å¸ƒå¼ç¼“å­˜ä½¿ç”¨Redis</span></span><br><span class="line"><span class="string">&#x27;memcache.locking&#x27;</span> =&gt; <span class="string">&#x27;\\OC\\Memcache\\Redis&#x27;</span>, <span class="comment">// å¯ç”¨Redisç¼“å­˜çš„æ–‡ä»¶é”</span></span><br><span class="line"><span class="string">&#x27;redis&#x27;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">&#x27;host&#x27;</span> =&gt; <span class="string">&#x27;cache&#x27;</span>, <span class="comment">// è¿™é‡Œå’Œmariadbçš„é€»è¾‘ç›¸åŒï¼Œå¡«å†™å®¹å™¨linksæ—¶æ˜ å°„çš„ä¸»æœºå</span></span><br><span class="line">  <span class="string">&#x27;port&#x27;</span> =&gt; <span class="number">6379</span>,</span><br><span class="line">  <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;redis_password&#x27;</span> <span class="comment">// è¿™æ˜¯ä¹‹å‰åœ¨é…ç½®docker-composeæ—¶é…ç½®çš„rediså¯†ç </span></span><br><span class="line">),</span><br><span class="line"><span class="string">&#x27;filelocking.enabled&#x27;</span> =&gt; <span class="string">&#x27;true&#x27;</span>,</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›å…¥nextcloudçš„dockerå®¹å™¨ï¼Œå¹¶å°†æ–‡ä»¶å½’å±ç¡®è®¤æ”¹ä¸ºwww-dataï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it [nextcloudå®¹å™¨çš„å®¹å™¨ID] /bin/bash</span><br><span class="line"><span class="comment"># è¿›å…¥dockerå®¹å™¨ä¹‹å</span></span><br><span class="line"><span class="built_in">ls</span> -l /var/www/html/config/config.php</span><br><span class="line">-rw-r----- 1 www-data www-data 1646 Mar 30 07:27 /var/www/html/config/config.php</span><br><span class="line"><span class="comment"># å¦‚æœæç¤ºæ‰€æœ‰æƒä¸æ˜¯www-dataï¼Œé‚£ä¹ˆå°±è¦æ”¹å›www-data</span></span><br><span class="line"><span class="built_in">chown</span> www-data:www-data /var/www/html/config/config.php</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å†å»è®¿é—®nextcloudçš„é¡µé¢ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨redisåšç¼“å­˜äº†ã€‚</p><h4 id="é…ç½®cronå®šæ—¶ä»»åŠ¡"><a href="#é…ç½®cronå®šæ—¶ä»»åŠ¡" class="headerlink" title="é…ç½®cronå®šæ—¶ä»»åŠ¡"></a>é…ç½®cronå®šæ—¶ä»»åŠ¡</h4><p>ç”±äºnextcloudå†…éƒ¨çš„æ–‡ä»¶å’Œé…ç½®ä¼šåœ¨ç”¨æˆ·æ“ä½œè¿‡ç¨‹ä¸­äº§ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦å¯ç”¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å»å®šæœŸæ•´ç†å’Œå½’æ¡£è¿™äº›æ•°æ®åˆ°æ•°æ®åº“æˆ–è€…åº”ç”¨åˆ°é…ç½®ä¸­ã€‚</p><p>å…ˆç¡®å®šè‡ªå·±çš„nextcloudå®¹å™¨çš„å®¹å™¨IDæˆ–è€…å®¹å™¨åå­—ï¼Œå¯ä»¥ä½¿ç”¨<code>docker ps -a</code>æŸ¥çœ‹ã€‚</p><p>ç„¶åä½¿ç”¨<code>crontab -e</code>æˆ–<code>vim /etc/crontab</code>æ‰“å¼€crontabçš„é…ç½®è¿›è¡Œç¼–è¾‘ï¼ŒåŠ å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># run nextcloud cron task every 5 min</span><br><span class="line">*/5 * * * * docker exec -u 33 [å®¹å™¨IDæˆ–å®¹å™¨å] php -f /var/www/html/cron.php 2&gt;&amp;1 /dev/null</span><br></pre></td></tr></table></figure><p>å»ºè®®ä¸¤ä¸ªåœ°æ–¹éƒ½åŠ ä¸€æ¬¡ï¼Œé¿å…é…ç½®ä¸ç”Ÿæ•ˆã€‚</p><hr><p>è‡³æ­¤ï¼Œç«™ç‚¹çš„åŸºæœ¬å†…å®¹å·²ç»é…ç½®å®Œæ¯•ï¼Œå¯ä»¥æ»¡è¶³ä¸ªäººç”¨äºç½‘ç›˜ã€webdavç­‰ä½¿ç”¨åœºæ™¯äº†ã€‚</p><h3 id="æ‰‹åŠ¨å®‰è£…æ‹“å±•"><a href="#æ‰‹åŠ¨å®‰è£…æ‹“å±•" class="headerlink" title="æ‰‹åŠ¨å®‰è£…æ‹“å±•"></a>æ‰‹åŠ¨å®‰è£…æ‹“å±•</h3><p>nextcloudå¦ä¸€ä¸ªå¸å¼•äººçš„åœ°æ–¹å°±æ˜¯å¯ä»¥å®‰è£…å¾ˆå¤šæ‹“å±•ï¼Œä½†æ˜¯ç”±äºnextcloudæ˜¯ä»githubä¸Šå®‰è£…<strong>æ‹“å±•</strong>ï¼Œå›½å†…çš„ç½‘ç»œè¿æ¥githubåˆæœ‰è®¸è®¸å¤šå¤šçš„<strong>å›°éš¾</strong>ï¼Œæ‰€ä»¥ç›´æ¥åœ¨é¡µé¢ä¸Šç‚¹å‡»å®‰è£…æŒ‰é’®æ˜¯ç»å¯¹ä¼šæŠ¥cURLçš„é”™çš„ã€‚</p><p>æ‰€ä»¥æˆ‘æƒ³å‡ºäº†ä¸€ä¸ªæ›²çº¿æ•‘å›½çš„æ–¹æ³•ï¼Œè™½ç„¶æ¯”ç›´æ¥ç‚¹å‡»å®‰è£…è¦å¤šäº†å‡ æ­¥ï¼Œä½†ç€å®å¯è¡Œï¼Œå®æ–½èµ·æ¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé˜»ç¢ã€‚ï¼ˆåå€’æ˜¯ä¹‹å‰ä¸ºäº†å®ç°ç›´æ¥ç‚¹é¡µé¢å®‰è£…è€Œå„ç§é…ç½®ä»£ç†æµªè´¹äº†ä¸å°‘æ—¶é—´ï¼Œè€Œä¸”è¿˜æœ‰æä¸å‡ºæ¥â€¦ï¼‰</p><p>æ‰‹åŠ¨å®‰è£…æ‹“å±•ç¨‹åºçš„æ­¥éª¤å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç¡®ä¿å½“å‰å®¢æˆ·æœºç¯å¢ƒå¯é€šè¿‡ä»£ç†è®¿é—®githubï¼›</li><li>è¿›å…¥nextcloudçš„åº”ç”¨é¡µé¢ï¼Œæ‰¾åˆ°è‡ªå·±æƒ³è£…çš„æ‹“å±•åº”ç”¨ï¼›</li><li>ç‚¹å‡»æƒ³è¦å®‰è£…çš„åº”ç”¨å±•å¼€è¯¦æƒ…ï¼Œè¿›å…¥â€œè®¿é—®ç½‘ç«™â€é“¾æ¥ï¼Œæ­¤æ—¶ä¸€èˆ¬ä¼šå»åˆ°æ’ä»¶çš„<strong>githubé¡µé¢</strong>æˆ–è€…<strong>nextcloudå®˜æ–¹å‘å¸ƒæ’ä»¶é¡µé¢</strong>ï¼›</li><li>è¿›å…¥githubé¡¹ç›®çš„releaseé¡µé¢ï¼Œä¸‹è½½æœ€æ–°çš„æ’ä»¶æ›´æ–°ç‰ˆæœ¬åˆ°å½“å‰æœ¬æœºã€‚æŒ‰ç…§nextcloudçš„æ’ä»¶å‘å¸ƒæ ‡å‡†åº”è¯¥æ˜¯ä¸€ä¸ª<code>tar.gz</code>æ–‡ä»¶ï¼›</li><li>å°†ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶ä»nextcloudä¸ªäººæ–‡ä»¶é¡µé¢ä¸Šä¼ åˆ°ç½‘ç›˜ä¸­ï¼›</li><li>è¿›å…¥nextcloudå®¹å™¨ã€‚<code>docker exec -u 33 -it [container ID or container name] /bin/bash</code>ï¼Œå…¶ä¸­[container ID or container name]è¦æ¢æˆçœŸå®å®¹å™¨çš„IDæˆ–åå­—ï¼›</li><li>åˆ°è·¯å¾„ä¸‹æ‰¾åˆ°è‡ªå·±ä¸Šä¼ çš„æ‹“å±•æ’ä»¶ã€‚ä¾‹å¦‚<code>/var/www/html/data/[username]/files/nextcloud_extension/metadata.tar.gz</code>ï¼Œå…¶ä¸­[username]è¦æ¢æˆç”¨æˆ·çš„åå­—ã€‚è¿™é‡Œè£…çš„æ˜¯matadataæ’ä»¶ï¼Œç”¨äºæŸ¥çœ‹å›¾ç‰‡å„ç§å…ƒæ•°æ®çš„ï¼›</li><li>å°†å…¶å¤åˆ¶åˆ°<code>/var/www/html/apps</code>ã€‚<code>cp /var/www/html/data/[username]/files/nextcloud_extension/metadata.tar.gz /var/www/html/apps</code>ï¼›</li><li>è§£å‹ååˆ é™¤æºå‹ç¼©æ–‡ä»¶<code>cd /var/www/html/apps &amp;&amp; tar -xzf metadata.tar.gz &amp;&amp; rm metadata.tar.gz</code>ï¼›</li><li>è¿›å…¥nextcloudé¡µé¢çš„ã€åº”ç”¨ã€‘-ã€å·²ç¦ç”¨çš„åº”ç”¨ã€‘é¡µé¢ï¼Œå°†å…¶å¯ç”¨ã€‚</li></ol><p>æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤æ¥æ“ä½œå°±å¯ä»¥åšåˆ°å®ç°æ‰‹åŠ¨å®‰è£…æ’ä»¶çš„ç›®çš„äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç»å†äº†è¿™æ¬¡æ­å»ºç½‘ç›˜ï¼Œç®—æ˜¯åˆçº§å…¥é—¨äº†dockerå®¹å™¨çš„éƒ¨ç½²ï¼Œä»¥åŠdocker-composeçš„é…ç½®å…¥é—¨ã€‚</p><p>åªèƒ½è¯´ï¼Œåœ¨å¼€å§‹ä¸€ä¸ªé¡¹ç›®ä¹‹å‰ï¼Œè¿˜æœ‰è®¸å¤šä¸œè¥¿éœ€è¦å®ç°è€ƒè™‘å’Œå‡†å¤‡å¥½ï¼Œåšå¥½ç¼ºé™·é¢„é˜²ã€‚è¿™æ ·åœ¨çœŸæ­£ä¸Šæ‰‹åšçš„æ—¶å€™ï¼Œæ‰ä¼šå°½å¯èƒ½çš„å°‘å‡ºå·®é”™ï¼Œä»¥åŠå¤„å˜ä¸æƒŠã€‚</p><hr><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><blockquote><p>åŸç‰ˆåè®°ï¼šæœ¬æ¥ä»¥ä¸ºè¿™ä¸ªç½‘ç›˜æ­å¥½ä¹‹åå¯ä»¥å…»è€åœ°ç»™è‡ªå·±å’Œåä¼šä½¿ç”¨å‡ å¹´ï¼Œç»“æœæœ€è¿‘é˜¿é‡Œäº‘å‘äº†ç»­è´¹é€šçŸ¥ï¼Œä¸Šå»ä¸€çœ‹å‘ç°ä¹‹å‰çš„è½»é‡çº§åº”ç”¨æœåŠ¡å™¨å­¦ç”Ÿæœºå·²ç»ä¸åœ¨å­¦ç”Ÿä¼˜æƒ è®¡åˆ’ä¸­äº†ï¼ˆåªå‰©ä¸‹äº†ä¸€ä¸ªOSSï¼ŒåŸºæœ¬æ²¡å•¥ç”¨ï¼‰ï¼Œç»­è´¹ä¸€å¹´å¾—1kå¤šï¼Œæ‰€ä»¥åªèƒ½å¦å¯»ä»–å¤„æˆ–è€…é¡¹ç›®ææµ…äº†ï¼Œå“ã€‚ã€‚</p></blockquote><p>åæ¥çš„åæ¥ï¼Œåœ¨è¿ç§»åŸé¡¹ç›®åˆ°é˜¿é‡Œäº‘çš„æŒ‰é‡ä»˜è´¹ ECS åï¼Œè‡ªè´­äº†æ‰©å®¹äº‘ç£ç›˜ï¼Œå¹¶åšäº†<a href="/2021/08/26/record-a-disk-expansion-on-alicloud-ubuntu/">æ‰©å®¹çš„è®°å½•</a>ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ä¹Ÿå¯ä»¥çœ‹çœ‹ã€‚</p><h2 id="æ›´æ–°-2022-10-23"><a href="#æ›´æ–°-2022-10-23" class="headerlink" title="æ›´æ–° 2022.10.23"></a>æ›´æ–° 2022.10.23</h2><p>æ›´æ–°äº†ä½¿ç”¨ docker-compose ç»„ç»‡çš„ nextcloud ä¸ aria2 é…åˆå®ç°çš„ç¦»çº¿ä¸‹è½½æ–¹æ¡ˆã€‚<br>å‰å¾€é“¾æ¥ï¼š<a href="/2022/10/23/nextcloud-with-aria2-on-docker/">åŸºäºdockerçš„nextcloud+aria2ç¦»çº¿ä¸‹è½½è”åŠ¨è§£å†³æ–¹æ¡ˆ</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;éœ€è¦é…ç½®å¯ä»¥ç›´æ¥è·³åˆ°&lt;a href=&quot;/2021/04/08/nextcloud-on-docker/#docker-compose%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6&quot;&gt;docker-compose&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Geek&#39;s Work" scheme="https://hexo.chensmallx.top/categories/Geek-s-Work/"/>
    
    <category term="è®¡ç®—æœºåä¼š" scheme="https://hexo.chensmallx.top/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8D%8F%E4%BC%9A/"/>
    
    
    <category term="è®¡ç®—æœºåä¼š" scheme="https://hexo.chensmallx.top/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8D%8F%E4%BC%9A/"/>
    
    <category term="linux" scheme="https://hexo.chensmallx.top/tags/linux/"/>
    
    <category term="docker" scheme="https://hexo.chensmallx.top/tags/docker/"/>
    
    <category term="docker-compose" scheme="https://hexo.chensmallx.top/tags/docker-compose/"/>
    
    <category term="nextcloud&#39;" scheme="https://hexo.chensmallx.top/tags/nextcloud/"/>
    
    <category term="mysql" scheme="https://hexo.chensmallx.top/tags/mysql/"/>
    
    <category term="nginx" scheme="https://hexo.chensmallx.top/tags/nginx/"/>
    
    <category term="redis" scheme="https://hexo.chensmallx.top/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>K2Pä»£ç†MANç«¯è®¾å¤‡ä¸Šç½‘</title>
    <link href="https://hexo.chensmallx.top/2021/04/06/route-by-modem/"/>
    <id>https://hexo.chensmallx.top/2021/04/06/route-by-modem/</id>
    <published>2021-04-06T03:48:02.000Z</published>
    <updated>2022-11-22T01:28:07.065Z</updated>
    
    <content type="html"><![CDATA[<p>è¿‘æ—¥å…¥å‘äº†ptç«™ç‚¹ï¼Œå¹¶åœ¨NASä¸Šæ–°å¢äº†ä¸€ä¸ª12Tçš„å¸Œæ·é“¶æ²³æ°¦æ°”ç›˜ï¼Œåœ¨é—²æš‡ä¹‹ä½™ä¸‹è½½ä¸€äº›å¤§åŒ…åˆ·åˆ·ä¸Šä¼ é‡ä¹‹å¤–ï¼Œæ€»æ˜¯é€®ç€å–œæ¬¢çš„èµ„æºå°±è‚†æ— å¿Œæƒ®çš„ä¸‹è½½ï¼ˆä¸Šä¼ é‡èƒ½åˆ·å¾—å¾ˆå¿«å“ˆå“ˆå“ˆï¼‰ï¼Œä¸å¾—ä¸è¯´ï¼Œptç«™çš„èµ„æºç¡®å®æ˜¯ä¼˜è´¨ï¼Œå’Œæ™®ç½—å¤§ä¼—å…±ç”¨çš„btç¡®å®ä¸åŒï¼Œç§å­èµ„æºã€åšç§é‡æ ¹æœ¬éƒ½æ˜¯ä¸èƒ½æ¯”æ‹Ÿçš„ã€‚</p><p>ç„¶è€Œéšä¹‹è€Œæ¥çš„é—®é¢˜å°±æ˜¯ï¼Œä¼˜è´¨çš„èµ„æºå®ƒæ€»å¾—è¦æ’­æ”¾æ‰èƒ½çœ‹æ‰èƒ½å¬å§ï¼Ÿè€Œæ’­æ”¾è¿‡ç¨‹ä¸­æŸä¸ªç¯èŠ‚å‡ºäº†é—®é¢˜ï¼Œåˆ™ä¼šå½±å“æ•´ä½“çš„è§‚æ„Ÿä½“éªŒï¼Œæ²¡é”™ï¼Œæˆ‘å°±é‡åˆ°äº†ã€‚</p><h2 id="åŸæœ‰ç½‘ç»œæ‹“æ‰‘"><a href="#åŸæœ‰ç½‘ç»œæ‹“æ‰‘" class="headerlink" title="åŸæœ‰ç½‘ç»œæ‹“æ‰‘"></a>åŸæœ‰ç½‘ç»œæ‹“æ‰‘</h2><p>ä¸‹è½½çš„èµ„æºå¤§å¤šéƒ½æ˜¯1080Pã€2Kã€4Kçš„è§†é¢‘æ ¼å¼æ–‡ä»¶ï¼Œè€Œåä¸¤è€…å¤§å¤šè¿˜æ˜¯è“å…‰åŸç›˜çš„iosæˆ–è€…æ˜¯BDMVåŒ…ï¼Œ1080Pçš„è§†é¢‘ä¸€ä¸¤ä¸ªå°æ—¶å¯ä»¥ä»2Gåˆ°10å¤šGä¸ç­‰ï¼Œè€Œåˆ°äº†2Kã€4Kçº§åˆ«çš„èµ„æºï¼Œå°‘è¯´ä¹Ÿæ˜¯ä¸€ä¸ªå¤šå°æ—¶å¾—æœ‰ä¸ª20Gåˆ°80Gä¸ç­‰ï¼Œè¿™æ ·å°±å¯¹NASè¿™ç§ç½‘ç»œå­˜å‚¨è®¾å¤‡ä½¿ç”¨åœºæ™¯äº§ç”Ÿä¸€å®šçš„è€ƒéªŒï¼Œæˆ–è€…è¯´æ˜¯æ•´æ¡ç½‘ç»œé“¾è·¯è´¨é‡çš„è€ƒéªŒã€‚</p><p>ç°åœ¨æ‰‹ä¸Šçš„æ¶‰åŠåˆ°è¿™ä¸€å¥—åŸºäºç½‘ç»œçš„æ’­æ”¾ã€ç½‘ç»œè®¾å¤‡å°±è¿™ä¹ˆå‡ ä¸ªï¼Œç”µä¿¡ç»™çš„æ™®é€šå…‰çŒ«ï¼ŒK2Pï¼Œèœ—ç‰›æ˜Ÿé™…Aæ¬¾ï¼Œå°ç±³ç”µè§†E55Aã€‚</p><p>ä¸ºå•¥è¦è¯´æ˜¯æ™®é€šå…‰çŒ«å‘¢ï¼Ÿå› ä¸ºå®ƒå°±æ˜¯æœ€å…¸å‹çš„å•åƒå…†+ä¸‰ç™¾å…†é…ç½®ï¼Œå…¶ä¸­åƒå…†æ¡¥æ¥å‡ºæ¥ç»™K2Pæ‹¨å·ä¸Šç½‘ä»£ç†å®¶åº­ç½‘ç»œä¸Šç½‘ï¼Œå…¶ä»–æ¥å£æš‚æ—¶æ²¡æœ‰ä½¿ç”¨ã€‚</p><p>K2Pè¿™ä¹ˆä¸€æ¬¾ç»å…¸çš„å…¨åƒå…†è‰¯å¿ƒè·¯ç”±å™¨å°±æ²¡æœ‰ä»€ä¹ˆå¥½å¤šè¯´çš„äº†ï¼Œåˆ·äº†padavanï¼ˆè€æ¯›å­ï¼‰ï¼Œæ›´æ–°äº†hiboyçš„v5é©±åŠ¨ç‰ˆæœ¬ã€‚è€Œä½œä¸ºç»å…¸çŸ¿æ¸£çš„èœ—ç‰›ï¼Œæˆ‘çš„è¿™ä¸ªèœ—ç‰›æ˜Ÿé™…Aæ¬¾æ˜¯ç¬¬ä¸€æ‰¹ä¸Šçš„è½¦ï¼Œé‡Œå¤´è¿˜æ˜¯åŸè£…ç»¿è‰²ä¸»æ¿ï¼ŒJ1900ï¼Œ16Gå†…å­˜ï¼Œå•åƒå…†ç½‘å£ï¼Œåˆ·äº†é»‘ç¾¤æ™–6.1.7ï¼ˆDS3617xsï¼‰ã€‚</p><p>å°ç±³ç”µè§†å’ŒK2Pä¹‹é—´ä½¿ç”¨5G wifiè¿æ¥ï¼Œä½¿ç”¨å°ç±³è‡ªå¸¦çš„æµ‹é€ŸåŠŸèƒ½ï¼Œæµ‹è¯•ä¸å…¬ç½‘ä¹‹é—´çš„é€Ÿåº¦å¯ä»¥è¾¾åˆ°20MB&#x2F;Sï¼Œç®—æ˜¯è¿˜è¡Œçš„ç¨‹åº¦ï¼Œä½†æ˜¯å°šæœªçŸ¥ç”µè§†å’ŒNASä¹‹é—´çš„é€Ÿåº¦ï¼Œå¹¶ä¸”å…¬ç½‘ä¸å†…ç½‘ä¹‹é—´çš„å·®åˆ«è¿˜æœ‰å»¶è¿Ÿç­‰å„ç§é—®é¢˜ï¼Œä»¥åŠå»¶è¿Ÿå¯¹å°é‡æ•°æ®çš„éšæœºè¯»å–çš„å½±å“ç­‰ç­‰ã€‚</p><p>æ€»è§ˆä¸€ä¸‹ï¼ŒåŸæ¥çš„ç½‘ç»œæ‹“æ‰‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/../img/NAS/route-by-modem-origin-topo.png" alt="åŸæœ‰ç½‘ç»œæ‹“æ‰‘"></p><h2 id="ç°è±¡"><a href="#ç°è±¡" class="headerlink" title="ç°è±¡"></a>ç°è±¡</h2><p>åŸºäºä»¥ä¸Šè¿™ä¸€å¥—ç½‘ç»œæ‹“æ‰‘ï¼Œåœ¨é€šè¿‡å°ç±³ç”µè§†è§‚çœ‹1080Pè§†é¢‘æ–‡ä»¶çš„æ—¶å€™å°±è¿˜å¥½ï¼Œè€Œå¦‚æœæ˜¯è§‚çœ‹2Kä»¥ä¸Šæ¸…æ™°åº¦è§†é¢‘çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°æ’­æ”¾ä¸€ä¼šï¼Œå°±è¦è½¬åœˆåœˆè¯»å–ä¸€ä¼šçš„æƒ…å†µï¼Œé¢‘ç‡å¤§æ¦‚æ˜¯<strong>10s</strong>ä¸€æ¬¡ï¼Œéå¸¸å½±å“è§‚å½±ä½“éªŒã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼Œå°±ç®—ä¸æ˜¯å¼ºè¿«ç—‡ï¼Œä¹Ÿä¼šæƒ³è¦å»æ”¹å–„ä¸€ç•ªã€‚</p><p>åœ¨å°è¯•è¿‡å°†è“å…‰åŸç›˜æ‹·è´åˆ°Uç›˜ä¸­æ’å…¥ç”µè§†è¿›è¡Œæœ¬åœ°æ’­æ”¾ï¼Œå¹¶ä¸”éå¸¸é¡ºç•…ä¹‹åï¼ŒåŸºæœ¬ä¸Šå°±ç¡®è®¤é—®é¢˜å‡ºç°åœ¨è§†é¢‘æ–‡ä»¶æ•°æ®ä¼ è¾“åˆ°ç”µè§†ä¸Šè¿™ä¸ªç¯èŠ‚äº†ã€‚</p><p>è€Œå½±å“è§†é¢‘æ–‡ä»¶ä»NASé€šè¿‡wifiä¼ è¾“åˆ°ç”µè§†ä¸Šé€Ÿåº¦çš„å› ç´ ä¹Ÿæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ç¡¬ç›˜è¯»é€Ÿåº¦ã€NASåˆ°è·¯ç”±å™¨çš„ä¼ è¾“é€Ÿç‡ã€è·¯ç”±å™¨åˆ°ç”µè§†ä¹‹é—´çš„wifiä¼ è¾“é€Ÿç‡ã€è·¯ç”±å™¨å„ç½‘å£ä¹‹é—´çš„äº¤æ¢é€Ÿç‡ï¼Œéƒ½æœ‰å¯èƒ½å½±å“ï¼Œæ‰€ä»¥æˆ‘åˆå¼€å§‹äº†æ¼«æ¼«çš„æ’é”™ä¹‹è·¯ã€‚</p><h2 id="æ’é”™"><a href="#æ’é”™" class="headerlink" title="æ’é”™"></a>æ’é”™</h2><p>åœ¨æ’é”™çš„ç­–ç•¥ä¸Šï¼Œæˆ‘é‡‡å–çš„æ˜¯ç”±æ˜“åˆ°éš¾çš„é¡ºåºè¿›è¡Œçš„ã€‚æ¯ä¸ªç¯èŠ‚æŒ‰ç…§æ’é”™éš¾æ˜“åº¦æ¥æ’åºï¼Œä»¥æˆ‘ä¸ªäººçš„ç†è§£ï¼Œå¯ä»¥æ’æˆä¸‹é¢è¿™æ ·ï¼š</p><ol><li>è·¯ç”±å™¨åˆ°NASï¼ˆæˆ–è€…å…¶ä»–æœ‰çº¿è¿æ¥çš„ç»ˆç«¯ï¼‰</li><li>è·¯ç”±å™¨ç½‘å£ä¹‹é—´çš„äº¤æ¢æ€§èƒ½</li><li>NASä¸­çš„ç¡¬ç›˜è¯»å–é€Ÿåº¦</li><li>è·¯ç”±å™¨é€šè¿‡wifiåˆ°ç”µè§†ï¼ˆè¿™åŸºæœ¬æ²¡æ³•æµ‹ï¼Œå› ä¸ºç”µè§†çš„æ“ä½œç³»ç»Ÿæ²¡æ³•è¿›å…¥åå°ï¼Œåªèƒ½ç›´æ¥æ”¾ç”µå½±æ¥è§‚å¯Ÿç°è±¡ï¼‰</li></ol><h3 id="è·¯ç”±å™¨åˆ°NAS"><a href="#è·¯ç”±å™¨åˆ°NAS" class="headerlink" title="è·¯ç”±å™¨åˆ°NAS"></a>è·¯ç”±å™¨åˆ°NAS</h3><p>æµ‹è¯•é“¾è·¯å¸¦å®½è´¨é‡ï¼Œæœ€æ–¹ä¾¿ä¹Ÿæœ€æ™®é€‚çš„æ–¹æ³•åº”è¯¥å°±æ˜¯iperfäº†å§ã€‚</p><p>Padavanè™½è¯´æ˜¯åç¡•è‡ªå®¶çš„ç³»ç»Ÿï¼Œä½†æ˜¯ä¹Ÿå†…ç½®äº†opkgï¼Œopkgæ˜¯ä¸€ä¸ªå¼€æºçš„åŒ…ç®¡ç†ç³»ç»Ÿï¼Œæ˜¯<code>Open PacKaGe management</code>çš„ç¼©å†™ã€‚ç›´æ¥è¿›å…¥K2Pçš„åå°ä½¿ç”¨opkgå®‰è£…iperf3å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">opkg update</span><br><span class="line">opkg install iperf3</span><br><span class="line"><span class="comment"># è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®‰è£…çš„è·¯å¾„æ˜¯åœ¨tmpfsä¸­çš„ï¼Œä¹Ÿå°±æ˜¯å†…å­˜ç›˜</span></span><br><span class="line"><span class="comment"># æ‰€ä»¥é‡å¯ä¼šä¸¢å¤±å®‰è£…çš„å†…å®¹ï¼Œä»¥é¿å…é—ªå­˜è¢«å æ»¡</span></span><br></pre></td></tr></table></figure><p>è€Œåœ¨ç¾¤æ™–ä¸Šä½¿ç”¨iperf3å°±æ›´åŠ ç®€å•äº†ã€‚åªéœ€è¦ä»dockerå¥—ä»¶ä¸­ï¼Œå®‰è£…iperf3çš„é•œåƒï¼Œç„¶ååœ¨é…ç½®å®¹å™¨çš„æ—¶å€™æŒ‰ç…§iperf3çš„è¯­æ³•è§„åˆ™é…ç½®å¯åŠ¨å‘½ä»¤å³å¯ã€‚é™„ä¸Šä¸€ä¸ªå¼ å¤§å¦ˆçš„å‚è€ƒæ–‡ç« ï¼š</p><blockquote><p><a href="https://post.smzdm.com/p/ag89wxk7/">å¦‚ä½•å¿«é€Ÿæµ‹è¯•ç½‘å¡æ€§èƒ½â€”â€”ç¾¤æ™–Docker å®‰è£…ä½¿ç”¨Iperf3æ•™ç¨‹ - ä»€ä¹ˆå€¼å¾—ä¹°</a></p></blockquote><p>è¿è¡Œiperf3ã€‚iperf3å’Œiperfç›¸åŒï¼Œæœ‰æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼Œåœ¨æµ‹è¯•çš„æ—¶å€™éœ€è¦è‡ªå·±ç¡®å®šå“ªä¸ªè®¾å¤‡æ˜¯æœåŠ¡ç«¯ï¼Œå“ªä¸ªè®¾å¤‡æ˜¯å®¢æˆ·ç«¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯å¯åŠ¨</span></span><br><span class="line">iperf3 -s</span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯å¯åŠ¨</span></span><br><span class="line">iperf3 -c [æœåŠ¡ç«¯IP]</span><br><span class="line"><span class="comment"># å…¶ä»–æ›´å¤šé€‰é¡¹ï¼Œå…¸å‹çš„ä¹Ÿå°±ä¸‹é¢è¿™äº›</span></span><br><span class="line">iperf3 -c [æœåŠ¡ç«¯IP] -l 1024M -t 60 -i 5 -P 4 -u</span><br><span class="line"><span class="comment"># -l length   ä»£è¡¨æ¯ä¸ªbufferçš„é•¿åº¦ï¼Œå¯ä»¥è·ŸkKmMå•ä½</span></span><br><span class="line"><span class="comment"># -t time     æ˜¯æµ‹è¯•çš„æ€»å…±æ—¶é•¿ï¼Œå•ä½æ˜¯ç§’</span></span><br><span class="line"><span class="comment"># -i interval æ˜¯æ¯æ¬¡æµ‹è¯•å‘èµ·çš„æ—¶é—´é—´éš”</span></span><br><span class="line"><span class="comment"># -P parallel å¹¶è¡Œæ•°ï¼Œä¸€èˆ¬å†™1æˆ–è€…CPUæ ¸å¿ƒæ•°</span></span><br><span class="line"><span class="comment"># -u udp      ä½¿ç”¨UDPè¿›è¡Œæµ‹è¯•ï¼Œä¸€èˆ¬æŒ‡å®šUDPä¹‹åå®¢æˆ·ç«¯çš„å¸¦å®½æµ‹è¯•ç»“æœä¼šå¤§å¾ˆå¤šï¼Œä¸¤åˆ°ä¸‰å€ä¸ç­‰ã€‚</span></span><br><span class="line">iperf3 --<span class="built_in">help</span> <span class="comment"># æŸ¥è¯¢å…¶ä»–å‘½ä»¤ä½¿ç”¨æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¹‹åï¼Œåªèƒ½è¯´ï¼Œå¾ˆé—æ†¾ï¼Œé—®é¢˜ä¹Ÿä¸æ˜¯å‡ºåœ¨è·¯ç”±å™¨åˆ°NASä¹‹é—´çš„é“¾è·¯ä¸Šã€‚</p><h3 id="è·¯ç”±å™¨ç½‘å£ä¹‹é—´çš„äº¤æ¢æ€§èƒ½"><a href="#è·¯ç”±å™¨ç½‘å£ä¹‹é—´çš„äº¤æ¢æ€§èƒ½" class="headerlink" title="è·¯ç”±å™¨ç½‘å£ä¹‹é—´çš„äº¤æ¢æ€§èƒ½"></a>è·¯ç”±å™¨ç½‘å£ä¹‹é—´çš„äº¤æ¢æ€§èƒ½</h3><p>ç”±äºæ¯ä¸ªå‚å•†çš„è·¯ç”±å™¨è®¾è®¡ä¸åŒï¼Œæ¯ä¸ªç½‘å£çš„å·¥ä½œè¡Œä¸ºè™½ç„¶åœ¨ç”¨æˆ·ä¾§çœ‹æ¥æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯åœ¨å†…éƒ¨å®ç°ä¸Šå´æ˜¯ä¸åŒçš„ã€‚</p><p>ä¾‹å¦‚å¤§éƒ¨åˆ†å®¶ç”¨è·¯ç”±å™¨åªéœ€è¦æ”¯æŒå•WANå£ï¼Œ+Nä¸ªLANå£çš„å·¥ä½œæ¨¡å¼ï¼Œè¿™æ—¶å€™è·¯ç”±å™¨å‚å•†åœ¨è®¾è®¡æ—¶ï¼Œæ˜¯åœ¨CPUåæ–¹æ¥ä¸€ä¸ªå¸¦ç½‘ç®¡çš„äº¤æ¢æœºï¼Œé€šè¿‡ä¸åŒçš„vLANæ¥åŒºåˆ†WANã€LANã€DMZç­‰ã€‚åœ¨è¿™ç§è®¾è®¡æ¨¡å¼ä¸‹ï¼ŒåŒå±äºLANåŒºåŸŸæˆ–è€…DMZåŒºåŸŸçš„æµé‡ä¼šç›´æ¥ç»è¿‡äº¤æ¢æœºé‡Œå¤´çš„äº¤æ¢èŠ¯ç‰‡ï¼Œè€Œä¸é€šè¿‡CPUï¼Œè¿™æ ·äº¤æ¢æ•ˆç‡å°±ä¼šæ¯”è¾ƒé«˜ã€‚</p><p>è€Œå¦ä¸€äº›å·¥ä¸šçº§ã€ä¼ä¸šçº§çš„è·¯ç”±å™¨ä¸Šï¼Œç”±äºéœ€è¦æ»¡è¶³è‡ªå®šä¹‰ç½‘å£é…ç½®ï¼ˆä¾‹å¦‚å¤šWANå£ã€è‡ªå®šä¹‰WANå£ã€è‡ªå®šä¹‰vLANç­‰ï¼‰ï¼Œè¿™æ—¶å€™åˆ™å¯èƒ½å°†è·¯ç”±å™¨å†…éƒ¨å®ç°ä¸ºæ¯ä¸ªç½‘å£éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç½‘å¡ï¼Œæ¯ä¸ªç½‘å¡éƒ½ç›´æ¥æ¥é€šCPUï¼Œåœ¨é…ç½®LANåŒºæ˜¯æŸå‡ ä¸ªç½‘å£æ—¶ï¼ŒCPUä¼šåœ¨ç³»ç»Ÿå†…å»ºç«‹ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼ˆä¾‹å¦‚eth0ï¼‰å»æ¡¥æ¥æ¯ä¸ªéœ€è¦ç»‘å®šåœ¨LANåŒºçš„ç½‘å£ï¼ˆä¾‹å¦‚ge0ã€ge3ã€ge4ï¼‰ï¼Œå°†å…¶ä¸Šçš„æµé‡åœ¨CPUä¸Šæ¨¡æ‹Ÿå‡ºæ¥çš„äº¤æ¢æœºï¼ˆè™šæ‹Ÿç½‘å¡ï¼‰ä¸Šè¿›è¡Œäº¤æ¢ã€‚åœ¨è¿™ç§è®¾è®¡æ¨¡å¼ä¸‹ï¼Œç”±äºæ²¡æœ‰ç¡¬ä»¶äº¤æ¢æœºèŠ¯ç‰‡ï¼Œäº¤æ¢æœºåŠŸèƒ½æ˜¯é€šè¿‡CPUæ¨¡æ‹Ÿå‡ºæ¥çš„ï¼Œè¿™æ—¶å€™åŒåŒºåŸŸçš„ç½‘ç»œæµé‡çš„äº¤æ¢åœ¨ç»è¿‡CPUçš„æ—¶å€™å°±ä¼šäº§ç”Ÿæ€§èƒ½çš„æŸå¤±ã€‚</p><p>åŸºäºè¿™ç§æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦çœ‹çœ‹æ˜¯å¦æ˜¯è¿™ä¸€ç¯èŠ‚å‡ºäº†é—®é¢˜ã€‚ä¸ºäº†æ’æŸ¥è¿™ä¸ªå½±å“å› ç´ ï¼Œæˆ‘è¿˜å»ä¸“é—¨ä¹°äº†ä¸€ä¸ªUSB3.0è½¬2.5G RJ45å£çš„ç½‘å¡ã€æ‚è„¸ã€‘ã€‚</p><p>ç»“æœä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œä¸€æµ‹ï¼Œè·¯ç”±å™¨åˆ°ç”µè„‘æœ‰çº¿è¿æ¥è·‘iperf3å¯ä»¥è·‘æ»¡åƒå…†ï¼ŒNASåˆ°ç”µè„‘ä¸­é—´ç»è¿‡è·¯ç”±å™¨æœ‰çº¿è¿æ¥è·‘iperf3è¿˜æ˜¯å¯ä»¥è·‘æ»¡åƒå…†ã€‚</p><p>å“¦è±ï¼Œè¿™ä¸€æ³¢ï¼Œç™½äºä¸€ä¸ªUSBç½‘å¡ã€‚</p><h3 id="NASä¸­çš„ç¡¬ç›˜è¯»å–é€Ÿåº¦"><a href="#NASä¸­çš„ç¡¬ç›˜è¯»å–é€Ÿåº¦" class="headerlink" title="NASä¸­çš„ç¡¬ç›˜è¯»å–é€Ÿåº¦"></a>NASä¸­çš„ç¡¬ç›˜è¯»å–é€Ÿåº¦</h3><p>ç”±äºå…·å¤‡äº†ä¸Šé¢çš„æ¡ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡ç”µè„‘æ‹·è´NASä¸Šçš„æ–‡ä»¶åˆ°æœ¬åœ°æ¥æµ‹è¯•NASä¸Šç¡¬ç›˜çš„è¯»å–é€Ÿåº¦äº†ã€‚</p><p>æ‹·è´ä¸€ä¸ª3Gçš„æ–‡ä»¶åˆ°æœ¬åœ°ï¼Œé€Ÿåº¦å¯ä»¥ç»´æŒåœ¨100åˆ°130MB&#x2F;Sä¹‹é—´ï¼Œè¿™æ ·çš„é€Ÿåº¦æµ‹è¯•ï¼Œåæ­£çœ‹ä¸‹æ¥ä¹Ÿæ˜¯æ²¡å•¥é—®é¢˜ï¼Œåƒå…†æé™å¦¥å¦¥çš„ã€‚</p><blockquote><p>ä¸€ä¸ªé¢˜å¤–è¯ï¼Œä½¿ç”¨windowsç”µè„‘å°±å¯ä»¥è·‘æ»¡é€Ÿåº¦ï¼Œè€Œä½¿ç”¨macå°±è·‘ä¸æ»¡ï¼Œä¼°è®¡è¿™macç³»ç»Ÿä¹Ÿæœ‰é—®é¢˜ï¼Œmmpâ€¦</p></blockquote><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>åˆ°äº†è¿™é‡Œï¼Œå¤§æ¦‚å¯ä»¥ç¡®å®šé—®é¢˜å°±å‡ºç°åœ¨æ•°æ®åˆ°è¾¾ç”µè§†çš„â€œæœ€åä¸€å…¬é‡Œâ€â€”â€”æ¥å…¥ç½‘ç»œçš„ä»‹è´¨â€”â€”ä¸Šäº†ã€‚</p><p>æœ¬æ¥æ˜¯æƒ³ç€æ¢ä¸€ä¸ªç‰›æ‰¹ä¸€ç‚¹çš„è·¯ç”±å™¨æ¯”å¦‚åç¡•AC86Uæˆ–è€…å°ç±³AX3600è¿™ç§ä»¥é€šè¿‡é«˜åŠŸç‡wifiä¿¡å·ä¼ è¾“æ›´å¤§çš„å¸¦å®½ç¨³å®šæ€§åˆ°ç”µè§†ã€‚ä½†æ˜¯ç»è¿‡ä»”ç»†åˆ†æï¼ŒK2PåŸå…ˆå·ç§°åƒå…ƒæœ€å¼ºä¸ä»…ä»…æ˜¯å› ä¸ºå®ƒæ€§ä»·æ¯”ã€0å…ƒè–…ã€å…¨åƒå…†ï¼Œæ›´æ˜¯å› ä¸ºK2Pçš„wifiä¿¡å·çš„å¼ºå¤§ã€‚æœ‰å¤§ä½¬æ‹†æœºåˆ†æä¹‹åå‘ç°ï¼ŒK2Pçš„ç¡¬ä»¶ç³»ç»Ÿï¼Œå¯¹2.4Gå’Œ5G wifiæ¨¡å—éƒ½æœ‰å„è‡ªç‹¬ç«‹çš„åŠŸæ”¾ï¼Œæˆ‘çš„ä¸€ä¸ªæœ‹å‹ç”šè‡³è¯´åœ¨ä¸€æ¥¼éƒ½èƒ½æ”¶åˆ°K2Påœ¨6æ¥¼å‘å‡ºçš„ä¿¡å·ï¼Œè¿ä¸Šä¹‹åè¿˜èƒ½ä¸Šç½‘ï¼Œä¸å¯è°“ç‰›å“‰ã€‚æ‰€ä»¥ï¼Œåœ¨å½“ä¸‹æœ‰å¦‚æ­¤å¼ºå¤§çš„æ— çº¿ä¿¡å·ä¸‹ï¼Œè¿˜æ˜¯æœ‰è¿™æ ·çš„é—®é¢˜ï¼Œé‚£ä¹ˆé€šè¿‡æ›´æ¢è·¯ç”±å™¨æ¥æ”¹å–„ç½‘ç»œçš„ç¨‹åº¦æ˜¯éå¸¸ä¸ç¡®å®šçš„ã€‚</p><p>æ”¾å¼ƒäº†èµ°æ— çº¿çš„æ€è·¯åï¼Œæˆ‘æŠŠç›®å…‰è½¬å‘äº†æœ‰çº¿è¿æ¥ã€‚ä½†æ˜¯å†æ¥çœ‹çœ‹è¿™ä¸ªéš¾é¡¶çš„ç½‘ç»œæ‹“æ‰‘ç»“æ„å’Œæˆ·å‹å›¾ï¼š</p><p><img src="/../img/NAS/route-by-modem-origin-topo.png" alt="ç½‘ç»œæ‹“æ‰‘&amp;æˆ·å‹å›¾"></p><p>åœ¨è¿™æ ·çš„æˆ·å‹ç»“æ„ä¸‹ï¼Œå…‰çŒ«å•¥çš„è¿˜å¯ä»¥æ”¾åœ¨ç”µè§†æŸœåé¢æˆ–è€…å¼±ç”µç®±ä¸­ï¼Œè€Œæƒ³è¦æŠŠK2PæŒªåˆ°å®¢å…å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå®¢å…è¿˜æœ‰çŒ«ï¼ˆçœŸÂ·çŒ«ï¼Œä¸€åªè±¹çŒ«ï¼Œä¸€åªæ©˜çŒ«ï¼Œä¸€åªè‹±çŸ­ï¼‰ï¼ŒæŠŠè·¯ç”±å™¨ææŒ‚äº†é‚£å°±æ˜¯çœŸçš„æŒ‚äº†ï¼Œæ¯•ç«Ÿå½±å“åˆ°å…¨å®¶çš„ä¸Šç½‘ã€‚</p><p>é‚£ä¹ˆç°åœ¨åªèƒ½å¯„å¸Œæœ›äºå…‰çŒ«ã€‚å…‰çŒ«é™¤äº†ä¸€ä¸ªåƒå…†ï¼ˆLANï¼‰å£æ¡¥æ¥ç»™åˆ°K2PåšPPPoEä¹‹å¤–ï¼Œè¿˜æœ‰ä¸‰ä¸ªç™¾å…†å£ã€‚å…¶ä¸­ä¸€ä¸ªç»‘å®šäº†IPTVçš„vlanæ²¡æ³•æ”¹ï¼ˆä¹Ÿä¸æ˜¯æ²¡æ³•æ”¹ï¼Œå°±æ˜¯æ€•æ”¹äº†å‡ºé—®é¢˜ï¼‰ï¼Œå‰©ä¸‹ä¸¤ä¸ªå¯ä»¥ç”¨äºå…‰çŒ«çš„LANåŒºåŸŸã€‚</p><p>ç”µè§†æ¥å…¥å…‰çŒ«å‰©ä½™çš„ä¸¤ä¸ªç½‘å£ï¼Œæ­¤æ—¶å¯¹äºå…‰çŒ«çš„LANç«¯å’ŒK2Pçš„WANç«¯ä»¥åŠç”µè§†çš„ç½‘å£ä¹‹é—´ï¼Œç»„æˆäº†ä¸€ä¸ªæ— å¤–ç½‘æƒé™ï¼Œä¹Ÿæ— K2På†…ç½‘æƒé™çš„å±€åŸŸç½‘ï¼Œæˆ–è€…å¯ä»¥è¯´æ˜¯åŸåŸŸç½‘ï¼ˆMANï¼‰ã€‚ä»¥ä¸‹æ˜¯å¯¹MANåŸåŸŸç½‘çš„ä¸€äº›å®šä¹‰ï¼š</p><blockquote><p><a href="https://zh.wikipedia.org/zh-hans/%E5%9F%8E%E5%9F%9F%E7%BD%91">wikipedia</a><br>éƒ½ä¼šç½‘åŸŸï¼ˆMetropolitan Area Networkï¼ŒMANï¼‰æŒ‡å¤§å‹çš„è®¡ç®—æœºç½‘ç»œï¼Œå±äºIEEE802.6æ ‡å‡†ï¼Œæ˜¯ä»‹äºLANå’ŒWANä¹‹é—´èƒ½ä¼ è¾“è¯­éŸ³ä¸èµ„æ–™çš„å…¬ç”¨ç½‘ç»œã€‚MANæ˜¯æ”¹è¿›LANï¼ˆå±€åŸŸç½‘ï¼‰ä¸­çš„ä¼ è¾“ä»‹è´¨ï¼Œæ‰©å¤§å±€åŸŸç½‘çš„èŒƒå›´ï¼Œè¾¾åˆ°åŒ…å«ä¸€ä¸ªå¤§å­¦æ ¡å›­ã€åŸå¸‚æˆ–éƒ½ä¼šåŒºã€‚å®ƒæ˜¯è¾ƒå¤§å‹çš„å±€åŸŸç½‘ï¼Œéœ€è¦çš„æˆæœ¬è¾ƒé«˜ï¼Œä½†å¯ä»¥æä¾›æ›´å¿«çš„ä¼ è¾“é€Ÿç‡ã€‚ä¾‹å¦‚ï¼šæŸä¸€å®¶ä¼ä¸šæŠŠåœ¨ä¸€ä¸ªåŸå¸‚æˆ–åŒä¸€å›½å®¶å†…çš„æœåŠ¡æ®ç‚¹è¿æ¥èµ·æ¥ï¼Œå°±å¯ä»¥ç§°ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªåŸåŸŸç½‘ã€‚ä¸€äº›å¸¸ç”¨äºåŸå¸‚åŒºç½‘çš„æŠ€æœ¯åŒ…æ‹¬ï¼šä»¥å¤ªç½‘ï¼ˆ10Gbps&#x2F;100Gbpsï¼‰ã€WiMAXï¼ˆå…¨çƒäº’é€šå¾®æ³¢è®¿é—®ï¼‰ã€‚</p><p><a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&tid=199086&extra=page=1&page=1&mobile=no">PPPoEåè®®å’ŒMANè®¿é—® è¿™ä¸ªæ˜¯ä»€ä¹ˆä¸œè¥¿? - æ©å±±</a><br>BYFAN:</p><blockquote><p>manæ˜¯ä¸€ä¸ªç½‘ç»œå·¥ç¨‹æœ¯è¯­ï¼Œå…¨ç§°æ˜¯Metropolitan Area Networkï¼Œæ„æ€æ˜¯åŸåŸŸç½‘ï¼ŒæŒ‡å¤§å‹çš„è®¡ç®—æœºç½‘ç»œï¼Œå±äºIEEE802.6æ ‡å‡†ï¼Œæ˜¯ä»‹äºLANå’ŒWANä¹‹é—´èƒ½ä¼ è¾“è¯­éŸ³ä¸æ•°æ®çš„å…¬ç”¨ç½‘ç»œã€‚<br>å…‰çŒ«ä¼šç»™ä½ åˆ†é…ä¸€ä¸ªå…‰çŒ«çš„IPï¼Œç„¶åä½ çš„è·¯ç”±PPPOEæ‹¨å·ä¼šæ‹¿åˆ°è¿è¥å•†ç»™ä½ çš„å¤–ç½‘IP<br>manç½‘å…³æ˜¯å…‰çŒ«åˆ†é…çš„åœ°å€ã€‚</p></blockquote></blockquote><p>åœ¨ç»„æˆWANå’ŒLANä¹‹é—´çš„ä¸­é—´ç½‘ç»œMANåŸåŸŸç½‘ä¹‹åï¼Œæ­¤æ—¶å°±å½¢æˆäº†åŒç½‘æ®µä¸‹ï¼Œç”µè§†éœ€è¦ä½¿ç”¨K2Påšç½‘å…³ï¼Œä¹Ÿå°±æ˜¯ç†ŸçŸ¥çš„æ—è·¯ç”±åœºæ™¯ï¼Œä½†æ˜¯è¿™ä¸ªæ—è·¯ç”±åˆæœ‰é‚£ä¹ˆç‚¹ä¸ä¸€æ ·ã€‚</p><p><img src="/../img/NAS/route-by-modem-new-topo.png" alt="ç°åœ¨çš„ç½‘ç»œæ‹“æ‰‘æˆäº†è¿™æ ·"></p><p>æ—¢ç„¶è¯´è¿™ä¸ªæ—è·¯ç”±ä¸é‚£ä¹ˆä¸€æ ·ï¼Œé‚£å®ƒç©¶ç«Ÿä¸ä¸€æ ·åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><blockquote><p>ä¼ ç»Ÿæ—è·¯ç”±å¹¶éæ˜¯æ¥å…¥å¹¿åŸŸç½‘çš„æœ€åä¸€å…³ï¼Œè€Œæ˜¯æ—è·¯ç”±è‡ªèº«è¿˜æœ‰ä¸€ä¸ªæŒ‡å‘çš„ç½‘å…³ï¼Œç”¨äºæ—è·¯ç”±çš„æµé‡çš„ä¸‹ä¸€è·³ï¼Œè€Œæ—è·¯ç”±è‡ªå·±åˆ™è´Ÿè´£åŒç½‘æ®µå†…å…¶ä»–è®¾å¤‡æµé‡çš„åŠ å¯†è§£å¯†ä»¥åŠå„ç§è½¬å‘ç­–ç•¥ç­‰ã€‚</p></blockquote><ol><li>K2Pè¦å……å½“æ‹¨å·ä¸Šç½‘çš„æ€»ç½‘å…³æ¥ä»£ç†å®ƒè‡ªå·±LANç«¯çš„æµé‡ä¸Šç½‘ã€‚</li><li>K2Pè¦å‚ä¸MANç«¯çš„ç»„ç½‘ï¼Œå……å½“MANç«¯çš„æ—è·¯ç”±ä»£ç†ç”µè§†æµé‡ä¸Šç½‘ä»¥åŠè®¿é—®K2Pçš„LANç«¯è®¾å¤‡ï¼ˆNASï¼‰ã€‚</li></ol><p>æ‰€ä»¥è¯´K2Pä¸€ä¸ªè®¾å¤‡æ—¢è¦åšæµé‡å‡ºå£ï¼Œåˆè¦åšæ—è·¯ç”±ï¼Œè¿™å°±ç»™K2Pçš„é…ç½®å¸¦æ¥äº†ä¸€äº›çº ç»“ã€‚K2Påœ¨åˆ·äº†Padavanåï¼Œæ˜¯æœ‰åšAPçš„åŠŸèƒ½çš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨è¿™ä¸ªæ¨¡å¼ä¸‹ç”¨äºåšæ—è·¯ç”±ï¼Œä½†åˆè¦K2Pè¿è¡Œpppdæ¥æ‹¨å·ä¸Šç½‘ï¼Œé‚£ä¹ˆåˆéœ€è¦å®ƒè¿è¡Œåœ¨ç½‘å…³æ¨¡å¼ä¸‹ã€‚</p><p>æœ¬ç€ä¼˜å…ˆä¸å½±å“ç¯å¢ƒä¸Šç½‘çš„åŸåˆ™ï¼ŒK2Pæ˜¯è‚¯å®šè¦é…ç½®åœ¨ç½‘å…³æ¨¡å¼ä¸‹æ‹¨å·ä¸Šç½‘çš„ã€‚åŸºäºè¿™ä¸ªåŸåˆ™ï¼Œå°±å¼€å§‹æŠ˜è…¾äº†ã€‚</p><h2 id="é…ç½®æ€è·¯-amp-æ–¹æ³•"><a href="#é…ç½®æ€è·¯-amp-æ–¹æ³•" class="headerlink" title="é…ç½®æ€è·¯&amp;æ–¹æ³•"></a>é…ç½®æ€è·¯&amp;æ–¹æ³•</h2><p><strong>æ³¨ï¼šä»¥ä¸‹æåŠçš„MANã€WANã€LANéƒ½æ˜¯ä»K2Pçš„è§’åº¦æ¥è®¨è®ºçš„ã€‚</strong></p><h3 id="MANç«¯éœ€è¦è®¿é—®LANç«¯"><a href="#MANç«¯éœ€è¦è®¿é—®LANç«¯" class="headerlink" title="MANç«¯éœ€è¦è®¿é—®LANç«¯"></a>MANç«¯éœ€è¦è®¿é—®LANç«¯</h3><p><strong>éœ€æ±‚ï¼š</strong></p><blockquote><p>MANç«¯éœ€è¦è®¿é—®LANç«¯è®¾å¤‡ã€‚<br>MANç«¯ç½‘æ®µä¸º192.168.1.0&#x2F;24ï¼Œè€ŒLANç«¯ç½‘æ®µä¸º192.168.2.0&#x2F;24ï¼Œéœ€è¦æ»¡è¶³192.168.1.4&#x2F;24ä¹‹é—´192.168.2.65&#x2F;24äº’è®¿ã€‚</p></blockquote><p><strong>æ€è·¯ï¼š</strong></p><p>å®ç°ç”µè§†å¯ä»¥è®¿é—®NASï¼Œæ€»ä½“æ€è·¯å°±æ— éä»¥ä¸‹å‡ ç‚¹ï¼Œç”µè§†è®¿é—®NASçš„è¯·æ±‚å¯ä»¥æ­£ç¡®åˆ°è¾¾K2Pï¼Œè€ŒK2Påˆèƒ½æ­£ç¡®è½¬å‘è¯·æ±‚åˆ°NASï¼Œå¹¶ä¸”åå‘å¯é€šã€‚</p><p>å…¶ä¸€ï¼Œè¯·æ±‚å¯è¾¾ç½‘å…³ã€‚è¿™ä¸€ç‚¹ç”±äºç”µè§†å’ŒK2Péƒ½å±äºMANç½‘æ®µï¼Œå³åŒä¸€ä¸ªå¹¿æ’­åŸŸï¼Œç”µè§†å‘å‡ºçš„è¯·æ±‚è‡ªç„¶å¯ä»¥åˆ°è¾¾K2Pï¼Œä½†æ˜¯ä¸ºäº†ä¸è¢«å…‰çŒ«è½¬å‘åˆ°å®ƒçš„å¤–éƒ¨ï¼ˆå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“å…‰çŒ«å¤–éƒ¨çš„ç½‘ç»œç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·çš„ï¼‰ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨æŒ‡æ´¾å‘å¾€LANç«¯çš„æµé‡åˆ°K2Pï¼Œä¹Ÿå°±æ˜¯é…ç½®ä¸€ä¸ªé™æ€è·¯ç”±ã€‚</p><p>å…¶äºŒï¼ŒK2Pèƒ½å¤Ÿè½¬å‘MANç«¯çš„æµé‡åˆ°LANç«¯ã€‚è¿™ä¸€ç‚¹åˆ™éœ€è¦æ‰‹åŠ¨æ”¾é€šé˜²ç«å¢™è§„åˆ™ï¼Œå› ä¸ºåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¯ç”±å™¨å›ºä»¶ç¼–å†™è€…æ˜¯ä¸ä¼šæ”¾é€šMANåˆ°LANçš„è½¬å‘çš„ï¼Œè¿™æ ·çš„åœºæ™¯å®åœ¨æ˜¯å°‘ä¹‹åˆå°‘ã€‚è€Œæˆ‘ä»¬åšçš„æ”¾é€šï¼Œä¹Ÿå¹¶éæ˜¯å®Œå…¨æ”¾é€šï¼Œè€Œæ˜¯ä»…é’ˆå¯¹MANç«¯åœ°å€è¿›è¡Œæ”¾é€šï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“è¿è¥å•†PPPoEç»™åˆ°K2Pçš„ç½‘æ®µä¸­æ˜¯å¦æœ‰å›¾è°‹ä¸è½¨çš„äººï¼Œå¯¹åŒç½‘æ®µè¿›è¡Œç«¯å£æ‰«ææˆ–è€…ç½‘ç»œæ‰«æç­‰ä¸è‰¯è¡Œä¸ºã€‚æ¯•ç«Ÿå®‰å…¨å¤§è¿‡å¤©ã€‚</p><p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p><p>å…‰çŒ«é…ç½®é™æ€è·¯ç”±å°†MANç«¯ï¼ˆ192.168.1.0&#x2F;24ï¼‰ä¸­ç›®çš„åœ°å€ä¸ºLANç«¯ï¼ˆ192.168.2.0&#x2F;24ï¼‰çš„æµé‡å®šå‘è½¬å‘åˆ°K2Pã€‚</p><blockquote><ol><li>ä½¿ç”¨å…‰çŒ«çš„è¿è¥å•†ç®¡ç†å‘˜è´¦å·ç™»å½•å…‰çŒ«åå°ï¼Œåƒç”µä¿¡çš„è¿è¥å•†ç®¡ç†å‘˜è´¦å·ä¸º<code>telecomadmin</code>ï¼Œå¯†ç æˆ–è€…å…¶ä»–çš„è¿è¥å•†å¯ä»¥å»ç½‘ä¸Šæœç´¢ã€‚</li><li>è¿›å…¥ç”¨æˆ·ä¾§ç½‘ç»œé…ç½® - é™æ€è·¯ç”±é…ç½®</li><li>æ·»åŠ é™æ€è·¯ç”±ï¼š</li></ol></blockquote><blockquote><table><thead><tr><th align="left">ç›®çš„åœ°å€</th><th align="left">ä¸‹ä¸€è·³åœ°å€</th><th align="center">ç½‘ç»œæ¥å£</th></tr></thead><tbody><tr><td align="left">192.168.2.65&#x2F;24<br>ï¼ˆNASï¼‰</td><td align="left">192.168.1.2&#x2F;24<br>ï¼ˆK2Pï¼‰</td><td align="center">LAN<br>ï¼ˆè¿™é‡Œçš„LANä»£è¡¨å…‰çŒ«çš„LANï¼Œå°±æ˜¯K2Pçš„MANï¼‰</td></tr><tr><td align="left">192.168.2.1&#x2F;24<br>ï¼ˆK2P - LAN IPï¼‰</td><td align="left">192.168.1.2&#x2F;24<br>ï¼ˆK2P - MAN IPï¼‰</td><td align="center">LAN</td></tr></tbody></table></blockquote><p>é…ç½®K2På¼€æ”¾MANç«¯åˆ°LANç«¯æµé‡çš„è½¬å‘</p><blockquote><p>åœ¨Padavançš„è‡ªå®šä¹‰è®¾ç½® - è„šæœ¬é…ç½®ä¸­ - <code>åœ¨é˜²ç«å¢™è§„åˆ™å¯åŠ¨åæ‰§è¡Œ:</code>ä¸­æ·»åŠ ä»¥ä¸‹iptablesè§„åˆ™ï¼š</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ”¾é€šFORWARDæ”¾é€šK2Pçš„æµé‡è½¬å‘ï¼Œå¯è®©ç”µè§†è®¿é—®nas</span></span><br><span class="line">iptables -A FORWARD -s 192.168.1.0/24 -j ACCEPT</span><br></pre></td></tr></table></figure><h3 id="ä»£ç†MANç«¯è®¾å¤‡ä¸Šç½‘"><a href="#ä»£ç†MANç«¯è®¾å¤‡ä¸Šç½‘" class="headerlink" title="ä»£ç†MANç«¯è®¾å¤‡ä¸Šç½‘"></a>ä»£ç†MANç«¯è®¾å¤‡ä¸Šç½‘</h3><p><strong>éœ€æ±‚ï¼š</strong></p><blockquote><p>K2Pè¦ä»£ç†MANç«¯è®¾å¤‡ä¸Šç½‘ã€‚<br>MANç«¯è®¾å¤‡éœ€è¦é…ç½®ç½‘å…³å’ŒDNSä¸ºK2Påœ°å€ã€‚</p></blockquote><p><strong>æ€è·¯ï¼š</strong></p><p>åŸºäºè¿™ä¸ªéœ€æ±‚ï¼Œå¯ä»¥çœ‹å‡ºMANç«¯è®¾å¤‡çš„è¯·æ±‚ä¸ä»…éœ€è¦èƒ½å¤Ÿè¢«K2Pè½¬å‘ï¼Œè¿˜éœ€è¦èƒ½å¤Ÿè¿›å…¥K2Pã€‚ä¸ºä»€ä¹ˆè¦è¿›å…¥K2På‘¢ï¼Ÿå› ä¸ºï¼š</p><ol><li>éœ€è¦ä½¿ç”¨K2Pä½œDNSæœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¯·æ±‚K2Pæœ¬èº«çš„æœåŠ¡ã€‚</li><li>éœ€è¦é€šè¿‡K2Pä»£ç†ä¸Šç½‘ã€‚</li></ol><blockquote><p>è¿™é‡Œæ˜ç¡®ä¸€ä¸‹ï¼Œè¯·æ±‚è¢«è½¬å‘å’Œè¢«ä»£ç†æ˜¯ä¸åŒçš„æ¦‚å¿µï¼Œè½¬å‘æ˜¯å°†è¯·æ±‚æŠ¥æ–‡åŸå°ä¸åŠ¨åœ°å†å‘å‡ºå»ï¼Œè€Œä»£ç†åˆ™æ˜¯å°†è¯·æ±‚æŠ¥æ–‡ä¸­çš„æºåœ°å€ä»åŸæ¥çœŸå®çš„åœ°å€æ¢æˆè‡ªèº«çš„åœ°å€ä¹‹åï¼Œå†å‘å‡ºå»ï¼Œä»¥èµ·åˆ°â€œä»£ç†â€çš„ä½œç”¨ã€‚<br>è¿™é‡Œçš„<u><strong>èƒ½å¤Ÿè¿›å…¥</strong></u>ï¼ŒæŒ‡çš„å°±æ˜¯è¯·æ±‚è¿›åˆ°K2Pä¸­ï¼Œè¢«K2Pæ¥æ”¶ä¹‹åå¤„ç†å®Œæˆåå†å‘å‡ºå»ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„NATâ€”â€”ç½‘ç»œåœ°å€è½¬æ¢â€”â€”ä¹Ÿæ˜¯ä¸€ç§ä»£ç†æ–¹å¼ã€‚</p></blockquote><p>æ˜ç¡®äº†ä»¥ä¸Šçš„å®šä¹‰ä¹‹åï¼Œä¹Ÿå°±æ˜ç¡®äº†ï¼Œä¸ºä»€ä¹ˆéœ€è¦æ»¡è¶³æµé‡å¯ä»¥è¿›å…¥K2Päº†ã€‚</p><p><strong>é…ç½®æ­¥éª¤ï¼š</strong></p><p>æœ‰äº†ä¸Šé¢å…‰çŒ«çš„é…ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±åªéœ€è¦é…ç½®ç”µè§†å’ŒK2På³å¯ã€‚</p><blockquote><p>ç”µè§†é…ç½®ä»¥ä¸‹ç½‘ç»œå‚æ•°ï¼š</p><table><thead><tr><th align="right">é”®</th><th align="left">å€¼</th></tr></thead><tbody><tr><td align="right">IP</td><td align="left">192.168.1.4</td></tr><tr><td align="right">æ©ç </td><td align="left">255.255.255.0</td></tr><tr><td align="right">ç½‘å…³</td><td align="left">192.168.2.1<br>æˆ–è€…æ˜¯<br>192.168.1.2</td></tr><tr><td align="right">DNS</td><td align="left">192.168.2.1</td></tr></tbody></table></blockquote><p>K2Pè¿˜æ˜¯åœ¨Padavançš„è‡ªå®šä¹‰è®¾ç½® - è„šæœ¬é…ç½®ä¸­ - <code>åœ¨é˜²ç«å¢™è§„åˆ™å¯åŠ¨åæ‰§è¡Œ:</code>ä¸­æ·»åŠ ä»¥ä¸‹iptablesè§„åˆ™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## æ”¾é€šINPUT å’ŒOUTPUT å¯ä»¥è®©MANç«¯çš„ç”µè§†è®¿é—®K2PåšDNSä»£ç†</span></span><br><span class="line">iptables -A INPUT -s 192.168.1.0/24 -j ACCEPT</span><br><span class="line">iptables -A OUTPUT -s 192.168.1.0/24 -j ACCEPT</span><br><span class="line"><span class="comment">## é…ç½®SNATå¯ä»¥è®©K2Pæ­£ç¡®ä»£ç†MANç«¯ç»ˆç«¯çš„æµé‡</span></span><br><span class="line">iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o ppp0 -j MASQUERADE</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå·²ç»å…¨éƒ¨å®ç°MANç«¯çš„ç”µè§†å¯ä»¥è®¿é—®LANç«¯çš„NASä»¥åŠé€šè¿‡K2Pä»£ç†ä¸Šç½‘äº†ã€‚å¹¶ä¸”è®¿é—®NASæ’­æ”¾è“å…‰åŸç›˜ä¹Ÿå¯ä»¥æ²¡æœ‰å¡é¡¿å¾—æ’­æ”¾äº†ã€‚æ‰€ä»¥è¯´è¿™ä¸€å¥—æ“ä½œè¿˜æ˜¯å¯¹äº†çš„ã€‚</p><h2 id="åè®°-amp-å±•æœ›"><a href="#åè®°-amp-å±•æœ›" class="headerlink" title="åè®°&amp;å±•æœ›"></a>åè®°&amp;å±•æœ›</h2><p>éœ€æ±‚è¢«æ»¡è¶³äº†ï¼Œä½†æ˜¯æ–°çš„éœ€æ±‚æ°¸è¿œéƒ½ä¼šäº§ç”Ÿã€‚ä¾‹å¦‚å¦‚æœè¯´æˆ‘ä»¥åéœ€è¦åœ¨K2Pçš„LANç«¯ç½‘ç»œä¸­æ·»åŠ ä¸€ä¸ªæ—è·¯ç”±ç”¨äºä»£ç†å…¨ç½‘æµé‡å‡ºå›½ç•™å­¦ï¼Œé‚£ä¹ˆå°±åªéœ€è¦é…ç½®ç”µè§†çš„ç½‘å…³ä¸ºæ—è·¯ç”±çš„IPå³å¯ï¼Œè€Œä¸æ˜¯éœ€è¦é…ç½®æ›´å¤šçš„å‚æ•°ã€‚</p><p>æ‰€ä»¥è¯´è¿™ä¸€å¥—æ–¹æ¡ˆå®é™…ä¸Šæ˜¯å·²ç»è€ƒè™‘åˆ°äº†æœªæ¥çš„æ‹“å±•æ€§çš„ã€‚</p><p>è€Œå¦å¤–ä¸€ä¸ªå› ç´ ï¼Œè¿˜è®°å¾—å‰é¢è¯´çš„ç”µè§†é€šè¿‡wifiè¿›è¡Œå¹¿åŸŸç½‘æµ‹é€Ÿå¯ä»¥è·‘åˆ°20M&#x2F;Så§ï¼Ÿ20MB&#x2F;Sï¼Œä¹Ÿå°±æ˜¯200Mbpsï¼ˆäºŒç™¾å…†æ¯”ç‰¹æ¯ç§’ï¼‰è€Œæ¥å…¥å…‰çŒ«çš„æ¥å£åªæœ‰100Mbpsï¼ˆç™¾å…†æ¯”ç‰¹æ¯ç§’ï¼‰ï¼Œå¸¦å®½æ•´æ•´å°äº†ä¸€åŠã€‚ä½†æ˜¯æ–‡ä»¶æ’­æ”¾çš„é¡ºç•…ç¨‹åº¦å´æé«˜äº†ï¼Œæ‰€ä»¥å¯ä»¥æ–­è¨€ï¼Œå½±å“NASä¸Šæ–‡ä»¶çš„æ’­æ”¾çš„å› ç´ ä¸ä»…ä»…åªæ˜¯å¸¦å®½ï¼Œæ›´å¤šçš„å¯èƒ½æ˜¯æ—¶å»¶å’ŒæŠ–åŠ¨ã€‚</p><p>å¦‚æœæˆ‘é‡‡å–äº†å°†K2PæŒªåˆ°å®¢å…ï¼Œå°†ç”µè§†è¿æ¥åˆ°K2Pçš„LANç«¯çš„æ–¹æ¡ˆï¼Œå°†æ¥æ·»åŠ æ—è·¯ç”±çš„æ—¶å€™åˆéœ€è¦åœ¨K2Pä¸Šæ’ä¸€ä¸ªè®¾å¤‡ï¼Œè€Œåœ¨å® ç‰©çŒ«çœ¼åº•ä¸‹å¤šæ·»åŠ ä¸€ä¸ªè®¾å¤‡å°±æ˜¯å¤šä¸€ä»½å±é™©ã€‚å½“ç„¶ï¼Œé™¤å»ä½¿ç”¨äº¤æ¢æœºçš„åœºæ™¯ï¼ˆæˆ‘è®¤ä¸ºå®¶é‡Œçš„ç½‘ç»œè®¾å¤‡è§„æ¨¡è¿˜æ‰“ä¸åˆ°ä½¿ç”¨äº¤æ¢æœºçš„åœ°æ­¥å“ˆå“ˆå“ˆï¼‰ã€‚</p><p>å¦‚æœæœ‰å¤§ä½¬æœ‹å‹ä¹Ÿæœ‰è¿™æ ·çš„éœ€æ±‚ï¼Œåˆæ­£å¥½çœ‹åˆ°äº†æˆ‘çš„è¿™ä¸ªè®°å½•ï¼Œé‚£ä¹ˆåœ¨çœ‹åˆ°æœ‰çº°æ¼çš„åœ°æ–¹ï¼Œè¯·æŒ‡å‡ºï¼Œæ„Ÿè°¢ï¼</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Geek&#39;s Work" scheme="https://hexo.chensmallx.top/categories/Geek-s-Work/"/>
    
    
    <category term="K2P" scheme="https://hexo.chensmallx.top/tags/K2P/"/>
    
    <category term="iptables" scheme="https://hexo.chensmallx.top/tags/iptables/"/>
    
    <category term="network" scheme="https://hexo.chensmallx.top/tags/network/"/>
    
    <category term="MAN" scheme="https://hexo.chensmallx.top/tags/MAN/"/>
    
    <category term="modem" scheme="https://hexo.chensmallx.top/tags/modem/"/>
    
    <category term="ç½‘ç»œ" scheme="https://hexo.chensmallx.top/tags/%E7%BD%91%E7%BB%9C/"/>
    
    <category term="åŸåŸŸç½‘" scheme="https://hexo.chensmallx.top/tags/%E5%9F%8E%E5%9F%9F%E7%BD%91/"/>
    
    <category term="å…‰çŒ«" scheme="https://hexo.chensmallx.top/tags/%E5%85%89%E7%8C%AB/"/>
    
  </entry>
  
  <entry>
    <title>HEXOåšå®¢å®ç°å¤šç«¯åŒæ­¥</title>
    <link href="https://hexo.chensmallx.top/2020/06/30/hexo-all-files-sync-by-github/"/>
    <id>https://hexo.chensmallx.top/2020/06/30/hexo-all-files-sync-by-github/</id>
    <published>2020-06-29T16:52:41.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<p>é©¬ä¸Šè¦å»å…¥èŒäº†ï¼Œéš¾å…è¦ç¢°åˆ°æ¢ç”µè„‘æˆ–è€…æ˜¯åœ¨å¤šå°è®¾å¤‡ä¸Šå†™åšæ–‡çš„åœºæ™¯ã€‚<br>å°±æ¯”å¦‚åœ¨å®¶è¦ç”¨å°å¼æœºï¼Œåœ¨å‡ºç§Ÿå±‹è¦ç”¨ç¬”è®°æœ¬ï¼Œåœ¨å…¬å¸è¦ç”¨å…¬å¸çš„å°å¼æœºï¼ŒHexoåˆæ˜¯åŸºäºé™æ€çš„pagesï¼Œæ²¡æœ‰typechoé‚£æ ·å¯ä»¥åœ¨çº¿å†™åšæ–‡çš„åå°ç³»ç»Ÿï¼Œæ‰€ä»¥ä»Šå¤©å°±æŠŠMacBookä¸Šçš„Hexoæºæ–‡ä»¶åšäº†å¤šç«¯åŒæ­¥ã€‚</p><p>æœ¬åšæ–‡ä»…ä½œè®°å½•ã€‚</p><h2 id="æºæ–‡ä»¶åŒæ­¥"><a href="#æºæ–‡ä»¶åŒæ­¥" class="headerlink" title="æºæ–‡ä»¶åŒæ­¥"></a>æºæ–‡ä»¶åŒæ­¥</h2><p>åœ¨åšå®¢æºæ–‡ä»¶ç›®å½•ç”Ÿæˆgité…ç½®å’Œä¸githubè¿œç«¯å…³è”ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin ä»“åº“é“¾æ¥</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;è®¾ç½®åŒæ­¥&quot;</span></span><br><span class="line">git push --set-upstream origin master  <span class="comment"># ä»¥åå°±å¯ä»¥ç›´æ¥git pushäº†</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ç”¨äº†å¦ä¸€ä¸ªä»“åº“åšåšå®¢æºæ–‡ä»¶å­˜æ”¾åœ°ï¼Œå› ä¸ºå¦‚æœä½¿ç”¨å¦ä¸€ä¸ªåˆ†æ”¯æ¥å­˜æ”¾çš„è¯ï¼Œéš¾å…æœ‰å‘½ä»¤è¾“é”™çš„æ—¶å€™ï¼Œæ¯”å¦‚<code>git push origin hexo</code>ä¸å°å¿ƒé¡ºæ‰‹æ‰“æˆ<code>git push</code>æˆ–è€…<code>git push origin master</code>ï¼ˆè¿™éƒ½æ˜¯æœ‰å¯èƒ½çš„ï¼Œæ¯•ç«Ÿè¿™äº›éƒ½æ˜¯ç†Ÿæ‰‹æ“ä½œäº†ï¼‰ï¼Œè¿™æ ·å­å°±å…¨ç›˜è¦†ç­ã€‚å†è€…å°±æ˜¯åœ¨githubè¢«å¾®è½¯æ”¶è´­ä¹‹åï¼Œæ¯ä¸ªå¸å·ä¸‹çš„ä»“åº“ä¸ªæ•°å·²ç»æ²¡æœ‰é™åˆ¶äº†ï¼ˆprivateä»“åº“ä¹Ÿä¸€æ ·ï¼‰ï¼Œæ‰€ä»¥è¿™æ ·åšæ›´å®‰å…¨ï¼Œæ›´æ–¹ä¾¿ã€‚</p><p>è¿˜æœ‰ä¸€ç‚¹æ˜¯Hexoåœ¨åˆ›å»ºåšå®¢ä¹‹åˆå³ä¸ºæ”¯æŒgitä»“åº“åŒæ­¥ï¼Œæœ€å¥½çš„è¯æ®å°±æ˜¯åœ¨åšå®¢æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª<code>.gitignore</code>æ–‡ä»¶ç”¨äºéå¿…é¡»æ–‡ä»¶çš„å¿½ç•¥ã€‚</p><h2 id="ç¬¬ä¸‰æ–¹ä¸»é¢˜åŒæ­¥"><a href="#ç¬¬ä¸‰æ–¹ä¸»é¢˜åŒæ­¥" class="headerlink" title="ç¬¬ä¸‰æ–¹ä¸»é¢˜åŒæ­¥"></a>ç¬¬ä¸‰æ–¹ä¸»é¢˜åŒæ­¥</h2><p>æˆ‘ç”¨çš„ä¸»é¢˜æ˜¯<a href="https://molunerfinn.com/hexo-theme-melody-doc/zh-Hans/">Melody</a>ï¼Œé‡‡ç”¨äº†Hexoçš„data filesç‰¹æ€§ï¼Œåªç”¨åœ¨<code>source/_data/melody.yml</code>ä¸­å¯¹ä¸»é¢˜é…ç½®è¿›è¡Œæ”¹åŠ¨ï¼Œè€Œä¸ç”¨æ”¹åŠ¨ä¸»é¢˜æœ¬èº«æ–‡ä»¶ï¼Œæ‰€ä»¥æ”¯æŒä¸»é¢˜å¹³æ»‘å‡çº§ï¼Œå…·ä½“å¯ä»¥ç›´æ¥åˆ°melodyå®˜æ–¹æ–‡æ¡£é‡Œçœ‹çœ‹ã€‚</p><p>å› ä¸ºä¿®æ”¹ä¸»é¢˜é…ç½®æ— éœ€æ”¹åŠ¨æ–‡ä»¶ï¼Œå·²ç»å‡çº§ä¸»é¢˜åªéœ€è¦åœ¨ä¸»é¢˜ç›®å½•ä¸­<code>git pull</code>å³å¯ï¼Œè¿™æ ·ç´¢æ€§å°±è®²ä¸»é¢˜è®¾ç½®ä¸ºgitä»“åº“çš„ä¸€ä¸ªsubmoduleå³å¯ã€‚æ— éœ€åƒå…¶ä»–çš„ä¸»é¢˜ä¸€æ ·è¦forkä¸€ä»½ä¸»é¢˜æ–‡ä»¶åˆ°è‡ªå·±çš„è´¦å·ä¸‹ã€‚</p><p>é¦–å…ˆåˆ é™¤åŸæ¥çš„melodyä¸»é¢˜æ–‡ä»¶ï¼ˆè¿™é‡Œæ— éœ€æ‹…å¿ƒå‡ºé—®é¢˜ï¼Œå› ä¸ºè¿˜ä¼šä¸‹å›æ¥ï¼‰ï¼Œç„¶åä»¥submoduleçš„å½¢å¼å°†melodyçš„æ–‡ä»¶ä¸‹è½½åˆ°ä¸»é¢˜è·¯å¾„ä¸‹å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf theme/melody</span><br><span class="line">git submodule add https://github.com/Molunerfinn/hexo-theme-melody themes/melody</span><br></pre></td></tr></table></figure><p>ç­‰å¾…å®ƒä¸‹å¥½å³å¯é‡æ–°ä½¿ç”¨åšå®¢ã€‚ä»¥ä¸‹å‘½ä»¤æµ‹è¯•ä¸€ä¸‹èƒ½ä¸èƒ½ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean; hexo g; hexo s</span><br><span class="line"><span class="comment"># ç„¶åæµè§ˆå™¨ç™»å½• http://127.0.0.1:4000 æŸ¥çœ‹ç»“æœ</span></span><br></pre></td></tr></table></figure><hr><h2 id="åœ¨æ–°çš„æœºå™¨ä¸Šé…ç½®åšå®¢ç¯å¢ƒ"><a href="#åœ¨æ–°çš„æœºå™¨ä¸Šé…ç½®åšå®¢ç¯å¢ƒ" class="headerlink" title="åœ¨æ–°çš„æœºå™¨ä¸Šé…ç½®åšå®¢ç¯å¢ƒ"></a>åœ¨æ–°çš„æœºå™¨ä¸Šé…ç½®åšå®¢ç¯å¢ƒ</h2><h3 id="å®‰è£…node-js"><a href="#å®‰è£…node-js" class="headerlink" title="å®‰è£…node.js"></a>å®‰è£…node.js</h3><p><strong>MacOS</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node  <span class="comment"># é«˜ç‰ˆæœ¬node.jsè‡ªå¸¦npm</span></span><br></pre></td></tr></table></figure><p><strong>Linux</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br></pre></td></tr></table></figure><p><strong>Windows</strong><br>å‰å¾€<a href="https://nodejs.org/zh-cn/">Mode.js</a>å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…å®‰è£…ã€‚</p><p><strong>å¯é€‰æ“ä½œï¼šnpmæ¢æº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org  <span class="comment"># æ›´æ¢æ·˜å®æº</span></span><br></pre></td></tr></table></figure><h3 id="æ­å»ºHexoç¯å¢ƒ"><a href="#æ­å»ºHexoç¯å¢ƒ" class="headerlink" title="æ­å»ºHexoç¯å¢ƒ"></a>æ­å»ºHexoç¯å¢ƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g  <span class="comment"># å®‰è£…hexoè„šæ‰‹æ¶</span></span><br></pre></td></tr></table></figure><h3 id="å…‹éš†ä»“åº“å’ŒåŒæ­¥ä¸»é¢˜å­æ¨¡å—"><a href="#å…‹éš†ä»“åº“å’ŒåŒæ­¥ä¸»é¢˜å­æ¨¡å—" class="headerlink" title="å…‹éš†ä»“åº“å’ŒåŒæ­¥ä¸»é¢˜å­æ¨¡å—"></a>å…‹éš†ä»“åº“å’ŒåŒæ­¥ä¸»é¢˜å­æ¨¡å—</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> ä»“åº“é“¾æ¥ dir_name  <span class="comment"># å…‹éš†æœ¬ä»“åº“</span></span><br><span class="line"><span class="built_in">cd</span> dir_name</span><br><span class="line">git submodule init</span><br><span class="line">git submodule update</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…Hexoé…ç½®å’Œä¸»é¢˜æ‰€éœ€ä¾èµ–"><a href="#å®‰è£…Hexoé…ç½®å’Œä¸»é¢˜æ‰€éœ€ä¾èµ–" class="headerlink" title="å®‰è£…Hexoé…ç½®å’Œä¸»é¢˜æ‰€éœ€ä¾èµ–"></a>å®‰è£…Hexoé…ç½®å’Œä¸»é¢˜æ‰€éœ€ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨åšå®¢ç›®å½•ä¸‹è¿è¡Œ</span></span><br><span class="line">npm i  <span class="comment"># å®‰è£…ä¾èµ–</span></span><br></pre></td></tr></table></figure><h3 id="æ¯æ¬¡å†™å®Œåšå®¢åŒæ­¥åˆ°ä»“åº“"><a href="#æ¯æ¬¡å†™å®Œåšå®¢åŒæ­¥åˆ°ä»“åº“" class="headerlink" title="æ¯æ¬¡å†™å®Œåšå®¢åŒæ­¥åˆ°ä»“åº“"></a>æ¯æ¬¡å†™å®Œåšå®¢åŒæ­¥åˆ°ä»“åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;æ–°å¢XXXæ–‡ç« &quot;</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure><hr><p>è¿™æ ·å³å¯å®Œæˆåšå®¢åœ¨å¤šä¸ªç»ˆç«¯ä¸­çš„åŒæ­¥é—®é¢˜äº†ã€‚<br>å½“ç„¶ï¼Œè¿™ç¯‡åšæ–‡å°±æ˜¯åœ¨å®¶é‡Œå¤´çš„å°å¼æœºä¸Šå†™å¥½å¹¶éƒ¨ç½²ã€åŒæ­¥åˆ°githubä¸Šçš„~<br>ç¾æ±æ±</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="HEXO" scheme="https://hexo.chensmallx.top/categories/HEXO/"/>
    
    
    <category term="Hexo" scheme="https://hexo.chensmallx.top/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³MacOSä¸Šmail.appè‡ªåŠ¨å¼¹å‡ºçš„å¦ä¸€ç§åŠæ³•</title>
    <link href="https://hexo.chensmallx.top/2019/10/25/solve-mac-mail-pop-up-bug/"/>
    <id>https://hexo.chensmallx.top/2019/10/25/solve-mac-mail-pop-up-bug/</id>
    <published>2019-10-25T02:24:53.000Z</published>
    <updated>2022-11-22T01:28:07.065Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-å‘ç°é—®é¢˜"><a href="#0x00-å‘ç°é—®é¢˜" class="headerlink" title="0x00 å‘ç°é—®é¢˜"></a>0x00 å‘ç°é—®é¢˜</h2><p>å› ä¸ºå¹³æ—¶éƒ½ä½¿ç”¨macè‡ªå¸¦çš„mail.appæ¥å¯¹é‚®ç®±è¿›è¡Œç®¡ç†ï¼Œæ‰€ä»¥ä½¿ç”¨ä¹ æƒ¯åŸºæœ¬å°±æ˜¯ä¸ä¼šå…³é—­ï¼Œæœ€å¤šæ˜¯ç”¨command+Wæš‚æ—¶çš„å…³é—­çª—å£ã€‚<br>ä½†æ˜¯æœ€è¿‘å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼šæ­£å¸¸å…³é—­mailçš„çª—å£ä¹‹åï¼Œä¼šæ—¶ä¸æ—¶è‡ªåŠ¨å¼¹å‡ºmailçš„çª—å£ï¼›å¦‚æœæ˜¯åœ¨æ¡Œé¢è¿˜å¥½ï¼Œå¦‚æœæ˜¯æ­£åœ¨å…¨å±ä½¿ç”¨è½¯ä»¶ï¼Œçªç„¶è¢«mailå¼¹å‡ºå ç”¨åŠä¸ªå±å¹•ï¼Œé‚£å¯å¤ªéš¾å—äº†ã€‚</p><h2 id="0x01-åˆæ­¥è§£å†³æ–¹æ³•"><a href="#0x01-åˆæ­¥è§£å†³æ–¹æ³•" class="headerlink" title="0x01 åˆæ­¥è§£å†³æ–¹æ³•"></a>0x01 åˆæ­¥è§£å†³æ–¹æ³•</h2><p>åœ¨é€›v2exçš„æ—¶å€™çœ‹åˆ°ä¸€ä½ä»å…„æåˆ°ä½¿ç”¨command+Hæ¥éšè—çª—å£ï¼Œé€šè¿‡è¿™æ ·â€œå…³é—­â€çš„mailçª—å£å°±ä¸ä¼šè‡ªåŠ¨å¼¹å‡ºï¼Œæµ‹è¯•ä¹‹åå‘ç°çš„ç¡®ä¸ä¼šå¼¹å‡ºæ¥ã€‚æ­¤äº‹åˆ°æ­¤å°±å‘Šä¸€æ®µè½ï¼Œä½†æ˜¯â€¦</p><h2 id="0x02-ç¬¦åˆä¹ æƒ¯çš„ç»ˆæè§£å†³æ–¹æ³•"><a href="#0x02-ç¬¦åˆä¹ æƒ¯çš„ç»ˆæè§£å†³æ–¹æ³•" class="headerlink" title="0x02 ç¬¦åˆä¹ æƒ¯çš„ç»ˆæè§£å†³æ–¹æ³•"></a>0x02 ç¬¦åˆä¹ æƒ¯çš„ç»ˆæè§£å†³æ–¹æ³•</h2><p>åœ¨ä¹ æƒ¯ä¸­ï¼Œå…¶ä»–è½¯ä»¶éƒ½æ˜¯ä½¿ç”¨command+Wæ¥å…³é—­çª—å£ï¼Œåªæœ‰mailæ˜¯ç”¨command+Hæ¥å…³é—­ï¼Œæœ‰æ—¶å€™æ€»æ˜¯è®°ä¸ä½ï¼Œè¿˜æ˜¯æ‰‹è´±ä½¿ç”¨äº†command+Wï¼Œè¿™æ ·ä¸€æ¥ï¼Œè¿˜æ˜¯æ—¶å¸¸ä¼šè¢«â€œåŠå±â€æ‰“æ‰°ã€‚</p><p>ä»Šå¤©é—²æ¥æ— äº‹ï¼Œçœ‹äº†ä¸€ä¸‹macä¸Šå¿«æ·é”®ä¿®æ”¹çš„é—®é¢˜ï¼Œè¿™ä¸€çœ‹å°±å‘ç°äº†è½¬æœºã€‚</p><p>ä¸‹é¢æ•™ç¨‹æ­£å¼å¼€å§‹ï¼š</p><ol><li>ï£¿ &gt; System Preference &gt; Keyboard &gt; Shortcuts &gt; App shortcuts</li><li>ç‚¹å‡»åŠ å·æ·»åŠ ä¸€ä¸ªæ–°çš„é€‰é¡¹</li><li>è¾“å…¥é…ç½®å¦‚ä¸‹ï¼š<blockquote><p>Application: Mail.app &#x2F;&#x2F; åˆ—è¡¨ä¸­æ‰‹åŠ¨é€‰æ‹©<br>Menu Title: Hide Mail &#x2F;&#x2F; mailä¸­é¡¶æ èœå•ä¸­çš„å®é™…æ“ä½œåç§°<br>Keyboard Shortcut: âŒ˜W &#x2F;&#x2F; ç›´æ¥åœ¨é”®ç›˜ä½¿ç”¨command+Wå°±å¯ä»¥è®¾å®šäº†</p></blockquote></li><li>ç‚¹å‡»add</li><li>å…³é—­ System Preference</li><li>é‡æ–°å¯åŠ¨ Mail.appï¼ˆå…¶å®å…³é—­æ²¡å¿…è¦ï¼Œè¿‡ä¸€ä¼šå°±ä¼šæ”¹è¿‡æ¥ï¼‰</li></ol><p>ç°åœ¨å°±èƒ½å¼€å¿ƒçš„ä½¿ç”¨command+Wæ¥â€œå…³é—­â€mailçš„çª—å£ä¹Ÿä¸ä¼šè¢«â€œåŠå±â€æ‰“æ‰°åˆ°å•¦~</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Geek&#39;s Work" scheme="https://hexo.chensmallx.top/categories/Geek-s-Work/"/>
    
    
    <category term="MacOS" scheme="https://hexo.chensmallx.top/tags/MacOS/"/>
    
    <category term="mail.app" scheme="https://hexo.chensmallx.top/tags/mail-app/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®°-206.åè½¬é“¾è¡¨</title>
    <link href="https://hexo.chensmallx.top/2019/09/07/leetcode-206-reverseList/"/>
    <id>https://hexo.chensmallx.top/2019/09/07/leetcode-206-reverseList/</id>
    <published>2019-09-07T15:08:01.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>åè½¬ä¸€ä¸ªå•é“¾è¡¨ã€‚</p><p>ç¤ºä¾‹:</p><blockquote><p>è¾“å…¥: 1-&gt;2-&gt;3-&gt;4-&gt;5-&gt;NULL<br>è¾“å‡º: 5-&gt;4-&gt;3-&gt;2-&gt;1-&gt;NULL</p></blockquote><p>è¿›é˜¶:<br>ä½ å¯ä»¥è¿­ä»£æˆ–é€’å½’åœ°åè½¬é“¾è¡¨ã€‚ä½ èƒ½å¦ç”¨ä¸¤ç§æ–¹æ³•è§£å†³è¿™é“é¢˜ï¼Ÿ</p><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/reverse-linked-list">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="è¿­ä»£æ³•"><a href="#è¿­ä»£æ³•" class="headerlink" title="è¿­ä»£æ³•"></a>è¿­ä»£æ³•</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">register</span> ListNode *prev = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">register</span> ListNode* curr = head;</span><br><span class="line">        <span class="keyword">register</span> ListNode* temp;</span><br><span class="line">        <span class="keyword">while</span> (curr != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            temp = curr-&gt;next;</span><br><span class="line">            curr-&gt;next = prev;</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> prev;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 16 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†53.05%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 9.2 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†28.08%çš„ç”¨æˆ·</p></blockquote><h3 id="é€’å½’æ³•"><a href="#é€’å½’æ³•" class="headerlink" title="é€’å½’æ³•"></a>é€’å½’æ³•</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">NULL</span> || head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> head;</span><br><span class="line">        ListNode* p = <span class="built_in">reverseList</span>(head-&gt;next);</span><br><span class="line">        head-&gt;next-&gt;next = head;</span><br><span class="line">        head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 12 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†85.51%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 9.1 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†47.27%çš„ç”¨æˆ·</p></blockquote><p>è¿™ä¸ªé€’å½’æ³•æœ‰ç‚¹æ„æ€ï¼Œçœ‹äº†å¾ˆä¹…æ‰èµšè¿‡å¼¯æ¥ã€‚<br>åœ¨è¯»ä»£ç +ä¸€æ­¥æ­¥ç”»å›¾è§£æä¹‹åï¼Œç»ˆäºæ˜ç™½äº†å…¶ä¸­çš„åŸç†ã€‚<br>ä¸€è¡Œä¸€è¡Œçš„è®²è§£å§ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (head == <span class="literal">NULL</span> || head-&gt;next == <span class="literal">NULL</span>) <span class="keyword">return</span> head;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€è¡Œæ˜¯æ¯ä¸ªé€’å½’éƒ½éœ€è¦çš„å¼€å§‹è¿”å›çš„æ¡ä»¶ã€‚<br>ç¬¬ä¸€ä¸ªæ¡ä»¶<code>head == NULL</code> æ˜¯å¤„ç†<code>[]</code>è¿™æ ·çš„é“¾è¡¨çš„ç‰¹æ®Šæ¡ä»¶ï¼Œå¹¶ä¸”åœ¨ç¬¬äºŒä¸ªæ¡ä»¶<code>head-&gt;next == NULL</code>ä¹‹å‰è¿›è¡Œè¿ç®—æ˜¯ä¸ºäº†é˜²æ­¢åœ¨<code>[]</code>è¿™æ ·çš„ç©ºé“¾è¡¨ä¸­è¿è¡Œ<code>head-&gt;next</code>å¯¼è‡´å†…å­˜è®¿é—®é”™è¯¯ã€‚<br>ç¬¬äºŒä¸ªæ¡ä»¶æ˜¯æ­£å¸¸çš„é€’å½’è·³å‡ºã€‚æ­é…ç¬¬2å¥ã€ç¬¬5å¥å°±å¯ä»¥å°†å°¾èŠ‚ç‚¹ä¸æ–­çš„å¾€ä¸Šå±‚è°ƒç”¨æ ˆè¿”å›ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ListNode* p = <span class="built_in">reverseList</span>(head-&gt;next);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆå°†ç¬¬ä¸€å¥è¿”å›çš„å°¾èŠ‚ç‚¹å­˜èµ·æ¥ï¼Œä»¥ä¾¿æœ€åè¿”å›ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">head-&gt;next-&gt;next = head;</span><br><span class="line">head-&gt;next = <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤å¥è¦ä¸€èµ·çœ‹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ¯ä¸€æ¬¡é€’å½’è°ƒç”¨æ ˆè¿è¡Œçš„æ—¶å€™é“¾è¡¨çš„æƒ…å†µå§ï¼Œä»¥é“¾è¡¨<code>[1,2,3,4,null]</code>ä¸ºä¾‹ã€‚nåœ¨é‚£ä¸ªèŠ‚ç‚¹ä¸‹é¢å°±ä»£è¡¨é‚£ä¸ªèŠ‚ç‚¹çš„nextæŒ‡å‘nullï¼Œhä»£è¡¨headæŒ‡å‘ï¼Œpä»£è¡¨ä¸´æ—¶æŒ‡é’ˆpæŒ‡å‘ï¼ˆæœ€åè¿”å›çš„pä¹Ÿæ˜¯è¿™ä¸ªï¼‰ã€‚</p><p>åˆå§‹çŠ¶æ€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1-&gt;2-&gt;3-&gt;4</span><br><span class="line">         n</span><br></pre></td></tr></table></figure><p>ç¬¬3å±‚è°ƒç”¨æ ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">      h  p</span><br><span class="line">1-&gt;2-&gt;3&lt;-4</span><br><span class="line">      n</span><br></pre></td></tr></table></figure><p>ç¬¬2å±‚è°ƒç”¨æ ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   h     p</span><br><span class="line">1-&gt;2&lt;-3&lt;-4</span><br><span class="line">   n</span><br></pre></td></tr></table></figure><p>ç¬¬1å±‚è°ƒç”¨æ ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">h        p</span><br><span class="line">1&lt;-2&lt;-3&lt;-4</span><br><span class="line">n</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºåœ¨headæŒ‡å‘çš„é‚£ä¸ªèŠ‚ç‚¹å¤„è¿ç®—è¿‡åå°±ä¼šå°†åä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡å‘æœ¬èŠ‚ç‚¹ï¼Œä»¥æ­¤å¾€å¤å°±ä¼šå°†æ•´æ¡é“¾è¡¨éƒ½æ¢å‘ã€‚<br>è€Œå°†æœ¬èŠ‚ç‚¹çš„nextæŒ‡å‘nullæˆ‘è§‰å¾—æ˜¯åŠ å¼ºç®—æ³•å®Œæ•´æ€§æ¥åšçš„ï¼Œå› ä¸ºæ˜¯ä¸€ä¸ªå‡½æ•°è‡ªå·±é€’å½’ï¼Œæ‰€ä»¥è¦ä¿è¯æœ€åè¿”å›çš„é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹è¦æŒ‡å‘nullï¼Œæ‰€ä»¥éœ€è¦è¿™ä¸€æ­¥ã€‚<br>å¯ä»¥çœ‹å‡ºpæŒ‡é’ˆæ°¸è¿œéƒ½æ˜¯æŒ‡å‘å°¾èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸€å±‚ä¸€å±‚çš„å¾€ä¸Šè¿”å›ï¼Œæ„Ÿè§‰è¿™ä¸€ç‚¹è®¾è®¡å¾ˆå·§å¦™å°±æ˜¯äº†ã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
    <category term="é“¾è¡¨" scheme="https://hexo.chensmallx.top/tags/%E9%93%BE%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>C++æ¨¡æ¿ç±»å¤šæ–‡ä»¶ç¼–è¯‘ æ— å®šä¹‰ è§£å†³åŠæ³•</title>
    <link href="https://hexo.chensmallx.top/2019/09/07/C-template-multi-files-compile/"/>
    <id>https://hexo.chensmallx.top/2019/09/07/C-template-multi-files-compile/</id>
    <published>2019-09-07T05:44:45.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å®ç°æ¨¡æ¿ç±»"><a href="#0x01-å®ç°æ¨¡æ¿ç±»" class="headerlink" title="0x01 å®ç°æ¨¡æ¿ç±»"></a>0x01 å®ç°æ¨¡æ¿ç±»</h2><p>é€šå¸¸åœ¨C&#x2F;C++ä¸­å®ç°ä¸€ä¸ªç±»ï¼Œéƒ½æ˜¯å°†å£°æ˜æ”¾åœ¨.hæ–‡ä»¶ä¸­ï¼Œå°†å®šä¹‰ï¼ˆå®ç°ï¼‰æ”¾åœ¨.cæˆ–è€….cppæ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚ï¼š</p><h3 id="é€šå¸¸ç¤ºä¾‹å¤šæ–‡ä»¶ç¼–è¯‘"><a href="#é€šå¸¸ç¤ºä¾‹å¤šæ–‡ä»¶ç¼–è¯‘" class="headerlink" title="é€šå¸¸ç¤ºä¾‹å¤šæ–‡ä»¶ç¼–è¯‘"></a>é€šå¸¸ç¤ºä¾‹å¤šæ–‡ä»¶ç¼–è¯‘</h3><p>myClass.h</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MY_CLASS_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MY_CLASS_H</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">myClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">myClass</span>();</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>myClass.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;myClass.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">myClass::<span class="built_in">myClass</span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>myClass.main.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;myClass.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">myClass <span class="title">mClass</span><span class="params">()</span></span>;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç¼–è¯‘çš„æ—¶å€™ç›´æ¥è¿è¡Œmakefileæˆ–è€…æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">g++ -c myClass.cpp</span><br><span class="line">g++ -c myClass.main.cpp</span><br><span class="line">g++ myClass.o myClass.main.o -o main</span><br><span class="line">./main</span><br></pre></td></tr></table></figure><p>å°±å¯ä»¥è¿è¡Œäº†ã€‚è¿™åœ¨æ²¡æœ‰è®¾è®¡æ¨¡æ¿ç±»çš„æ—¶å€™ä¸€åˆ‡éƒ½ä¼šå¾ˆé¡ºåˆ©ï¼Œä½†æ˜¯åªè¦æ¶‰åŠåˆ°äº†æ¨¡æ¿ç±»å°±â€¦</p><h3 id="æ¨¡æ¿ç±»å¤šæ–‡ä»¶é‡åˆ°çš„é—®é¢˜"><a href="#æ¨¡æ¿ç±»å¤šæ–‡ä»¶é‡åˆ°çš„é—®é¢˜" class="headerlink" title="æ¨¡æ¿ç±»å¤šæ–‡ä»¶é‡åˆ°çš„é—®é¢˜"></a>æ¨¡æ¿ç±»å¤šæ–‡ä»¶é‡åˆ°çš„é—®é¢˜</h3><p>å°±æ‹¿ä¸€ä¸ªå¾ªç¯é˜Ÿåˆ—æ¥ä¸¾ä¾‹å­å§ã€‚</p><p>cycleQueue.hpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CYCLE_QUEUE_HPP</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CYCLE_QUEUE_HPP</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;exception&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cycleQueue</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> front;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> tail;</span><br><span class="line">    T* data;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">cycleQueue</span>(<span class="type">unsigned</span> <span class="type">int</span> nsize);</span><br><span class="line">    ...</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">length</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>cycleQueue.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cycleQueue.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">cycleQueue&lt;T&gt;::<span class="built_in">cycleQueue</span>(<span class="type">unsigned</span> <span class="type">int</span> nsize)</span><br><span class="line">    :<span class="built_in">size</span>(nsize + <span class="number">1</span>),</span><br><span class="line">    <span class="built_in">front</span>(<span class="number">0</span>),</span><br><span class="line">    <span class="built_in">tail</span>(<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="type">int</span> cycleQueue&lt;T&gt;::<span class="built_in">length</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> len = (<span class="type">int</span>)tail - (<span class="type">int</span>)front;</span><br><span class="line">    <span class="keyword">return</span> len &gt;= <span class="number">0</span> ? len : -len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>cycleQueue.main.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cycleQueue.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">cycleQueue&lt;<span class="type">int</span>&gt; <span class="title">queue</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§å¸¸ç†ï¼Œæ­£å¸¸ä½¿ç”¨g++ç¼–è¯‘å³å¯ç”Ÿæˆmainå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œæœ€åä¸€æ­¥é“¾æ¥çš„æ—¶å€™ä¼šå‡ºç°é—®é¢˜ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ g++ -c cycleQueue.cpp</span><br><span class="line">$ g++ -c cycleQueue.main.cpp</span><br><span class="line">$ g++ cycleQueue.o cycleQueue.main.o -o main</span><br><span class="line">Undefined symbols <span class="keyword">for</span> architecture x86_64:</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::isFull()&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::length()&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::deQueue()&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::enQueue(int)&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::isEmpty()&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::cycleQueue(unsigned int)&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">  <span class="string">&quot;cycleQueue&lt;int&gt;::~cycleQueue()&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> cycleQueue.main.o</span><br><span class="line">ld: symbol(s) not found <span class="keyword">for</span> architecture x86_64</span><br><span class="line">collect2: error: ld returned 1 <span class="built_in">exit</span> status</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå•ç‹¬ç¼–è¯‘å®ç°ä»£ç çš„æ—¶å€™æ˜¯å¯ä»¥é€šè¿‡çš„ï¼Œä½†æ˜¯åœ¨ä¸¤ä¸ªæ–‡ä»¶é“¾æ¥èµ·æ¥çš„æ—¶å€™å‡ºç°äº†é—®é¢˜ã€‚ç»è¿‡æŸ¥æ‰¾èµ„æ–™ï¼Œè²Œä¼¼æ˜¯å› ä¸ºå®ç°æ–‡ä»¶ä¸­å®ç°çš„æ˜¯<code>cycleQueue&lt;T&gt;</code>è¿™ä¸ªç±»å‹ï¼Œä½†æ˜¯mainä¸­ä½¿ç”¨äº†<code>cycleQueue&lt;int&gt;</code>è¿™ä¸ªç±»å‹ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨æ‰¾ä¸åˆ°è¿™ä¸ªç±»å‹çš„å®šä¹‰ã€‚</p><p>æƒ³äº†æƒ³ï¼Œè¿™å¥½åŠå•Šï¼Œåªè¦æŠŠå®ç°çš„å®šä¹‰ä¹ŸåŠ è¿›å»å°±å¥½äº†å‘€ã€‚</p><p>äºæ˜¯ä¹ï¼ŒcycleQueue.hppå°±æˆäº†ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CYCLE_QUEUE_HPP</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CYCLE_QUEUE_HPP</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;exception&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cycleQueue</span></span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cycleQueue.cpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>è€Œä¸ºäº†è§£å†³includeé‡å¤é—®é¢˜ï¼ŒcycleQueue.cppä¹Ÿå˜æˆäº†ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CYCLE_QUEUE_CPP</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CYCLE_QUEUE_CPP</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cycleQueue.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>äºæ˜¯ä¹ï¼Œæ­é…makefileå°±å¯ä»¥å¿«é€Ÿå®ç°ç¼–è¯‘äº†</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">cycleQueue: cycleQueue.o cycleQueue.main.o</span></span><br><span class="line">    g++ cycleQueue.o cycleQueue.main.o -o cycleQueue</span><br><span class="line">    make clean</span><br><span class="line"></span><br><span class="line"><span class="section">cycleQueue.o: cycleQueue.cpp</span></span><br><span class="line">    g++ -c cycleQueue.cpp</span><br><span class="line"></span><br><span class="line"><span class="section">cycleQueue.main.o: cycleQueue.main.cpp</span></span><br><span class="line">    g++ -c cycleQueue.main.cpp</span><br><span class="line"></span><br><span class="line"><span class="section">clean:</span></span><br><span class="line">    rm *.o</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> -la</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x  6 chenke  staff  192 Sep  7 13:50 .</span><br><span class="line">drwxr-xr-x  3 chenke  staff   96 Sep  7 14:10 ..</span><br><span class="line">-rw-r--r--  1 chenke  staff  956 Sep  7 13:40 cycleQueue.cpp</span><br><span class="line">-rw-r--r--  1 chenke  staff  403 Sep  7 13:32 cycleQueue.hpp</span><br><span class="line">-rw-r--r--  1 chenke  staff  695 Sep  7 13:43 cycleQueue.main.cpp</span><br><span class="line">-rw-r--r--  1 chenke  staff  242 Sep  7 13:01 makefile</span><br><span class="line"></span><br><span class="line">$ make</span><br><span class="line">g++ -c cycleQueue.cpp</span><br><span class="line">g++ -c cycleQueue.main.cpp</span><br><span class="line">g++ cycleQueue.o cycleQueue.main.o -o cycleQueue</span><br><span class="line">make clean</span><br><span class="line"><span class="built_in">rm</span> *.o</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">ls</span> -la</span><br><span class="line">total 80</span><br><span class="line">drwxr-xr-x  7 chenke  staff    224 Sep  7 14:12 .</span><br><span class="line">drwxr-xr-x  3 chenke  staff     96 Sep  7 14:10 ..</span><br><span class="line">-rwxr-xr-x  1 chenke  staff  20512 Sep  7 14:12 cycleQueue</span><br><span class="line">-rw-r--r--  1 chenke  staff    956 Sep  7 13:40 cycleQueue.cpp</span><br><span class="line">-rw-r--r--  1 chenke  staff    403 Sep  7 13:32 cycleQueue.hpp</span><br><span class="line">-rw-r--r--  1 chenke  staff    695 Sep  7 13:43 cycleQueue.main.cpp</span><br><span class="line">-rw-r--r--  1 chenke  staff    242 Sep  7 13:01 makefile</span><br></pre></td></tr></table></figure><hr><p>ä¸€é¡¿æ“ä½œçŒ›å¦‚è™23333</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    
    <category term="C++" scheme="https://hexo.chensmallx.top/tags/C/"/>
    
    <category term="template" scheme="https://hexo.chensmallx.top/tags/template/"/>
    
    <category term="æ¨¡æ¿" scheme="https://hexo.chensmallx.top/tags/%E6%A8%A1%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®°-557.åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯III</title>
    <link href="https://hexo.chensmallx.top/2019/09/07/leetcode-557-reverseWord/"/>
    <id>https://hexo.chensmallx.top/2019/09/07/leetcode-557-reverseWord/</id>
    <published>2019-09-06T16:21:58.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½ éœ€è¦åè½¬å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯çš„å­—ç¬¦é¡ºåºï¼ŒåŒæ—¶ä»ä¿ç•™ç©ºæ ¼å’Œå•è¯çš„åˆå§‹é¡ºåºã€‚</p><p>ç¤ºä¾‹Â 1:</p><p>è¾“å…¥: â€œLetâ€™s take LeetCode contestâ€<br>è¾“å‡º: â€œsâ€™teL ekat edoCteeL tsetnocâ€</p><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/reverse-words-in-a-string-iii">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿™é“é¢˜ä»¥å¦ä¸€é¢˜ä½œä¸ºåŸºç¡€ï¼Œå°±æ˜¯ä¸Šä¸€ç¯‡<a href="https://hexo.chensmallx.top/2019/09/06/leetcode-344-reverseString/">leetcodeé¢˜è®°-344.åè½¬å­—ç¬¦ä¸²</a>ã€‚</p><p>è¿™é‡Œè¦æ³¨æ„çš„å°±æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªâ€œåŒæŒ‡é’ˆæ³•â€ï¼Œåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šæœ‰ä¸€ä¸ªå¤´æŒ‡é’ˆå›ºå®šï¼Œå°¾æŒ‡é’ˆä¸æ–­å‘å‰ç§»åŠ¨ï¼Œé‡åˆ°ç©ºæ ¼å³ä¸ºå¤´æŒ‡é’ˆå’Œå°¾æŒ‡é’ˆä¹‹é—´ä¸ºä¸€ä¸ªå•è¯ï¼Œå¯¹è¿™ä¸ªå•è¯è¿›è¡Œåè½¬å³å¯ã€‚è€Œä½¿ç”¨çš„äº¤æ¢ç®—æ³•æ˜¯åè½¬å­—ç¬¦ä¸²ä¸­æœ€å¿«é€Ÿçš„å¼‚æˆ–äº¤æ¢æ³•ï¼Œå®é™…ä¸Šè¿˜æ˜¯ä¸€ä¸ªåŒæŒ‡é’ˆæ³•ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reverseString</span><span class="params">(<span class="type">int</span> front, <span class="type">int</span> tail, string&amp; str)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (front &lt; tail) &#123;</span><br><span class="line">            str[front] ^= str[tail];</span><br><span class="line">            str[tail] ^= str[front];</span><br><span class="line">            str[front++] ^= str[tail--];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">reverseWords</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> front = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">length</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                <span class="built_in">reverseString</span>(front, i - <span class="number">1</span>, s);</span><br><span class="line">                front = i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverseString</span>(front, s.<span class="built_in">length</span>() - <span class="number">1</span>, s);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 16 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†98.24%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 11.6 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†95.48%çš„ç”¨æˆ·</p></blockquote>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®°-344.åè½¬å­—ç¬¦ä¸²</title>
    <link href="https://hexo.chensmallx.top/2019/09/06/leetcode-344-reverseString/"/>
    <id>https://hexo.chensmallx.top/2019/09/06/leetcode-344-reverseString/</id>
    <published>2019-09-06T15:39:58.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²åè½¬è¿‡æ¥ã€‚è¾“å…¥å­—ç¬¦ä¸²ä»¥å­—ç¬¦æ•°ç»„ char[] çš„å½¢å¼ç»™å‡ºã€‚</p><p>ä¸è¦ç»™å¦å¤–çš„æ•°ç»„åˆ†é…é¢å¤–çš„ç©ºé—´ï¼Œä½ å¿…é¡»åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„ã€ä½¿ç”¨ O(1) çš„é¢å¤–ç©ºé—´è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ ASCII ç è¡¨ä¸­çš„å¯æ‰“å°å­—ç¬¦ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼š[â€œhâ€,â€eâ€,â€lâ€,â€lâ€,â€oâ€]<br>è¾“å‡ºï¼š[â€œoâ€,â€lâ€,â€lâ€,â€eâ€,â€hâ€]</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼š[â€œHâ€,â€aâ€,â€nâ€,â€nâ€,â€aâ€,â€hâ€]<br>è¾“å‡ºï¼š[â€œhâ€,â€aâ€,â€nâ€,â€nâ€,â€aâ€,â€Hâ€]</p></blockquote><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/reverse-string">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><h3 id="è§£æ³•ä¸€ï¼ˆè¾£é¸¡è§£æ³•ï¼‰ç›´æ¥ä¸‹æ ‡äº¤æ¢"><a href="#è§£æ³•ä¸€ï¼ˆè¾£é¸¡è§£æ³•ï¼‰ç›´æ¥ä¸‹æ ‡äº¤æ¢" class="headerlink" title="è§£æ³•ä¸€ï¼ˆè¾£é¸¡è§£æ³•ï¼‰ç›´æ¥ä¸‹æ ‡äº¤æ¢"></a>è§£æ³•ä¸€ï¼ˆè¾£é¸¡è§£æ³•ï¼‰ç›´æ¥ä¸‹æ ‡äº¤æ¢</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reverseString</span><span class="params">(vector&lt;<span class="type">char</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> length = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">char</span> c;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length / <span class="number">2</span>; i++) &#123;</span><br><span class="line">            c = s[i];</span><br><span class="line">            s[i] = s[length - <span class="number">1</span> - i];</span><br><span class="line">            s[length - <span class="number">1</span> - i] = c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 72 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†54.97%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 15.2 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†79.02%çš„ç”¨æˆ·</p></blockquote><h3 id="è§£æ³•äºŒ-åŒæŒ‡é’ˆæ³•"><a href="#è§£æ³•äºŒ-åŒæŒ‡é’ˆæ³•" class="headerlink" title="è§£æ³•äºŒ åŒæŒ‡é’ˆæ³•"></a>è§£æ³•äºŒ åŒæŒ‡é’ˆæ³•</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">char</span>&amp; x, <span class="type">char</span>&amp; y)</span> </span>&#123;</span><br><span class="line">        <span class="type">char</span> c = x;</span><br><span class="line">        x = y;</span><br><span class="line">        y = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reverseString</span><span class="params">(vector&lt;<span class="type">char</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>, j = s.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(s[i], s[j]);</span><br><span class="line">            i++, j--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 64 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†85.40%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 15.1 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†90.38%çš„ç”¨æˆ·</p></blockquote><p>åŒæŒ‡é’ˆçš„ç¡®æ¯”ç›´æ¥è¯¶è®¡ç®—ä¸‹æ ‡å¿«äº†ä¸å°‘ï¼Œæ¯•ç«Ÿåœ¨ç®—åŠ å‡çš„æ—¶å€™åŒæŒ‡é’ˆæ³•åªç”¨äº†ä¸¤ä¸ªåŸºæœ¬çš„åŠ å‡ï¼Œè€Œç›´æ¥è®¡ç®—ä¸‹æ ‡ï¼ˆç®—ä¸Šæ”¹å˜iï¼‰åˆ™éœ€è¦5æ­¤åŠ å‡æ³•ï¼Œæ¶ˆè€—äº†ä¸¤å€å¤šçš„è®¡ç®—é‡ã€‚</p><h3 id="ä¼˜åŒ–çš„åŒæŒ‡é’ˆ"><a href="#ä¼˜åŒ–çš„åŒæŒ‡é’ˆ" class="headerlink" title="ä¼˜åŒ–çš„åŒæŒ‡é’ˆ"></a>ä¼˜åŒ–çš„åŒæŒ‡é’ˆ</h3><h4 id="ä¼˜åŒ–ä¸€-C-swap"><a href="#ä¼˜åŒ–ä¸€-C-swap" class="headerlink" title="ä¼˜åŒ–ä¸€ C++ swap"></a>ä¼˜åŒ–ä¸€ C++ swap</h4><p>è¿™é‡Œä½¿ç”¨äº†c++è‡ªå¸¦çš„<code>swap()</code>å‡½æ•°ï¼Œåœ¨åº•å±‚ä¸Šåº”è¯¥æ˜¯æœ‰æ”¹è¿›çš„ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨çš„æ—¶å€™å°†è‡ªå¢è¿ç®—è¿ç”¨å¾—æ·‹æ¼“å°½è‡´ï¼Œäºæ˜¯ä¹åˆåŠ å¿«äº†ä¸å°‘ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reverseString</span><span class="params">(vector&lt;<span class="type">char</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>, j = s.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(s[i++], s[j--]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 60 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†94.45%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 15 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†94.68%çš„ç”¨æˆ·</p></blockquote><h4 id="ä¼˜åŒ–äºŒ-ä½è¿ç®—"><a href="#ä¼˜åŒ–äºŒ-ä½è¿ç®—" class="headerlink" title="ä¼˜åŒ–äºŒ ä½è¿ç®—"></a>ä¼˜åŒ–äºŒ ä½è¿ç®—</h4><p>è¿™ç®—æ˜¯å¥‡æŠ€æ·«å·§çš„ä¸€ç§äº†ï¼Œå°±æ˜¯ä¸¤ä¸ªå˜é‡æ¥å›å¼‚æˆ–å°±å¯ä»¥äº¤æ¢æ•°æ®ï¼Œè€Œä¸”æ˜¯ä»bitå±‚é¢è¿›è¡Œè¿ç®—çš„ï¼Œå¯ä»¥è¯´æ˜¯é€Ÿåº¦ç‰¹åˆ«çš„å¿«äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">reverseString</span><span class="params">(vector&lt;<span class="type">char</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="number">0</span>, j = s.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">            s[i] ^= s[j];</span><br><span class="line">            s[j] ^= s[i];</span><br><span class="line">            s[i++] ^= s[j--];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 52 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†99.76%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 15.3 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†75.25%çš„ç”¨æˆ·</p></blockquote>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®° 292.Nimæ¸¸æˆ</title>
    <link href="https://hexo.chensmallx.top/2019/09/05/leetcode-292-canWinNum/"/>
    <id>https://hexo.chensmallx.top/2019/09/05/leetcode-292-canWinNum/</id>
    <published>2019-09-05T14:08:58.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ä½ å’Œä½ çš„æœ‹å‹ï¼Œä¸¤ä¸ªäººä¸€èµ·ç©Â Nim æ¸¸æˆï¼šæ¡Œå­ä¸Šæœ‰ä¸€å †çŸ³å¤´ï¼Œæ¯æ¬¡ä½ ä»¬è½®æµæ‹¿æ‰Â 1 - 3 å—çŸ³å¤´ã€‚ æ‹¿æ‰æœ€åä¸€å—çŸ³å¤´çš„äººå°±æ˜¯è·èƒœè€…ã€‚ä½ ä½œä¸ºå…ˆæ‰‹ã€‚</p><p>ä½ ä»¬æ˜¯èªæ˜äººï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯æœ€ä¼˜è§£ã€‚ ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¥åˆ¤æ–­ä½ æ˜¯å¦å¯ä»¥åœ¨ç»™å®šçŸ³å¤´æ•°é‡çš„æƒ…å†µä¸‹èµ¢å¾—æ¸¸æˆã€‚</p><p>ç¤ºä¾‹:</p><blockquote><p>è¾“å…¥: 4<br>è¾“å‡º: false<br>è§£é‡Š: å¦‚æœå †ä¸­æœ‰ 4 å—çŸ³å¤´ï¼Œé‚£ä¹ˆä½ æ°¸è¿œä¸ä¼šèµ¢å¾—æ¯”èµ›ï¼›<br>å› ä¸ºæ— è®ºä½ æ‹¿èµ° 1 å—ã€2 å— è¿˜æ˜¯ 3 å—çŸ³å¤´ï¼Œæœ€åä¸€å—çŸ³å¤´æ€»æ˜¯ä¼šè¢«ä½ çš„æœ‹å‹æ‹¿èµ°ã€‚</p></blockquote><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/nim-game">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>åˆšå¼€å§‹çœ‹åˆ°è¿™é“é¢˜çš„éš¾åº¦ä¸ºâ€œç®€å•â€ï¼Œæˆ‘æ€€ç–‘äº†ä¸€ä¸‹ï¼Œç”šè‡³æ— ä»ä¸‹æ‰‹ã€‚</p><p>çœ‹åˆ°é¢˜è§£çš„æ—¶å€™æ‰å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°å­¦æ¨ç†é¢˜ï¼Œæˆ–è€…è¯´æ˜¯ä¸€é“å°å­¦ç”Ÿåšçš„â€œæ‰¾è§„å¾‹â€é¢˜ç›®ã€‚</p><p>åœ¨æ¡ä»¶ä¸­ï¼Œæœ‰ä¸€ä¸ªå…³é”®ç‚¹â€”â€”ä½ ä½œä¸ºå…ˆæ‰‹ã€‚è¿™ä¸€ç‚¹é‡è¦åœ¨äºä¹‹åçš„æ¨ç†éƒ½æœ‰ä¸€ä¸ªå‰æã€‚</p><p>Leetcode å®˜æ–¹é¢˜è§£ï¼š</p><blockquote><p>å¦‚æœçŸ³å¤´å †ä¸­åªæœ‰ä¸€å—ã€ä¸¤å—ã€æˆ–æ˜¯ä¸‰å—çŸ³å¤´ï¼Œé‚£ä¹ˆåœ¨ä½ çš„å›åˆï¼Œä½ å°±å¯ä»¥æŠŠå…¨éƒ¨çŸ³å­æ‹¿èµ°ï¼Œä»è€Œåœ¨æ¸¸æˆä¸­å–èƒœã€‚è€Œå¦‚æœå°±åƒé¢˜ç›®æè¿°é‚£æ ·ï¼Œå †ä¸­æ°å¥½æœ‰å››å—çŸ³å¤´ï¼Œä½ å°±ä¼šå¤±è´¥ã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ç®¡ä½ å–èµ°å¤šå°‘çŸ³å¤´ï¼Œæ€»ä¼šä¸ºä½ çš„å¯¹æ‰‹ç•™ä¸‹å‡ å—ï¼Œä½¿å¾—ä»–å¯ä»¥åœ¨æ¸¸æˆä¸­æ‰“è´¥ä½ ã€‚å› æ­¤ï¼Œè¦æƒ³è·èƒœï¼Œåœ¨ä½ çš„å›åˆä¸­ï¼Œå¿…é¡»é¿å…çŸ³å¤´å †ä¸­çš„çŸ³å­æ•°ä¸º 4 çš„æƒ…å†µã€‚</p><p>åŒæ ·åœ°ï¼Œå¦‚æœæœ‰äº”å—ã€å…­å—ã€æˆ–æ˜¯ä¸ƒå—çŸ³å¤´ï¼Œä½ å¯ä»¥æ§åˆ¶è‡ªå·±æ‹¿å–çš„çŸ³å¤´æ•°ï¼Œæ€»æ˜¯æ°å¥½ç»™ä½ çš„å¯¹æ‰‹ç•™ä¸‹å››å—çŸ³å¤´ï¼Œä½¿ä»–è¾“æ‰è¿™åœºæ¯”èµ›ã€‚ä½†æ˜¯å¦‚æœçŸ³å¤´å †é‡Œæœ‰å…«å—çŸ³å¤´ï¼Œä½ å°±ä¸å¯é¿å…åœ°ä¼šè¾“æ‰ï¼Œå› ä¸ºä¸ç®¡ä½ ä»ä¸€å †çŸ³å¤´ä¸­æŒ‘å‡ºä¸€å—ã€ä¸¤å—è¿˜æ˜¯ä¸‰å—ï¼Œä½ çš„å¯¹æ‰‹éƒ½å¯ä»¥é€‰æ‹©ä¸‰å—ã€ä¸¤å—æˆ–ä¸€å—ï¼Œä»¥ç¡®ä¿åœ¨å†ä¸€æ¬¡è½®åˆ°ä½ çš„æ—¶å€™ï¼Œä½ ä¼šé¢å¯¹å››å—çŸ³å¤´ã€‚</p></blockquote><p>çœ‹çœ‹ ooolize çš„å›ç­”ä¸­çš„è¡¨æ ¼ï¼š</p><blockquote><table><thead><tr><th>who\times</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>â€¦</th></tr></thead><tbody><tr><td>us</td><td>âˆš</td><td>âˆš</td><td>âˆš</td><td>Ã—</td><td>âˆš</td><td>âˆš</td><td>âˆš</td><td>Ã—</td><td>âˆš</td><td>Â·Â·Â·</td></tr><tr><td>enemy</td><td>Ã—</td><td>Ã—</td><td>Ã—</td><td>âˆš</td><td>Ã—</td><td>Ã—</td><td>Ã—</td><td>âˆš</td><td>Ã—</td><td>Â·Â·Â·</td></tr></tbody></table></blockquote><p>æ‰€ä»¥è¯´ï¼Œæƒ³è¦è·èƒœï¼Œé‚£å°±å¿…é¡»ä½¿å¾—å­˜åœ¨çš„çŸ³å­æ•°é‡ä¸ä¸º4çš„å€æ•°ã€‚æ—¢ç„¶è·å¾—äº†è¿™ä¸€æ­¥é‡è¦çš„æ¨ç†ç»“è®ºï¼Œé‚£ä¹ˆä»£ç å°±ä¸æ˜¯é—®é¢˜äº†ã€‚</p><h3 id="æ¨¡4æ³•"><a href="#æ¨¡4æ³•" class="headerlink" title="æ¨¡4æ³•"></a>æ¨¡4æ³•</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">canWinNim</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n % <span class="number">4</span> == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ:</p><p>å…¶å®æ˜¯ä¼šåœ¨0~8msä¹‹é—´æµ®åŠ¨çš„ï¼Œæ‰€ä»¥ä¸å¤Ÿç¨³å®šçš„ç®—æ³•ï¼Œleetcodeçš„åˆ¤å®šæœºçŠ¶å†µå¯¹ç»“æœä¼šæœ‰å½±å“ã€‚</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 0 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†100.00%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 8 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†52.50%çš„ç”¨æˆ·</p></blockquote><h2 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h2><p>ç®—æ³•é¢˜åšç€åšç€å°±æœ‰ç‚¹ä¸¢äº†åˆå¿ƒäº†ã€‚ç®—æ³•é¢˜å½’æ ¹ç»“åº•è¿˜æ˜¯æ•°å­¦é¢˜ï¼Œé—®é¢˜è¿˜æ˜¯è¦ä»æ•°å­¦çš„è§’åº¦å‡ºå‘å»è§£å†³ï¼Œè€Œæ‰¾è§„å¾‹å°±æ˜¯æ•°å­¦ä¸Šæœ€åŸºæœ¬çš„ä¸€ç§è§£é¢˜æ€è·¯ã€‚åŸºç¡€å¤šäº†é«˜å¤§ä¸Šçš„ç®—æ³•ä¹‹åï¼Œæ‹¿åˆ°ä¸€é“é¢˜è„‘æµ·é‡Œé¢å†’å‡ºæ¥çš„æ€è·¯å¾ˆå°‘å°±æ˜¯å¾ˆç®€å•çš„è§£æ³•äº†ã€‚</p><p>åªèƒ½è¯´ï¼Œåƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹ï¼Œå¥½å§ã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®°-46.å…¨æ’åˆ—</title>
    <link href="https://hexo.chensmallx.top/2019/08/22/leetcode-46-permute/"/>
    <id>https://hexo.chensmallx.top/2019/08/22/leetcode-46-permute/</id>
    <published>2019-08-22T15:00:20.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€ä¸ªæ²¡æœ‰é‡å¤æ•°å­—çš„åºåˆ—ï¼Œè¿”å›å…¶æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—ã€‚</p><p>ç¤ºä¾‹:</p><blockquote><p>è¾“å…¥: [1,2,3]<br>è¾“å‡º:[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]</p></blockquote><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/permutations">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è§£è¿™é“é¢˜ä¸»è¦ç”¨äº†é€šè¿‡é€’å½’å®ç°å›æº¯çš„åŠæ³•ã€‚<br>åœ¨å¤„ç†æ•°ç»„çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆç¡®å®šå½“å‰æ­£åœ¨éå†çš„ä½ï¼Œä¾‹å¦‚ç¬¬ä¸€ä½ï¼Œé‚£ä¹ˆå°±å°†æ¯ä¸€ä½å’Œç¬¬ä¸€ä½äº’æ¢ï¼Œç„¶ååœ¨ä¸‹ä¸€ä¸ªé€’å½’è¿‡ç¨‹ä¸­å°†ç¬¬äºŒä½å’Œå…¶ä»–æ•°å­—ä¾æ¬¡æ›¿æ¢ï¼Œè¿™æ ·çš„è¿‡ç¨‹å’Œäººç±»çš„æ€ç»´å‡ ä¹ä¸€æ ·ã€‚</p><p>å…·ä½“å¯ä»¥çœ‹è¿™ä¸ª<a href="https://leetcode-cn.com/problems/permutations/solution/quan-pai-lie-by-leetcode/">leetcode å®˜æ–¹é¢˜è§£</a>ï¼Œè®²çš„è¿˜æ˜¯å¾ˆå…·ä½“çš„ï¼Œè¿˜æœ‰åŠ¨å›¾å¯ä»¥çœ‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; res;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">permute</span>(vector&lt;<span class="type">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() == <span class="number">1</span>) &#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(vector&lt;<span class="type">int</span>&gt;&#123;nums[<span class="number">0</span>]&#125;);</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">process</span>(nums, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">process</span><span class="params">(vector&lt;<span class="type">int</span>&gt; nums, <span class="type">int</span> front)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (front == nums.<span class="built_in">size</span>() - <span class="number">1</span>) &#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(nums);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = front; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; _nums = nums;</span><br><span class="line">            <span class="type">int</span> temp = _nums[front];</span><br><span class="line">            _nums[front] = _nums[i];</span><br><span class="line">            _nums[i] = temp;</span><br><span class="line">            <span class="built_in">process</span>(_nums, front + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><p>æ‰§è¡Œç”¨æ—¶ : 16 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†86.15%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 10.2 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†13.65%çš„ç”¨æˆ·</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®°-1114.æŒ‰åºæ‰“å°</title>
    <link href="https://hexo.chensmallx.top/2019/08/21/leetcode-1114-Foo-Bar/"/>
    <id>https://hexo.chensmallx.top/2019/08/21/leetcode-1114-Foo-Bar/</id>
    <published>2019-08-21T15:30:56.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç±»ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">Â  <span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; <span class="built_in">print</span>(<span class="string">&quot;one&quot;</span>); &#125;</span><br><span class="line">Â  <span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">two</span><span class="params">()</span> </span>&#123; <span class="built_in">print</span>(<span class="string">&quot;two&quot;</span>); &#125;</span><br><span class="line">Â  <span class="function"><span class="keyword">public</span> <span class="type">void</span> <span class="title">three</span><span class="params">()</span> </span>&#123; <span class="built_in">print</span>(<span class="string">&quot;three&quot;</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‰ä¸ªä¸åŒçš„çº¿ç¨‹å°†ä¼šå…±ç”¨ä¸€ä¸ªÂ FooÂ å®ä¾‹ã€‚</p><p>çº¿ç¨‹ A å°†ä¼šè°ƒç”¨ <code>one()</code> æ–¹æ³•<br>çº¿ç¨‹ B å°†ä¼šè°ƒç”¨Â <code>two()</code> æ–¹æ³•<br>çº¿ç¨‹ C å°†ä¼šè°ƒç”¨ <code>three()</code> æ–¹æ³•<br>è¯·è®¾è®¡ä¿®æ”¹ç¨‹åºï¼Œä»¥ç¡®ä¿ <code>two()</code> æ–¹æ³•åœ¨ <code>one()</code> æ–¹æ³•ä¹‹åè¢«æ‰§è¡Œï¼Œ<code>three()</code> æ–¹æ³•åœ¨ <code>two()</code> æ–¹æ³•ä¹‹åè¢«æ‰§è¡Œã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: [1,2,3]<br>è¾“å‡º: â€œonetwothreeâ€<br>è§£é‡Š:<br>æœ‰ä¸‰ä¸ªçº¿ç¨‹ä¼šè¢«å¼‚æ­¥å¯åŠ¨ã€‚<br>è¾“å…¥ [1,2,3] è¡¨ç¤ºçº¿ç¨‹ A å°†ä¼šè°ƒç”¨ one() æ–¹æ³•ï¼Œçº¿ç¨‹ B å°†ä¼šè°ƒç”¨ two() æ–¹æ³•ï¼Œçº¿ç¨‹ C å°†ä¼šè°ƒç”¨ three() æ–¹æ³•ã€‚<br>æ­£ç¡®çš„è¾“å‡ºæ˜¯ â€œonetwothreeâ€ã€‚</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: [1,3,2]<br>è¾“å‡º: â€œonetwothreeâ€<br>è§£é‡Š:<br>è¾“å…¥ [1,3,2] è¡¨ç¤ºçº¿ç¨‹ A å°†ä¼šè°ƒç”¨ one() æ–¹æ³•ï¼Œçº¿ç¨‹ B å°†ä¼šè°ƒç”¨ three() æ–¹æ³•ï¼Œçº¿ç¨‹ C å°†ä¼šè°ƒç”¨ two() æ–¹æ³•ã€‚<br>æ­£ç¡®çš„è¾“å‡ºæ˜¯ â€œonetwothreeâ€ã€‚</p></blockquote><p>æ³¨æ„:<br>å°½ç®¡è¾“å…¥ä¸­çš„æ•°å­—ä¼¼ä¹æš—ç¤ºäº†é¡ºåºï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸ä¿è¯çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿä¸­çš„è°ƒåº¦é¡ºåºã€‚<br>ä½ çœ‹åˆ°çš„è¾“å…¥æ ¼å¼ä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿æµ‹è¯•çš„å…¨é¢æ€§ã€‚</p><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/print-in-order">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>å› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡åšå¤šçº¿ç¨‹çš„é¢˜ç›®ï¼Œä¹‹å‰å¯¹æ“ä½œç³»ç»Ÿçš„é”ä¹‹ç±»çš„ä¸œè¥¿ä¹Ÿæ²¡æœ‰å¥½å¥½å­¦ï¼Œè¿™æ¬¡åšä¸‹æ¥è¿™é¢˜ï¼ˆåŒ…æ‹¬çœ‹äº†å…¶ä»–äººçš„é¢˜è§£ï¼‰ä¹Ÿç®—æ˜¯å¤ä¹ äº†ä»¥ä¸‹å¤šçº¿ç¨‹çš„åŸºç¡€ã€‚</p><h3 id="Naive"><a href="#Naive" class="headerlink" title="Naive"></a>Naive</h3><p>ä¸€å¼€å§‹å¹¶ä¸çŸ¥é“é”è¦æ€ä¹ˆå®ç°ï¼ˆä½“ç°äº†æˆ‘çš„èœï¼‰ï¼Œæ‰€ä»¥å°±ç”¨äº†å‡ ä¸ªboolå’Œwhileå®ç°äº†ç®€å•çš„é˜»å¡ï¼ˆæˆ‘å¹¶ä¸çŸ¥é“çº¿ç¨‹çš„é˜»å¡æ˜¯æ€ä¹ˆå®ç°çš„ï¼‰ï¼Œç»“æœè¿è¡Œç»“æœä¸€å‡ºæ¥å°±å‚»çœ¼äº†ï¼ˆå¤ªèœäº†ï¼‰ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Foo</span>() &#123;</span><br><span class="line">        f = s = t = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">first</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printFirst)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// printFirst() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printFirst</span>();</span><br><span class="line">        f = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">second</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printSecond)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!(f &amp;&amp; !s));</span><br><span class="line">        <span class="comment">// printSecond() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printSecond</span>();</span><br><span class="line">        s = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">third</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printThird)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (!(f &amp;&amp; s &amp;&amp; !t));</span><br><span class="line">        <span class="comment">// printThird() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printThird</span>();</span><br><span class="line">        t = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">bool</span> f, s, t;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="ç»“æœ1"><a href="#ç»“æœ1" class="headerlink" title="ç»“æœ1"></a>ç»“æœ1</h4><p>æ‰§è¡Œç”¨æ—¶ : 1484 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†5.01%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 9 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†100.00%çš„ç”¨æˆ·</p><p>å½“ç„¶æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥æˆ‘çš„å ç”¨æ€»æ˜¯è¶…è¿‡äº†100%çš„äººã€‚</p><h3 id="Use-mutex"><a href="#Use-mutex" class="headerlink" title="Use mutex"></a>Use mutex</h3><p>çœ‹è¿‡äº†åˆ«äººçš„é¢˜è§£ä¹‹åï¼Œæˆ‘å‘ç°äº†å¤šæ•°äººç”¨äº†<code>std::mutex</code>å’Œ<code>std::condition_variable</code>è¿™ä¸¤ä¸ªåº“ç”¨äºäº’æ–¥é”çš„å®ç°ã€‚å› ä¸ºmutexæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥å°±é¡ºä¾¿å­¦äº†ä»¥ä¸‹ï¼ˆè¿˜ä¸æ˜¯å› ä¸ºå¤ªèœï¼‰ã€‚</p><p>å…ˆæ¥çœ‹çœ‹ <code>std::mutex</code> çš„ä»‹ç»ï¼š</p><blockquote><ul><li><p>æ„é€ å‡½æ•°ï¼Œstd::mutexä¸å…è®¸æ‹·è´æ„é€ ï¼Œä¹Ÿä¸å…è®¸ move æ‹·è´ï¼Œæœ€åˆäº§ç”Ÿçš„ mutex å¯¹è±¡æ˜¯å¤„äº unlocked çŠ¶æ€çš„ã€‚</p></li><li><p>lock()ï¼Œè°ƒç”¨çº¿ç¨‹å°†é”ä½è¯¥äº’æ–¥é‡ã€‚çº¿ç¨‹è°ƒç”¨è¯¥å‡½æ•°ä¼šå‘ç”Ÿä¸‹é¢ 3 ç§æƒ…å†µï¼š</p><blockquote><ol><li>å¦‚æœè¯¥äº’æ–¥é‡å½“å‰æ²¡æœ‰è¢«é”ä½ï¼Œåˆ™è°ƒç”¨çº¿ç¨‹å°†è¯¥äº’æ–¥é‡é”ä½ï¼Œç›´åˆ°è°ƒç”¨ unlockä¹‹å‰ï¼Œè¯¥çº¿ç¨‹ä¸€ç›´æ‹¥æœ‰è¯¥é”ã€‚</li><li>å¦‚æœå½“å‰äº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹é”ä½ï¼Œåˆ™å½“å‰çš„è°ƒç”¨çº¿ç¨‹è¢«é˜»å¡ä½ã€‚</li><li>å¦‚æœå½“å‰äº’æ–¥é‡è¢«å½“å‰è°ƒç”¨çº¿ç¨‹é”ä½ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”(deadlock)ã€‚</li></ol></blockquote></li><li><p>unlock()ï¼Œ è§£é”ï¼Œé‡Šæ”¾å¯¹äº’æ–¥é‡çš„æ‰€æœ‰æƒã€‚</p></li><li><p>try_lock()ï¼Œå°è¯•é”ä½äº’æ–¥é‡ï¼Œå¦‚æœäº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é˜»å¡ã€‚çº¿ç¨‹è°ƒç”¨è¯¥å‡½æ•°ä¹Ÿä¼šå‡ºç°ä¸‹é¢ 3 ç§æƒ…å†µï¼Œ(1). å¦‚æœå½“å‰äº’æ–¥é‡æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œåˆ™è¯¥çº¿ç¨‹é”ä½äº’æ–¥é‡ï¼Œç›´åˆ°è¯¥çº¿ç¨‹è°ƒç”¨ unlock é‡Šæ”¾äº’æ–¥é‡ã€‚(2). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹é”ä½ï¼Œåˆ™å½“å‰è°ƒç”¨çº¿ç¨‹è¿”å› falseï¼Œè€Œå¹¶ä¸ä¼šè¢«é˜»å¡æ‰ã€‚(3). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å½“å‰è°ƒç”¨çº¿ç¨‹é”ä½ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”(deadlock)ã€‚</p></li></ul><p>reference:<a href="https://www.cnblogs.com/haippy/p/3237213.html">C++11 å¹¶å‘æŒ‡å—ä¸‰(std::mutex è¯¦è§£)</a></p></blockquote><p>ä»ç”¨æ³•ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨äº’æ–¥é‡è¢«é”ä½çš„æ—¶å€™ï¼Œçº¿ç¨‹æ‰§è¡Œlock()å‡½æ•°æ˜¯ä¼šè¢«é˜»å¡çš„ï¼Œåªæœ‰åœ¨äº’æ–¥é‡è¢«unlock()ä¹‹åï¼Œlock()å‡½æ•°æ‰ä¼šè¢«æ‰§è¡Œã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡è®¾ç½®ä¸¤ä¸ªäº’æ–¥é”åˆ†åˆ«å¯¹secondå’Œthirdè¿›è¡Œé”å®šã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Foo</span>() &#123;</span><br><span class="line">        smx.<span class="built_in">lock</span>();</span><br><span class="line">        tmx.<span class="built_in">lock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">first</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printFirst)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// printFirst() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printFirst</span>();</span><br><span class="line">        smx.<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">second</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printSecond)</span> </span>&#123;</span><br><span class="line">        smx.<span class="built_in">lock</span>();</span><br><span class="line">        <span class="comment">// printSecond() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printSecond</span>();</span><br><span class="line">        tmx.<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">third</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printThird)</span> </span>&#123;</span><br><span class="line">        tmx.<span class="built_in">lock</span>();</span><br><span class="line">        <span class="comment">// printThird() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printThird</span>();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    mutex smx, tmx;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="ç»“æœ2"><a href="#ç»“æœ2" class="headerlink" title="ç»“æœ2"></a>ç»“æœ2</h4><p>æ‰§è¡Œç”¨æ—¶ : 40 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†31.67%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 9.2 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†100.00%çš„ç”¨æˆ·</p><p>è¿™æ¬¡çš„ç»“æœå°±å¥½äº†è®¸å¤šã€‚</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
    <category term="å¤šçº¿ç¨‹" scheme="https://hexo.chensmallx.top/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>vscodeåœ¨MacOSä¸‹æ— æ³•è°ƒè¯•C/C++è¯­è¨€ æŸ¥ç—… å’Œ è§£å†³</title>
    <link href="https://hexo.chensmallx.top/2019/08/07/vscode-debug-C-itermNternimal/"/>
    <id>https://hexo.chensmallx.top/2019/08/07/vscode-debug-C-itermNternimal/</id>
    <published>2019-08-07T09:39:21.000Z</published>
    <updated>2022-11-22T01:28:07.065Z</updated>
    
    <content type="html"><![CDATA[<p>è°ƒè¯•ï¼Œæ˜¯æ¯ä¸ªCoderå¿…é¡»è¦å…·å¤‡çš„èƒ½åŠ›ï¼Œç„¶è€Œå…·å¤‡äº†èƒ½åŠ›å´æ²¡æœ‰ç¯å¢ƒå’Œå·¥å…·çš„æ”¯æŒï¼Œé‚£å²‚ä¸æ˜¯â€œå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šâ€ï¼Ÿ<br>æˆ‘å°±é‡ä¸Šäº†è¿™æ ·â€œæ“è›‹â€çš„äº‹æƒ…ï¼Œäº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œä¸”å®¹æˆ‘æ…¢æ…¢é“æ¥ã€‚</p><span id="more"></span><h2 id="èµ·å› ã€ç¬”è¯•ä¸­æ— æ³•è°ƒè¯•0w0ï¼"><a href="#èµ·å› ã€ç¬”è¯•ä¸­æ— æ³•è°ƒè¯•0w0ï¼" class="headerlink" title="èµ·å› ã€ç¬”è¯•ä¸­æ— æ³•è°ƒè¯•0w0ï¼"></a>èµ·å› ã€ç¬”è¯•ä¸­æ— æ³•è°ƒè¯•0w0ï¼</h2><p>æ˜¨å¤©ï¼Œä¹Ÿå°±æ˜¯å¤§ç–†ç¬”è¯•ï¼Œåšä¸‰é“ç®—æ³•é¢˜çš„æ—¶å€™ï¼Œè°ƒè¯•æ²¡æ³•ç”¨äº†ï¼ˆå…¶å®æ˜¯æ—©å°±æ²¡æ³•ç”¨äº†ï¼Œåªæ˜¯ä¸€ç›´æ²¡ç®¡ï¼‰ã€‚ç„¶åå°±è®¡åˆ’ç€åšå®Œç¬”è¯•ä¹‹åæŠŠè¿™ä¸ªäº‹æƒ…æå®šäº†ï¼Œäºæ˜¯å›åˆ°å®¶å°±å¼€å§‹ä¸€ç›´googleæŸ¥æŸ¥æŸ¥ã€‚</p><h2 id="æ€€ç–‘ä¸€ï¼šgdbæ²¡æœ‰ç­¾å"><a href="#æ€€ç–‘ä¸€ï¼šgdbæ²¡æœ‰ç­¾å" class="headerlink" title="æ€€ç–‘ä¸€ï¼šgdbæ²¡æœ‰ç­¾å"></a>æ€€ç–‘ä¸€ï¼šgdbæ²¡æœ‰ç­¾å</h2><p>è¿™ä¸ªé—®é¢˜å¯å°±æ˜¯å†å²é—ç•™é—®é¢˜äº†ï¼ŒMacæŠŠgccå’Œg++é“¾æ¥åˆ°clangå’Œclang++ä¹‹åå°±èƒ½å¤Ÿæ„Ÿè§‰çš„å‡ºæ¥ï¼Œè‹¹æœå¯¹gnuè¿™äº›ä¸œè¥¿ä¸æ˜¯å¾ˆå¾…è§ã€‚</p><p>æ¯æ¬¡brewå‡çº§å®Œgdbä¹‹åï¼Œgdbçš„ä»£ç ç­¾åå°±å¤±æ•ˆäº†ï¼Œåªå¥½æ¯æ¬¡éƒ½é‡æ–°åº”ç”¨ç­¾åã€‚å¥½åœ¨ç­¾åçš„å‘½ä»¤è¿˜ç®—ç®€å•:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># gdb-code-sign keychainä¸­gdbä»£ç ç­¾åçš„åå­—</span></span><br><span class="line"><span class="comment"># /usr/local/bin/gdb gdbå‘½ä»¤çš„è½¯é“¾æ¥åœ°å€</span></span><br><span class="line">codesign -fs gdb-code-sign /usr/local/bin/gdb</span><br></pre></td></tr></table></figure><h3 id="ç”Ÿæˆç­¾åè¯ä¹¦"><a href="#ç”Ÿæˆç­¾åè¯ä¹¦" class="headerlink" title="ç”Ÿæˆç­¾åè¯ä¹¦"></a>ç”Ÿæˆç­¾åè¯ä¹¦</h3><p>ä¸è¿‡è¿˜æ˜¯è¦è¯´è¯´è¿™ä¸ª<code>gdb-code-sign</code>çš„è¿™ä¸ªcertificationè¦æ€ä¹ˆgenerateå‡ºæ¥ã€‚</p><p>è¿è¡ŒKeychan Access.appï¼Œä¹Ÿå°±æ˜¯é’¥åŒ™ä¸²ï¼Œè¿™ä¸ªä¸œè¥¿ç®¡ç†äº†è®°å½•åœ¨ç³»ç»Ÿä¸­çš„æ‰€æœ‰é’¥åŒ™ï¼ŒåŒ…æ‹¬wifiå¯†ç ï¼Œç½‘ç»œè¯ä¹¦ç­‰ç­‰ï¼Œåªè¦æœ‰ç³»ç»Ÿç®¡ç†å‘˜çš„å¯†ç å°±å¯ä»¥éšæ„æŸ¥çœ‹ï¼ˆchromeé‡Œå¤´è®°å½•çš„å¯†ç çœ‹ä¸åˆ°ï¼Œå› ä¸ºchromeä¸æŠŠå®ƒä»¬è®°å½•åœ¨ç³»ç»Ÿä¸­ï¼Œä½†æ˜¯Safariçš„å¯ä»¥ï¼‰ã€‚</p><p><img src="/../img/keychain.png" alt="Keychain Access.app"></p><p>é€‰æ‹© Keychain Access -&gt; Certificate Assistant -&gt; Create a Certifitateâ€¦ï¼Œåœ¨åå­—å¤„å–ä¸€ä¸ªè‡ªå·±èƒ½å¤Ÿåˆ†è¾¨çš„åå­—ï¼Œç„¶åé€‰æ‹©ä»£ç ç­¾å(Code sign)ï¼Œåœ¨Mojaveç‰ˆæœ¬çš„MacOSä¸­å°±åªè¦ç‚¹å‡»ç¡®å®šä¸¤ä¸‹å°±å¯ä»¥ç”Ÿæˆäº†ã€‚</p><p><img src="/../img/gdb-code-sign.png" alt="Create Certificate"></p><p>ç”Ÿæˆè¯ä¹¦ä¹‹åï¼Œè®²ç”Ÿæˆçš„ä¸‰ä¸ªåŒåé¡¹ç›®å…¨éƒ½ç§»åˆ°Systemç›®å½•ä¸‹ï¼Œåˆ†åˆ«æ˜¯è¯ä¹¦(Self-signed Certificate)ã€å…¬é’¥(Public Key)å’Œç§é’¥(Private Key)ã€‚</p><p>æ¥ç€åŒå‡»ç”Ÿæˆçš„è¯ä¹¦ï¼Œå°†ä¿¡ä»»ä¸€æ æ”¹ä¸ºä»»ä½•æ—¶å€™éƒ½ä¿¡ä»»ã€‚</p><p><img src="/../img/gdb-code-sign-trust.png" alt="Trust the Certificate"></p><p>è¿™æ—¶å€™å°±å¯ä»¥å…³é—­Keychainäº†ã€‚</p><h3 id="ç»™gdbåº”ç”¨ç­¾å"><a href="#ç»™gdbåº”ç”¨ç­¾å" class="headerlink" title="ç»™gdbåº”ç”¨ç­¾å"></a>ç»™gdbåº”ç”¨ç­¾å</h3><p>æ¥ç€æ‰“å¼€ç»ˆç«¯ï¼Œä½¿ç”¨<code>sudo -i</code>è¿›å…¥rootæƒé™ã€‚</p><p>æˆ‘ä¸€å¼€å§‹ä½¿ç”¨çš„æ˜¯ä¸Šé¢çš„é‚£æ¡å‘½ä»¤ï¼Œä½†æ˜¯æ€ä¹ˆéƒ½ç­¾ä¸å¥½ï¼Œå¼€å§‹è°ƒè¯•ä¹‹åéƒ½æ˜¾ç¤º(ä¾‹å¦‚æˆ‘è°ƒè¯•ä¸€ä¸ªå«åšsleepçš„ç¨‹åº)ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(gdb) r</span><br><span class="line">Starting program: /Users/chenke/Documents/ProgramerMaker/C:C++/C/test/sleep</span><br><span class="line">Unable to find Mach task port for process-id 65245: (os/kern) failure (0x5).</span><br><span class="line"> (please check gdb is codesigned - see taskgated(8))</span><br></pre></td></tr></table></figure><p>åªå¥½åˆå»æŸ¥ã€‚å‘ç°æœ‰ä¸¤ä¸ªè§£å†³åŠæ³•ï¼š</p><ol><li>è¿è¡Œgdbçš„æ—¶å€™ä½¿ç”¨<code>sudo gdb xxx.out</code></li><li>åœ¨Mojaveé‡Œå¤´éœ€è¦é™„åŠ ä¸€ä¸ªxmlçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”ç­¾åçš„å‘½ä»¤ä¹Ÿè¦åšå‡ºä¸€äº›æ”¹åŠ¨ã€‚</li></ol><p>å› ä¸ºåé¢è¦ç»™vscodeç”¨çš„è°ƒè¯•å™¨ï¼Œæ€»ä¸èƒ½æ¯æ¬¡è°ƒè¯•éƒ½è¾“ä¸€æ¬¡å¯†ç å§ã€‚æ‰€ä»¥ä¸è¡Œï¼Œå¾—ä¸€åŠ³æ°¸é€¸ã€‚æ‰€ä»¥è¿›è¡Œç¬¬äºŒä¸ªè§£å†³åŠæ³•ã€‚</p><p>å°†ä¸€ä¸ªæ–‡ä»¶å‘½åä¸ºgdb.xmlæˆ–è€…åˆ«çš„ä»€ä¹ˆéƒ½å¯ä»¥ï¼Œç„¶åå†™å…¥ä¸‹é¢çš„å†…å®¹ï¼Œç„¶åä¿å­˜ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">plist</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.security.cs.debugger<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æœ¬ç›®å½•ä¸‹ï¼Œä½¿ç”¨rootæƒé™ï¼Œé‡æ–°è¿è¡Œç­¾åå‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codesign --entitlements gdb.xml -fs gdb-code-sign /usr/local/bin/gdb</span><br></pre></td></tr></table></figure><p>ç­¾åå®Œäº†ä¹‹åï¼Œå†è¿è¡Œgdbè°ƒè¯•ï¼Œè¿™å›å°±å¥½äº†ä¸€äº›äº†ï¼Œå¯ä»¥runï¼Œä½†æ˜¯ä¼šå¡ä½ã€‚ã€‚ã€‚æ˜¾ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(gdb) r</span><br><span class="line">Starting program: /Users/chenke/Documents/ProgramerMaker/C:C++/C/test/sleep</span><br><span class="line">[New Thread 0xd03 of process 65791]</span><br><span class="line">[New Thread 0xf03 of process 65791]</span><br></pre></td></tr></table></figure><p>å¦‚æœgdbèƒ½ç”¨äº†ï¼Œä½†æ˜¯å› ä¸ºä»€ä¹ˆåŸå› å¯¼è‡´è°ƒè¯•æ— æ³•è¿›è¡Œï¼Œè¿™å°±å¾ˆéš¾å—ã€‚æ‰€ä»¥å°±æ”¾å¼ƒgdbäº†â€¦</p><h2 id="æŠ˜è…¾lldb"><a href="#æŠ˜è…¾lldb" class="headerlink" title="æŠ˜è…¾lldb"></a>æŠ˜è…¾lldb</h2><p>é‡æ–°ç»™lldbç­¾åä¹‹åï¼Œå‘ç°lldbèƒ½ç”¨ï¼Œè€Œä¸”è·‘çš„å¾ˆæ¬¢å—ï¼Œå¹¶ä¸”å¾ˆå¼€å¿ƒçš„ä¸€ç‚¹å°±æ˜¯ï¼Œæ— è®ºæ˜¯ç”¨gccè¿˜æ˜¯clangï¼Œè¿˜æ˜¯g++æˆ–æ˜¯clang++ç¼–è¯‘çš„æ–‡ä»¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨lldbè°ƒè¯•ï¼Œè¿™ä¹Ÿåœ¨ä¹‹åçš„ç¼–è¯‘å·¥å…·çš„é€‰æ‹©ä¸Šç»™å‡ºäº†å¤šä¸ªé€‰é¡¹ã€‚</p><h2 id="æ€€ç–‘äºŒï¼švscodeæ²¡æœ‰é…ç½®å¥½"><a href="#æ€€ç–‘äºŒï¼švscodeæ²¡æœ‰é…ç½®å¥½" class="headerlink" title="æ€€ç–‘äºŒï¼švscodeæ²¡æœ‰é…ç½®å¥½"></a>æ€€ç–‘äºŒï¼švscodeæ²¡æœ‰é…ç½®å¥½</h2><p>å…¶å®åˆ°äº†è¿™é‡Œï¼Œæˆ‘å°±æœ‰ç‚¹è™šäº†ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶ä¸€ç›´éƒ½æ˜¯ä¸€å¥—çš„ï¼Œä¸åº”è¯¥å­˜åœ¨ä»¥å‰èƒ½ç”¨ä½†æ˜¯ç°åœ¨ä¸èƒ½ç”¨çš„æƒ…å†µï¼Œæ¯•ç«Ÿå¾®è½¯çš„ä¸œè¥¿ä¸èƒ½è¯´ä¸å‘åå…¼å®¹å§- -ï¼</p><p>ç»è¿‡ä¸€ç•ªæŸ¥æ‰¾ä¹‹åï¼Œå‘ç°æœ€æ–°çš„é…ç½®æ–‡ä»¶ç‰ˆæœ¬å·²ç»åˆ°äº†2.0.0ï¼Œè€Œæˆ‘è¿˜åœ¨ç”¨0.2.0ï¼Œå“ˆå“ˆï¼Œæ‰€ä»¥è¯´è¿˜æ˜¯è¿‡æ—¶äº†ã€æ‰‹åŠ¨æ‚è„¸ã€‚ä¸è¿‡æ€ä¹ˆè¯´ï¼Œå°±ç®—æ˜¯è¿‡æ—¶ï¼Œé‚£ä¹Ÿä¸åº”è¯¥è®©ç¼–è¯‘å’Œè¿è¡Œå‡ºé”™å‘€ã€‚</p><p>ç»è¿‡äº†ä¸€ç•ªä¿®æ”¹ï¼Œç»ˆäºå°†vscodeçš„è¿è¡Œé…ç½®æ›´æ–°äº†ä¸€éã€‚Cå’ŒC++ä¸¤å¥—é…ç½®å› ä¸ºè¦è°ƒç”¨ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œç¼–è¯‘å‘½ä»¤ä¹Ÿä¸åŒï¼Œæ‰€ä»¥å¾—åˆ†æˆä¸¤å—ï¼ŒCç”¨gccæˆ–è€…clangæˆ–è€…llvm-gccæ¥ç¼–è¯‘ï¼ŒC++ç”¨g++æˆ–è€…clang++æˆ–è€…llvm-g++æ¥ç¼–è¯‘ã€‚</p><h3 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">    <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">    <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;preLaunchTask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build c&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Launch C&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppdbg&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;stopAtEntry&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;environment&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;externalConsole&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lldb&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡è¿™é¡¿æŠ˜è…¾ï¼Œæˆ‘ä¹Ÿç†è§£äº†ä¸€äº›å…¶ä¸­çš„å‚æ•°çš„æ„ä¹‰æ‰€åœ¨ï¼Œå°±æ¯”å¦‚ï¼š</p><ul><li>preLaunchTask</li></ul><blockquote><p>è¿è¡Œè°ƒè¯•ä»»åŠ¡å‰éœ€è¦è¿è¡Œçš„ä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡è¦åœ¨tasks.jsonä¸­é…ç½®ï¼Œè€Œè¿™é‡Œå¡«å†™çš„å°±æ˜¯åå­—ï¼Œæˆ–è€…æ ‡ç­¾ç­‰æ ‡è¯†è¿™ä¸ªtaskç”¨çš„å±æ€§ã€‚</p></blockquote><ul><li>program</li></ul><blockquote><p>è¦è¿è¡Œçš„ç¨‹åºçš„åå­—ï¼Œè¿™ä¸ªå’Œtasks.jsonä¸­ç¼–è¯‘é€‰é¡¹ä¸­çš„æ–‡ä»¶è·¯å¾„æ˜¯å¯¹åº”çš„ï¼Œå¿…é¡»ç›¸åŒï¼Œä¸ç„¶vscodeå°±æ— æ³•æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶æ¥è¿è¡Œã€‚</p></blockquote><ul><li>args</li></ul><blockquote><p>è¿è¡Œè°ƒè¯•çš„å‚æ•°ï¼Œä¼šç›´æ¥ä¼ å…¥lldbæˆ–è€…gdbçš„ã€‚</p></blockquote><ul><li>stopAtEntry</li></ul><blockquote><p>å­—é¢æ„æ€ï¼Œåœ¨è°ƒè¯•çš„æ—¶å€™ä¼šåœ¨å…¥å£å¤„æš‚åœï¼Œç‚¹å‡»ç»§ç»­æ‰ä¼šå¼€å§‹è°ƒè¯•ï¼Œä¾‹å¦‚C&#x2F;C++ä¸­çš„mainå‡½æ•°ï¼Œæˆ–è€…Pythonä¸­çš„ç¬¬ä¸€æ¡è¯­å¥ï¼Œæˆ–è€…Golangä¸­çš„ func main()</p></blockquote><ul><li>externalConsole</li></ul><blockquote><p>å¤–éƒ¨çš„æ§åˆ¶å°ï¼Œè¿™ä¸ªæˆ‘æ˜¯å¯ç”¨çš„ï¼Œå› ä¸ºå¦‚æœä¸å¯ç”¨çš„è¯ï¼Œåœ¨vscodeè‡ªå¸¦çš„DEBUG CONSOLEä¸­åªèƒ½è¾“å‡ºç¨‹åºä¿¡æ¯ï¼Œä¸èƒ½è¾“å…¥ï¼ˆæˆ–è®¸æ˜¯æœ‰åŠæ³•çš„ï¼Œä½†æ˜¯æˆ‘ä¸ä¼šè€Œå·²å“ˆå“ˆå“ˆï¼‰ã€‚åœ¨è°ƒè¯•ç¨‹åºçš„æ—¶å€™è‚¯å®šä¼šéœ€è¦ä¸€äº›äº¤äº’ï¼Œæ‰€ä»¥è¿™ä¸ªè¿˜æ˜¯è¦æ‰“å¼€çš„ã€‚</p></blockquote><ul><li>MIMode</li></ul><blockquote><p>è°ƒè¯•æ¨¡å¼ï¼Œè¿™é‡Œé€‰æ‹©çš„å°±æ˜¯è°ƒè¯•å™¨çš„ç§ç±»ï¼Œé€‰æ‹©<code>lldb</code>æˆ–è€…æ˜¯<code>gdb</code>ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯lldbï¼Œå› ä¸ºç¼–è¯‘å·²ç»å¯ä»¥ç”¨gccçš„ä¼˜åŒ–äº†ï¼Œè€Œåœ¨MacOSä¸Šç”¨lldbä¼šæ›´åŠ çš„çš„å¿ƒåº”æ‰‹ä¸€äº›ï¼Œæ¯•ç«Ÿä¹Ÿç®—æ˜¯ç³»ç»Ÿçº§çš„â€œäº²å„¿å­â€ã€‚</p></blockquote><h3 id="tasks-json"><a href="#tasks-json" class="headerlink" title="tasks.json"></a>tasks.json</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build c&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shell&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gcc-9&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;$&#123;workspaceFolder&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="comment">// &quot;-std=c++17&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;presentation&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;echo&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;focus&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;panel&quot;</span><span class="punctuation">:</span><span class="string">&quot;shared&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;showReuseMessage&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;clear&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;reveal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;silent&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>command</li></ul><blockquote><p>ç¼–è¯‘ä½¿ç”¨çš„å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯ç¼–è¯‘å™¨ï¼Œè¿™é‡Œè¦æ ¹æ®éœ€æ±‚æ”¹å˜ç¼–è¯‘å™¨çš„é€‰æ‹©ï¼Œä¾‹å¦‚gccï¼Œg++ï¼Œclangï¼Œclang++ï¼Œllvm-gccï¼Œllvm-g++è¿™äº›ã€‚</p></blockquote><ul><li>args</li></ul><blockquote><p>ç¼–è¯‘é€‰é¡¹ï¼Œè¿™é‡Œå¤´çš„é€‰é¡¹è¦æŒ‰ç…§é¡ºåºæ¥è¾“å…¥ï¼Œä¾‹å¦‚ç¼–è¯‘ä¸€ä¸ªcæ–‡ä»¶æ˜¯è¦ç”¨åˆ°<code>gcc sleep.c -o sleep -g -std=c11</code>ï¼Œé‚£ä¹ˆargsé‡Œé¢çš„é¡ºåºå°±æ˜¯è¦æŒ‰ç…§è¿™æ ·æ¥å¡«å†™ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">   <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="string">&quot;$&#123;workspaceFolder&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="string">&quot;-std=c11&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span>```</span><br><span class="line"></span><br><span class="line">### c_cpp_properties.json</span><br><span class="line"></span><br><span class="line">è™½ç„¶è¿™ä¸ªæ–‡ä»¶å¯¹ç¼–è¯‘è°ƒè¯•ä¸ä¼šé€ æˆä»€ä¹ˆå½±å“ï¼Œä½†æ˜¯ä¹Ÿæ”¾ä¸Šæ¥ä½œä¸ºå‚è€ƒã€‚è¿™ä¸ªc_cpp_propertiesæ˜¯å¯¹vscodeçš„è‡ªåŠ¨è¡¥å…¨æœ‰å½±å“ï¼Œå®ƒä¼šæ ¹æ®ç³»ç»Ÿç±»å‹å»é€‰æ‹©è¦å¼•ç”¨çš„ä½ç½®çš„æ–‡ä»¶ï¼Œå¹¶æ£€æµ‹è”æƒ³å‡ºæ¥çš„ç»“æœã€‚</span><br><span class="line"></span><br><span class="line">```json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">       <span class="punctuation">&#123;</span></span><br><span class="line">           <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Mac&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;/usr/local/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include&quot;</span></span><br><span class="line">           <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;clang-x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;browse&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">               <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                   <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;/usr/local/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.1/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include&quot;</span></span><br><span class="line">               <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">               <span class="attr">&quot;limitSymbolsToIncludedHeaders&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">               <span class="attr">&quot;databaseFilename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">           <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;macFrameworkPath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="string">&quot;/System/Library/Frameworks&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;/Library/Frameworks&quot;</span></span><br><span class="line">           <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/clang&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c11&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++17&quot;</span></span><br><span class="line">       <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="punctuation">&#123;</span></span><br><span class="line">           <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Linux&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="string">&quot;/usr/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;/usr/local/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">           <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;clang-x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;browse&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">               <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                   <span class="string">&quot;/usr/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;/usr/local/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">               <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">               <span class="attr">&quot;limitSymbolsToIncludedHeaders&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">               <span class="attr">&quot;databaseFilename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">           <span class="punctuation">&#125;</span></span><br><span class="line">       <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="punctuation">&#123;</span></span><br><span class="line">           <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Win32&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="string">&quot;C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/include&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">           <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="string">&quot;_DEBUG&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;UNICODE&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="string">&quot;_UNICODE&quot;</span></span><br><span class="line">           <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;msvc-x64&quot;</span><span class="punctuation">,</span></span><br><span class="line">           <span class="attr">&quot;browse&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">               <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                   <span class="string">&quot;C:/Program Files (x86)/Microsoft Visual Studio 14.0/VC/include/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">               <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">               <span class="attr">&quot;limitSymbolsToIncludedHeaders&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">               <span class="attr">&quot;databaseFilename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">           <span class="punctuation">&#125;</span></span><br><span class="line">       <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></blockquote><p>åˆ°äº†è¿™ä¸€æ­¥è¿˜æ˜¯ä¸è¡Œï¼Œä½¿ç”¨vscodeè¿è¡Œè°ƒè¯•çš„æ—¶å€™ï¼Œè°ƒè¯•æ§åˆ¶å™¨å°èƒ½å¤Ÿæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œä½†æ˜¯è°ƒç”¨çš„Terminal.appç»ˆç«¯å´æ²¡æœ‰ç¨‹åºè¿è¡Œçš„ä¿¡æ¯ï¼Œä¹Ÿæ— æ³•è¾“å…¥å˜é‡ã€‚</p><h2 id="æœ€ç»ˆå‘ç°æ˜¯ç»ˆç«¯æ¨¡æ‹Ÿå™¨ç¨‹åºçš„é—®é¢˜"><a href="#æœ€ç»ˆå‘ç°æ˜¯ç»ˆç«¯æ¨¡æ‹Ÿå™¨ç¨‹åºçš„é—®é¢˜" class="headerlink" title="æœ€ç»ˆå‘ç°æ˜¯ç»ˆç«¯æ¨¡æ‹Ÿå™¨ç¨‹åºçš„é—®é¢˜"></a>æœ€ç»ˆå‘ç°æ˜¯ç»ˆç«¯æ¨¡æ‹Ÿå™¨ç¨‹åºçš„é—®é¢˜</h2><p>åœ¨æŸä¸ªå¶ç„¶ï¼Œæˆ‘å‘ç°æˆ‘æŠŠ<strong>iTermå…³äº†</strong>ä¹‹åï¼ŒTerminalå°±èƒ½å¤Ÿæ‰¿è½½è°ƒè¯•çš„ç¨‹åºäº†ï¼Œå¹¶ä¸”åœ¨é‡æ–°å¼€å¯iTermä¹‹åï¼Œè¿˜æ˜¯ä¸€æ ·å¯ä»¥è°ƒè¯•ã€‚</p><p><img src="/../img/vscode-debug-c++.png" alt="debug success"></p><h3 id="è§£å†³åŠæ³•v1-0"><a href="#è§£å†³åŠæ³•v1-0" class="headerlink" title="è§£å†³åŠæ³•v1.0"></a>è§£å†³åŠæ³•v1.0</h3><p>ï¼ˆé‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼‰</p><blockquote><p>å…³é—­iTermç­‰ç¬¬ä¸‰æ–¹ç»ˆç«¯<br>å…³é—­iTermç­‰ç¬¬ä¸‰æ–¹ç»ˆç«¯<br>å…³é—­iTermç­‰ç¬¬ä¸‰æ–¹ç»ˆç«¯</p></blockquote><p>è™½ç„¶é—®é¢˜è§£å†³äº†ï¼ˆå¯ä»¥åœ¨vscodeä¸Šæ„‰å¿«çš„è°ƒè¯•äº†ï¼Œå¹¶ä¸”å¯ä»¥è¾“å…¥è¾“å‡ºå˜é‡å’Œç»“æœï¼‰ï¼Œä½†æ˜¯è®©æˆ‘è¿˜æ˜¯æœ‰ç‚¹åŒªå¤·æ‰€æ€ï¼Œå†³å®šç»§ç»­è¿½æŸ¥ä¸‹å»ã€‚</p><p>æˆ‘åœ¨vscodeä¸­çœ‹åˆ°ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼š<code>&quot;terminal.external.osxExec&quot;: &quot;iTerm.app&quot;</code>è¿™é‡ŒåŸå…ˆçš„å€¼æ˜¯Terminal.appï¼Œåæ¥æˆ‘å‘ç°ä¹‹åï¼Œæ ¹æ®å­—é¢æ„æ€ï¼Œæ„æ€å°±æ˜¯å¤–éƒ¨ç»ˆç«¯è°ƒç”¨çš„æ˜¯å“ªä¸ªç¨‹åºï¼Œç´¢æ€§æˆ‘æ”¹æˆäº†iTerm.appã€‚</p><p>æ”¹æˆiTerm.appä¹‹åï¼Œæˆ‘æŠŠiTermå…³äº†ï¼Œå‡†å¤‡è®©vscodeè‡ªåŠ¨è°ƒç”¨æ‰“å¼€iTermè¿è¡Œç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘å‘ç°ç³»ç»Ÿå¼¹å‡ºäº†ä¸€ä¸ªè¾…åŠ©æ§åˆ¶çš„çª—å£æ˜¾ç¤ºâ€œæ˜¯å¦å…è®¸iTermæ§åˆ¶Terminalâ€ï¼Œæˆ‘é€‰äº†â€œNot Allowâ€ã€‚é€‰äº†ä¹‹åï¼Œç³»ç»Ÿè°ƒç”¨å‡ºæ¥çš„è¿˜æ˜¯Terminal.appï¼Œå¹¶ä¸”ä¸Šé¢å˜æˆäº†ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·ã€‚</p><p>ä¸ºäº†åšä¸ªå¯¹æ¯”ï¼Œæˆ‘ç‰¹æ„å»è£…äº†ä¸ªHyperç»ˆç«¯ï¼ˆåæ¥è«åå‘ç°è¿™ä¸œè¥¿é¢œå€¼é«˜åˆå¥½ç”¨é™¤äº†æœ‰ç‚¹ä¸ç¨³å®šï¼‰ï¼Œç„¶åå°†<code>terminal.external.osxExec</code>æ”¹ä¸ºHyper.appï¼ŒåŒæ ·çš„ï¼Œåœ¨è¿è¡Œè°ƒè¯•çš„æ—¶å€™ï¼Œå’Œä¹‹å‰ä¸€æ ·å¼¹å‡ºäº†çª—å£ï¼Œæˆ‘é€‰æ‹©äº†Allowã€‚è¿™æ¬¡å’Œç›¸åŒçš„æ˜¯ï¼Œå¼¹å‡ºæ¥çš„è¿˜æ˜¯Terminal.appï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯å¯ä»¥è¾“å…¥è¾“å‡ºäº†ï¼è¿™è®©æˆ‘reallyå¼€å¿ƒã€‚</p><p>äºæ˜¯ä¹ï¼Œæˆ‘æ¥åˆ°è¾…åŠ©åŠŸèƒ½è¿™é‡Œä¸€æ¢ç©¶ç«Ÿï¼š<br>System Preferences -&gt; Security &amp; Privacy -&gt; Privacy -&gt; Automation</p><p>ç»ˆäºè®©æˆ‘â€œç›²ç”Ÿâ€å‘ç°äº†â€œåç‚¹â€ï¼š</p><p><img src="/../img/system-privacy.png" alt="Automation setting"></p><h3 id="è§£å†³åŠæ³•v2-0"><a href="#è§£å†³åŠæ³•v2-0" class="headerlink" title="è§£å†³åŠæ³•v2.0"></a>è§£å†³åŠæ³•v2.0</h3><p>åœ¨æ‰“å¼€iTerm.appä¸‹é¢å¯¹Terminal.appçš„è‡ªåŠ¨æ§åˆ¶ä¹‹åï¼Œå†å°†<code>terminal.external.osxExec</code>æ”¹ä¸ºiTermçš„æ—¶å€™ï¼ŒåŒæ ·çš„ï¼Œä¹Ÿèƒ½è¿›è¡Œæ­£å¸¸çš„è°ƒè¯•äº†ã€‚</p><p>æˆ‘çš„ç†è§£æ˜¯ï¼Œç³»ç»Ÿæ²¡æœ‰å…è®¸iTermå»æ§åˆ¶Terminalï¼Œä½†æ˜¯vscodeè°ƒç”¨äº†iTermå¹¶ä¸”æƒé™ä¸‹æ”¾çš„ä¸å¤Ÿå¤šï¼Œæ‰€ä»¥å°±æ²¡æ³•ä½¿å¾—Terminalâ€œæ¥ä½â€è¿™ä¸ªè°ƒè¯•ä»»åŠ¡ï¼ˆå¯èƒ½æ˜¯è¢«ç³»ç»Ÿæ‹¦æˆªäº†ï¼‰ï¼Œæ‰€ä»¥å°±ä»€ä¹ˆéƒ½çœ‹ä¸åˆ°ã€‚</p><p>è¿˜æƒ³åæ§½çš„æ˜¯ï¼Œå¾®è½¯çš„è¿™ä¸ª<code>terminal.external.osxExec</code>ç®€ç›´å°±æ˜¯æ‘†è®¾ï¼Œè®¾ç½®äº†ä¹Ÿæ²¡æ³•æ›´æ¢è°ƒè¯•ç”¨çš„ç»ˆç«¯ï¼Œå¹¶ä¸”è¿˜ä¼šå¯¼è‡´è¿™ç§ç„å¦™çš„æƒé™é—®é¢˜ã€‚</p><hr><p>æœ‰æœºä¼šå†è¯´è¯´Hyperçš„å®‰è£…å’Œè®¾ç½®ï¼Œå˜¿å˜¿ï¼Œè¿˜æŒºæœ‰æ„æ€çš„~</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;è°ƒè¯•ï¼Œæ˜¯æ¯ä¸ªCoderå¿…é¡»è¦å…·å¤‡çš„èƒ½åŠ›ï¼Œç„¶è€Œå…·å¤‡äº†èƒ½åŠ›å´æ²¡æœ‰ç¯å¢ƒå’Œå·¥å…·çš„æ”¯æŒï¼Œé‚£å²‚ä¸æ˜¯â€œå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šâ€ï¼Ÿ&lt;br&gt;æˆ‘å°±é‡ä¸Šäº†è¿™æ ·â€œæ“è›‹â€çš„äº‹æƒ…ï¼Œäº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œä¸”å®¹æˆ‘æ…¢æ…¢é“æ¥ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="MacOSX" scheme="https://hexo.chensmallx.top/tags/MacOSX/"/>
    
    <category term="vscode" scheme="https://hexo.chensmallx.top/tags/vscode/"/>
    
    <category term="C/C++" scheme="https://hexo.chensmallx.top/tags/C-C/"/>
    
    <category term="debug" scheme="https://hexo.chensmallx.top/tags/debug/"/>
    
    <category term="gcc" scheme="https://hexo.chensmallx.top/tags/gcc/"/>
    
    <category term="clang" scheme="https://hexo.chensmallx.top/tags/clang/"/>
    
    <category term="gdb" scheme="https://hexo.chensmallx.top/tags/gdb/"/>
    
    <category term="lldb" scheme="https://hexo.chensmallx.top/tags/lldb/"/>
    
    <category term="code sign" scheme="https://hexo.chensmallx.top/tags/code-sign/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®° 33.æœç´¢æ—‹è½¬æ’åºæ•°ç»„</title>
    <link href="https://hexo.chensmallx.top/2019/08/01/leetcode-33-search/"/>
    <id>https://hexo.chensmallx.top/2019/08/01/leetcode-33-search/</id>
    <published>2019-08-01T11:10:32.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>å‡è®¾æŒ‰ç…§å‡åºæ’åºçš„æ•°ç»„åœ¨é¢„å…ˆæœªçŸ¥çš„æŸä¸ªç‚¹ä¸Šè¿›è¡Œäº†æ—‹è½¬ã€‚</p><p>( ä¾‹å¦‚ï¼Œæ•°ç»„Â [0,1,2,4,5,6,7]Â å¯èƒ½å˜ä¸ºÂ [4,5,6,7,0,1,2]Â )ã€‚</p><p>æœç´¢ä¸€ä¸ªç»™å®šçš„ç›®æ ‡å€¼ï¼Œå¦‚æœæ•°ç»„ä¸­å­˜åœ¨è¿™ä¸ªç›®æ ‡å€¼ï¼Œåˆ™è¿”å›å®ƒçš„ç´¢å¼•ï¼Œå¦åˆ™è¿”å›Â -1Â ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­ä¸å­˜åœ¨é‡å¤çš„å…ƒç´ ã€‚</p><p>ä½ çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦å¿…é¡»æ˜¯Â O(logÂ n) çº§åˆ«ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: nums &#x3D; [4,5,6,7,0,1,2], target &#x3D; 0<br>è¾“å‡º: 4</p></blockquote><p>ç¤ºä¾‹Â 2:</p><blockquote><p>è¾“å…¥: nums &#x3D; [4,5,6,7,0,1,2], target &#x3D; 3<br>è¾“å‡º: -1</p></blockquote><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/search-in-rotated-sorted-array">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>è¿™é“é¢˜å¯ä»¥ç›´æ¥ç”¨äºŒåˆ†æ³•è§£å†³ï¼Œä½†æ˜¯è¿™ä¸ªäºŒåˆ†æ³•éœ€è¦é­”æ”¹å·¦å³è¾¹ç•Œè¿­ä»£çš„åˆ¤æ–­ã€‚è€Œè¿™ä¸ªé­”æ”¹çš„æ€æƒ³ï¼Œæœ‰ç‚¹ç±»ä¼¼åè¯æ³•ã€‚</p><p>åœ¨è¿›è¡ŒäºŒåˆ†æ³•çš„æ—¶å€™ï¼Œæ•°ç»„çš„åè½¬ç‚¹æˆ–è®¸åœ¨ä¸­ç‚¹çš„å·¦è¾¹æˆ–è€…å³è¾¹ï¼Œè¿™è®©æˆ‘ä»¬å¯¹æ•°æ®ä½ç½®çš„ç¡®å®šä¼šäº§ç”Ÿä¸€äº›å›°éš¾ã€‚</p><p>è¿™æ—¶å€™å°±éœ€è¦æ¢ä¸ªæ€è·¯ï¼Œä¾‹å¦‚ï¼š<br>æˆ‘ä»¬å¯ä»¥ç¡®å®šå·¦è¾¹æˆ–è€…å³è¾¹ä¸­çš„æŸä¸€è¾¹æ˜¯è‚¯å®šæŒ‰ç…§é¡ºåºæ’åˆ—çš„ï¼Œå¦‚æœç›®æ ‡åœ¨è¿™ä¸ªæŒ‰ç…§é¡ºåºçš„ä¸ªåŒºé—´å†…ï¼Œåˆ™å°†äºŒåˆ†æŸ¥æ‰¾åŒºåŸŸæ”¾åˆ°è¿™è¾¹ï¼›<br>åä¹‹æ‰€æœ‰çš„æƒ…å†µéƒ½æ˜¯åœ¨å¦ä¸€è¾¹ï¼Œæˆ‘ä»¬ä¹Ÿå°†äºŒåˆ†æŸ¥æ‰¾åŒºåŸŸæ”¾åˆ°è¿™å¦ä¸€è¾¹ï¼Œè¿™æ ·ä¸æ–­è¿›è¡Œä¸‹å»ï¼Œå°±ä¼šä¸æ–­çš„æ— è§†è¿™ä¸ªç¿»è½¬ç‚¹è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> left = <span class="number">0</span>, right = nums.<span class="built_in">size</span>() - <span class="number">1</span>, mid;</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">            mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] == target) <span class="keyword">return</span> mid;</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &lt; nums[right]) &#123; <span class="comment">// pivot in left</span></span><br><span class="line">                <span class="keyword">if</span> (target &gt; nums[mid] &amp;&amp; target &lt;= nums[right]) left = mid+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> right = mid<span class="number">-1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// pivot in right</span></span><br><span class="line">                <span class="keyword">if</span> (target &lt; nums[mid] &amp;&amp; target &gt;= nums[left]) right = mid<span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">else</span> left = mid+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><p>æ‰§è¡Œç”¨æ—¶ : 4 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†92.20%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 8.5 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†98.16%çš„ç”¨æˆ·</p>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
    <category term="äºŒåˆ†æŸ¥æ‰¾" scheme="https://hexo.chensmallx.top/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/"/>
    
  </entry>
  
  <entry>
    <title>leetcodeé¢˜è®° 26.åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</title>
    <link href="https://hexo.chensmallx.top/2019/08/01/leetcode-26-removeDuplicates/"/>
    <id>https://hexo.chensmallx.top/2019/08/01/leetcode-26-removeDuplicates/</id>
    <published>2019-08-01T07:16:59.000Z</published>
    <updated>2022-11-22T01:28:07.061Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>ç»™å®šä¸€ä¸ªæ’åºæ•°ç»„ï¼Œä½ éœ€è¦åœ¨åŸåœ°åˆ é™¤é‡å¤å‡ºç°çš„å…ƒç´ ï¼Œä½¿å¾—æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ï¼Œè¿”å›ç§»é™¤åæ•°ç»„çš„æ–°é•¿åº¦ã€‚</p><p>ä¸è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œä½ å¿…é¡»åœ¨åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„å¹¶åœ¨ä½¿ç”¨ O(1) é¢å¤–ç©ºé—´çš„æ¡ä»¶ä¸‹å®Œæˆã€‚</p><p>ç¤ºä¾‹Â 1:</p><blockquote><p>ç»™å®šæ•°ç»„ nums &#x3D; [1,1,2],<br>å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 2, å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰ä¸¤ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 1, 2ã€‚<br>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><p>ç¤ºä¾‹Â 2:</p><blockquote><p>ç»™å®š nums &#x3D; [0,0,1,1,1,2,2,3,3,4],<br>å‡½æ•°åº”è¯¥è¿”å›æ–°çš„é•¿åº¦ 5, å¹¶ä¸”åŸæ•°ç»„ nums çš„å‰äº”ä¸ªå…ƒç´ è¢«ä¿®æ”¹ä¸º 0, 1, 2, 3, 4ã€‚<br>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><p>è¯´æ˜:</p><p>ä¸ºä»€ä¹ˆè¿”å›æ•°å€¼æ˜¯æ•´æ•°ï¼Œä½†è¾“å‡ºçš„ç­”æ¡ˆæ˜¯æ•°ç»„å‘¢?</p><p>è¯·æ³¨æ„ï¼Œè¾“å…¥æ•°ç»„æ˜¯ä»¥â€œå¼•ç”¨â€æ–¹å¼ä¼ é€’çš„ï¼Œè¿™æ„å‘³ç€åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚</p><p>ä½ å¯ä»¥æƒ³è±¡å†…éƒ¨æ“ä½œå¦‚ä¸‹:</p><blockquote><p>&#x2F;&#x2F; nums æ˜¯ä»¥â€œå¼•ç”¨â€æ–¹å¼ä¼ é€’çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯¹å®å‚åšä»»ä½•æ‹·è´<br><code>int len = removeDuplicates(nums);</code></p></blockquote><blockquote><p>&#x2F;&#x2F; åœ¨å‡½æ•°é‡Œä¿®æ”¹è¾“å…¥æ•°ç»„å¯¹äºè°ƒç”¨è€…æ˜¯å¯è§çš„ã€‚<br>&#x2F;&#x2F; æ ¹æ®ä½ çš„å‡½æ•°è¿”å›çš„é•¿åº¦, å®ƒä¼šæ‰“å°å‡ºæ•°ç»„ä¸­è¯¥é•¿åº¦èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ ã€‚<br><code>for (int i = 0; i &lt; len; i++) &#123; print(nums[i]); </code></p></blockquote><p>æ¥æºï¼š<a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-array">åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a></p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><p>åšäº†è¿™é¢˜æ‰å‘ç°è‡ªå·±æ˜¯naiveã€‚<br>ä¸€å¼€å§‹åªæƒ³åˆ°äº†éå†ï¼Œéå†åˆ°å’Œä¹‹å‰ä¸€æ ·çš„å…ƒç´ çš„æ—¶å€™ç›´æ¥å°†æ•°ç»„ä¸­çš„å…ƒç´ åˆ é™¤æ‰å°±å®Œäº‹å„¿äº†ï¼Œç»“æœå‡ºæ¥ä¹‹åçš„ç»“æœæƒ¨ä¸å¿ç¹ã€‚</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ :264 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†15.21%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 9.9 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†78.41%çš„ç”¨æˆ·</p></blockquote><p>éå†çš„ä»£ç å¦‚ä¸‹ï¼Œä¸€å¼€å§‹è¿˜è§‰å¾—è‡ªå·±ç”¨äº†è¿­ä»£å™¨ï¼Œéªšçš„ä¸€æ‰¹ï¼Œç»“æœæº¢å‡ºæ¥ç»™è‡ªå·±éªšæ–­äº†è…°ã€æ‰‹åŠ¨æ‚è„¸</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">removeDuplicates</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> length = <span class="number">1</span>, visited = *(nums.<span class="built_in">begin</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> itor = nums.<span class="built_in">begin</span>() + <span class="number">1</span>; itor != nums.<span class="built_in">end</span>(); itor++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (*itor == visited) &#123;</span><br><span class="line">                nums.<span class="built_in">erase</span>(itor);</span><br><span class="line">                itor--;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            visited = *itor;</span><br><span class="line">            length++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨çœ‹äº†é¢˜è§£ä¹‹åï¼Œæ‰å‘ç°é¢˜ç›®ä¸­æ—©å°±å·²ç»ç»™å‡ºäº†æ˜ç¡®çš„æç¤ºï¼š</p><blockquote><p>ä½ ä¸éœ€è¦è€ƒè™‘æ•°ç»„ä¸­è¶…å‡ºæ–°é•¿åº¦åé¢çš„å…ƒç´ ã€‚</p></blockquote><p>åŸºäºè¿™å¥è¯ï¼Œä¹Ÿå°±æ˜¯è¯´å¹¶ä¸éœ€è¦å°†åŸæ•°ç»„ä¸­å¤šä½™çš„å…ƒç´ çœŸæ­£çš„â€œåˆ é™¤â€ï¼Œè€Œæ˜¯åªéœ€è¦å°†åé¢çš„å…ƒç´ éƒ½æ”¾åˆ°å‰é¢æ¥ï¼Œä»¤å¾—è¿”å›çš„é•¿åº¦ä¹‹å†…éƒ½ä¸åŒå’Œæ­£ç¡®å°±å¯ä»¥äº†ã€‚</p><p>æ‰€ä»¥é¢˜è§£ä¸­ç»™å‡ºçš„åŒæŒ‡é’ˆçš„ç¡®æ˜¯æœ€ä¼˜è§£äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">removeDuplicates</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> length = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span> (length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> res = <span class="number">0</span>, scan = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (scan &lt; length) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[res] != nums[scan]) &#123;</span><br><span class="line">                nums[++res] = nums[scan++];</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            scan++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ++res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“æœ:</p><blockquote><p>æ‰§è¡Œç”¨æ—¶ : 24 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†98.03%çš„ç”¨æˆ·<br>å†…å­˜æ¶ˆè€— : 10.1 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†73.17%çš„ç”¨æˆ·</p></blockquote>]]></content>
    
    
      
      
        
        
    <summary type="html"></summary>
        
      
    
    
    
    <category term="Programer Walk" scheme="https://hexo.chensmallx.top/categories/Programer-Walk/"/>
    
    
    <category term="leetcode" scheme="https://hexo.chensmallx.top/tags/leetcode/"/>
    
    <category term="OJ" scheme="https://hexo.chensmallx.top/tags/OJ/"/>
    
    <category term="å»é‡" scheme="https://hexo.chensmallx.top/tags/%E5%8E%BB%E9%87%8D/"/>
    
  </entry>
  
</feed>
